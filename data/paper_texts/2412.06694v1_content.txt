SECTION: Digital Transformation in the Water Distribution System based on the Digital Twins Concept
Digital Twins have emerged as a disruptive technology with great potential; they can enhance WDS by offering real-time monitoring, predictive maintenance, and optimization capabilities. This paper describes the development of a state-of-the-art DT platform for WDS, introducing advanced technologies such as the Internet of Things, Artificial Intelligence, and Machine Learning models. This paper provides insight into the architecture of the proposed platform-CAUCCES-that, informed by both historical and meteorological data, effectively deploys AI/ML models like LSTM networks, Prophet, LightGBM, and XGBoost in trying to predict water consumption patterns. Furthermore, we delve into how optimization in the maintenance of WDS can be achieved by formulating a Constraint Programming problem for scheduling, hence minimizing the operational cost efficiently with reduced environmental impacts. It also focuses on cybersecurity and protection to ensure the integrity and reliability of the DT platform. In this view, the system will contribute to improvements in decision-making capabilities, operational efficiency, and system reliability, with reassurance being drawn from the important role it can play toward sustainable management of water resources.

[inst1]
organization=Universidad de Extremadura,
addressline=School of Technology, Av/ Universidad S/N,
city=Caceres,
postcode=10003,
state=Extremadura,
country=Spain

[inst2]
organization=Ambling Company,
addressline=Av. Martín Palomino, 90,
city=Cáceres,
postcode=10600,
country=Spain

Developed an integratedfor water distribution systems, leveragingto optimize operations, reduce environmental impacts, and ensure data security.

Implemented advanced(LSTM, Prophet, LightGBM, XGBoost) with feature engineering and hyperparameter tuning, achieving aandin 6-month water consumption forecasting.

Formulated ato address NP-hard challenges in task routing, preemptions, and dependencies, achieving,, andemissions.

Enhanced water system resilience by integrating, including, secure data transmission protocols, andusing Wazuh and Zabbix.

Demonstrated significant improvements in,, and, setting a benchmark forin water distribution networks.

Provided a robust foundation for futurein water management, contributing to global.

SECTION: Introduction
Inefficient energy consumption and elevated expenses represent merely two of the challenges linked to the water supply system, an essential component of infrastructure that delivers water to final consumers, such as enterprises, the populace, and agricultural sectors. The establishment of facilities for the transportation of water is not a contemporary achievement of civilization. Throughout this era, developments in science and engineering have enabled water to be transported over long distances through the use of valves and pipelines. Aging, urbanization, population growth, climate change, and other factors challenge an already strained WDS. The water supply and bent technology vicious cycle should be broken up simultaneously, reconstructing water networks designed to elevate efficiency, reliability, and promotion in this context even risks.

This type of digital transformation helps solve these systemic issues. Water utilities can track and control their systems remotely with IoT technology, AI, and DTs. Predictive maintenance, the ability to look after systems and devices in real-time, and simulations of systems are made possible to the benefit of system efficiency and, at the same time, minimize operational costs. However, despite these advances in digitalization related to WDS, there are still a number of significant challenges to overcome: data structuring, model precision, and interfacing with legacy systems. Ensuring long-term viability and operational efficiency in WDS requires technological innovation and the adoption of sustainability-driven business models. Similar to how manufacturing firms are restructuring their business models to achieve sustainable value creation and delivery, the water sector must integrate environmental, social, and governance principles into its digital transformation strategies.

The major focus on DTs technology is that it is presently one of the newsmaking, adopted adjunct technologies that will affect the operation of business organizations. They are defined as virtual models of discrete physical systems and run in real time with data and simulations important for the augmentation of performance of a system. In water distribution, DTs can enhance system design, predict the needs around maintenance, conduct simulations concerning this system’s operational capability, and many others.
Unlike the above proposition, bottlenecks explicit of deploying DTs in this particular industry are insecurity, data protection, and the need for a competent workforce, among others.

In this article, we leverage the application of DTs within the water industry and extend it to urban and rural water distribution and transmission networks to propose a novel platform model.

SECTION: Objective and Main Contributions of the Paper
A new DT-based system for water supply systems is presented in this paper, in as much detail as possible. The proposed platform merges DTs with IoT technology to forecast and visualize water uses, thus enhancing the decision capabilities of whoever has authority over the management of the water utilities. Accordingly, the integration implied that the platform was supposed to incorporate the WDS imperatives for improved operational efficiency, regulatory observance, and good infrastructure. This paper will further discuss the characteristics of the platform to be created, its probable advantages, and different ways of overcoming the bottlenecks in the process of digitalization of WDS.

The main contributions of the paper are the following:

The paper proposes an innovative platform based on DTs applied to a WDS, which would be transferred/tested in an SME from the sector in a rural environment. Even if the platform is focused on the water sector and WDS, it will easily be replicable for other sectors or other commercial interests.

TIt is composed of the infrastructures of AI and ML and IoT for the realization of a digital transformation of traditional business models into digital business models. This inclusion in DT, together with IoT devices that allow the acquisition of data used in the predictions, would be of huge interest due to the possible application in similar contexts for prediction purposes.

The platform integrates with advanced Artificial Intelligence and Machine Learning models in water consumption prediction, hence providing more accurate demand forecasting and best resource management. Such predictive capability would help to achieve better decision-making in a water distribution system.

It allows for maintenance scheduling, operator management of water distribution networks, realizes Digital Twins, and CP-based scheduling for optimization of maintenance activities. This ensures that operational efficiency is optimized, the occurrence of downtime is reduced, and service quality is improved through reliable management of the water distribution system.

In fact, the cybersecurity threats that, as a consequence of the paradigm shift implied by the use of DT models connected to IoT devices, have been studied and considered. Another contribution of the paper deals with identifying the cybersecurity strategies that are implemented in accordance with the norm compliance ISO 27001. The implemented security strategies will doubtless be of great interest in similar projects.

It has been tested in a real practical environment what was foreseen with the platform, functionalities, and possibilities that it provides. The proposed DT model, the use of an AI tool, and IoT device identification- including the identification of cybersecurity strategies easily replicable in similar settings and projects, constitute one of the basic contributions of this work.

SECTION: Article Structure
The rest of the paper is organized as follows: In Sec,reviews the current status, challenges within the WDS, and the need to adopt such Digital Transformation Technologies like DTs. Section,discusses the existing literature on DT and presents the lacunars of the current research, setting the stage for our contributions. Section,outlines the proposed platform and gives an overview of the system, functional capabilities, and methods to integrate with existing legacy systems. Section,outlines the use case of the AI/ML method applied for water consumption prediction and leak detection based on the DTs platform.
In Section, we solve one CP scheduling problem for task completion time, penalty reduction, CO2emission minimization, fuel consumption, and maximization of efficiency in a single-machine problem setting. Section,, presents some cybersecurity approaches in order to build up the resilience and sustainability of the DT platform. Finally, Section,, summarizes the contribution of this paper and provides some possible future directions for research in this domain.

SECTION: Background and Motivation
SECTION: Digital Transforming
Digital transformation in the water industry uses technologies like IoT, AI, ML, DL, and DT to make water supply and distribution more efficient, sustainable, and reliable. These tools can improve maintenance, optimize resources, and support better decision-making. Yet, as in other sectors experiencing similar changes, successfully adopting these advanced solutions in critical infrastructure can be challenging. National research and development initiatives have shown that strategic frameworks help integrate emerging technologies sustainably—and the same approach applies to DTs, AI, and IoT in water utilities. When digital transformation aligns with such targeted R&D efforts, it can promote long-term resilience, environmental responsibility, and more efficient resource management in the water sector.

Real-time monitoring: Digital transformation will enhance real-time monitoring of the WDS; this will help in the early detection and timely response in case of system failure and leaks. For example, sensors that detect a leak in the system and send real-time alerts to maintenance personnel who can act immediately and reduce water wastage.

Predictive maintenance: The process of digital transformation facilitates predictive maintenance, which serves to avert system failures and diminish maintenance expenses. For instance, machine learning algorithms can be developed using system data to anticipate maintenance requirements, thereby enabling maintenance personnel to organize repairs prior to the occurrence of system malfunctions.

Simulation capabilities: Digital conversion can provide simulation capabilities that can help optimize system design and operation. For example, DTs can simulate system behavior under various operating conditions, allowing companies to optimize system design and identify potential problems before they occur.

Data-driven decision making: Digital transformation can allow for better decision-making by availing data-driven insights as stated by. For instance, system data can be analyzed for patterns and trends that may inform decisions related to system upgrades or improvements.

SECTION: Current Challenges
Besides, digital transformation in WDS and more has its host of big challenges:

Integration with legacy systems: Integrating modern technology with the existing infrastructure is cumbersome and costly. In support of this process of digital transition, older WDS—which are very often incompatible with today’s IoT devices and sensors—may involve extensive upgrades.

Data privacy and cybersecurity: Cybercriminals may be able to take advantage of more weaknesses as IoT devices and sensors proliferate, which might disrupt systems and expose data. For instance, a weakly secured sensor can give hackers access to compromised systems or pilfer confidential information.

Proficient workforce: The management and upkeep of digital infrastructure require specialized knowledge. Utilities may face considerable challenges and must undertake substantial programmatic investments to equip their personnel with the necessary digital skills in regions lacking such expertise.

Implementation costs: The initial costs of implementing digital transformation are often high, including investments in new technologies, infrastructure upgrades, and workforce training. These costs can be prohibitive for SMEs, limiting their ability to adopt advanced digital solutions and compete with larger entities.

Escalating Cybersecurity Threats: As a consequence of digital transformation, a greater number of devices are being linked to the Internet, thereby augmenting the potential access points for cyberattacks. Assaults directed at critical infrastructure may lead to significant financial repercussions, harm to reputation, and even physical injury.

Widening the digital divide: Digital transformation can exacerbate the digital gap by leaving behind people and communities who lack digital literacy or have restricted access to technology. This disparity impedes social and economic advancement and exacerbates existing inequalities.

Labour Displacement: The digital transformation of WDS should align with corporate social responsibility, addressing challenges like labor displacement caused by automation and AI. Organizations can mitigate job losses by fostering trust, equitable resource distribution, and social value through stakeholder engagement by introducing training and re-skilling programs to help workers transition to new roles. Integrating DT frameworks in water management advances technical efficiency, ethical stewardship, and workforce adaptability.

Privacy Issues: The significant collection and utilization of data have the potential to lead to privacy-related concerns. The implementation of digital technologies may be hindered by apprehensions regarding data security incidents or the handling of individual information, which could diminish public trust in these advancements.

While digital transformation provides great dividends in terms of productivity and, therefore, innovative capacity in various industries, it needs to be pursued strategically and with awareness within WDS. In fact, critical challenges and risks threaten the successful digital transformation that service companies have to face. It is, therefore, especially relevant that a sound strategy, recognizing the peculiarities of WDS in terms of their complexity, criticality, and regulatory requirements, be developed. Through the adept management of these obstacles, electronic tools can facilitate the successful execution of digital transformation, thereby ensuring that its advantages are equitably shared among all stakeholders. This holistic strategy will lay the groundwork for unlocking the complete potential of digital transformation in enhancing operational efficiency and promoting innovation throughout the industry.

SECTION: DTs in Water Industry
This was born in the 1960s when most organizations, inclusive of NASA, applied physical twins of systems for the control of systems at remote locations, as was applied in the rescue of Apollo XIII. These have evolved with time and debate to highly advanced virtual twins that simulate various “what-if” scenarios. This improves the city’s ecosystem since the DT empowers planning and decision-making by highlighting the macro level of interaction that multiple components have, which enables these systems to work in a sustainable manner and with maximum efficiency.

The adoption of DTs across industries is novel, driving benefits from better product development to operations and decision-making. For example, electricity to produce more in manufacturing, to predict equipment failure, and to produce higher-quality products. The automobile industry uses them to simulate assembly lines, find out bottlenecks, and test new product designs. Healthcare - DTs model human organs or body parts to understand the conditions of patients better and plan surgeries. DTs in the construction industries are applied to fine-tune the designs of buildings and reduce energy consumption through simulations of wastes created by different materials, lighting, and ventilation systems. Transportation utilizes DTs for performance monitoring and predictive maintenance in view of safety and operational efficiency.

Henriksen et al. (2022) present the development of a novel type of DT called HIP DT for Adaptation to Climate Change, Water Management, and Disaster Risk Reduction. This paper delineates how the development and implementation of the national DK-model HIP have been done to realize real-time updating of simulations through the HIP portal. This approach focuses on how the betterment of Denmark’s ability to cope with extreme weather events can be achieved by providing improved hydrological information. The system contributes to adaptive planning, ensures water security, reduces disaster vulnerability, and builds climate resilience by applying the latest hydrological modeling and machine learning techniques. Other important applications include real-time forecasting to help overcome the threats of flooding and drought, safeguarding water supplies, and supporting sustainable development projects.

Ibrahim Yousif’s contributionaims to leverage digital transformation in the water desalination process, improving smart facilities. The objective targeted here was to come up with DT models for two major items, namely a three-cylinder high-pressure pump energy recovery device-HPP-ERD and a three-stage RO membrane model. These DTs employ real-time data and IoT technologies to comprehensively monitor, detect faults, and predict them in the systems. Applying machine learning to higher-order signal processing will considerably increase the efficiency and reliability of the whole system. This research paper will present how digital transformation will result in an enhanced desalination process, reduced maintenance costs, and increased sustainability in the production of freshwater.

Savic’s workpresents a future of the water sector that is rather transformative, similar to what happened in the car and aerospace industries. Remote sensing, artificial intelligence detecting anomalies, and digital twins are identified as key enablers to enhance water management efficiency. This research puts a strong focus on embedding human capital into the process and using appropriate cybersecurity to manage risks related to automation. Lessons can be learned from the failures within other industries, such as those involving Tesla Autopilot and Boeing 737 MAX, and be applied for the advancement of digital transformation in the water industry, increasing its resilience and operational effectiveness.

DTs enjoy a wide range of applications from energy industries through increasing system efficiencies, reliability, and sustainability by adopting real-time monitoring, predictive maintenance, and data-driven decisions. Similarly, DTs hold huge promises of making paradigmatic changes in drinking WDNs management. The performances of the drinking water supply systems can be optimized by practicing various scenarios in the virtual replicas of the networks. Various most promising applications of DTs in drinking water WDNs are discussed in this section.

One main use of DTs in WDN is enhancing hydraulic performance. By replicating how the network acts in various scenarios, operators can pinpoint possible problems like drops in pressure or water surges, allowing for knowledgeable choices regarding network layout and function. Moreover, DTs can identify areas at risk of pollution, enabling proactive measures to manage potential hazards.

Besides, DTs improve the asset management of drinking WDNs. In other words, through virtual equivalent modeling of network assets, operators can test performance and predict faults before they occur. For example, the logical simulation of a pump or a valve operational behavior can allow operators to identify vulnerabilities and establish a plan for mitigating the potential damage, but also model the reaction of the network in case of power failures or natural disasters, among the quality of water.

Simulations of water flow in the network enable operators to identify possible locations of contamination and maintain good water quality accordingly. DTs also contribute to monitoring water consumption and detecting losses, reducing overall water waste and enhancing the overall efficiency of the network.

Hence, DTs are beneficial in planning emergency responses. Various contingency scenarios can be simulated to identify potential problems and develop effective contingency response strategies by operators. For example, simulating network behavior in the event of a power outage or natural disaster allows operators to identify the weak links and put in place strategies that reduce potential damage. In general, the output from DTs applied to WDNs can be summarized as optimization of hydraulic performance together with asset management, better monitoring of water quality, and emergency response planning. In such a way, the discussed technologies enable the operator to make data-driven decisions toward efficiency, reliability, and sustainability concerns in WDNs.

SECTION: Literature’s Review
SECTION: Background Research
DTs in the water industry are improving the efficiency, reliability, and sustainability of water systems. In particular, WDS enables real-time monitoring and network behavior simulation. In this direction, the technology will enable predictive maintenance, better decision-making, and optimization of resources. DTs create a dynamic, virtual model of the WDN, bringing together real-time data, AI, and machine learning. This model helps identify potential issues, test scenarios, and understand the impacts of various decisions, reducing risks and improving service quality. This section reviews significant contributions to developing and applying DTs in WDS, highlighting advances and identifying ongoing challenges. Conducting a thorough and systematic literature review is paramount for identifying emerging trends, challenges, and solutions in applying DTs and AI/ML within WDS. Recent studies have emphasized the importance of refining literature review strategies to analyze big data trends and ensure research quality across different journal tiers. Such methodological rigor helps build a robust theoretical foundation for understanding digital transformations in the water industry.

Early conceptual underpinning of DTs puts into consideration the problems regarding efficiency and sustainability in water treatments and distribution systems through sophisticated modeling combined with real-time data. Curl et al. (2019) focus on how DTs can provide in-depth and real-time representations of water treatment processes for predictive optimization and control. The approach has greatly optimized chemical dosing, energy use, and resource utilization to reduce operation costs and minimize environmental impact. For example, a case study at a North Carolina water treatment facility reported 10% chemical savings with a 2% improvement in water quality due to optimized coagulant dosing.

Conejos et al. (2020) further elaborate on developing and implementing DTs for managing drinking WDNs. They also refer to the main functionalities of the DTs: ”Precise modelling of network behaviors, continuous data integration from systems like GIS, AMR, and SCADA are other advanced capabilities that include optimal network design, asset management, leak detection, and simulations of emergency responses.” The case study performed on the WDN of Valencia-which supplies 1.6 million inhabitants-demonstrates remarkable added value regarding real-time monitoring, predictive maintenance, and efficiency enhancement of operations. This exemplifies the scalability and efficacy of decision trees in overseeing intricate water management systems, highlighting their potential as essential instruments for decision-making within contemporary water utility operations.

Giudicianni et al. (2020) provide this basis by discussing the integration of advanced energy management and leakage control technologies within smart water grids. The study discusses the role of DTs, CPS, and blockchain in optimizing WDSs. Its core focus rests on the recovery of energy, and that is achieved by installing micro-turbines and PATs instead of traditional PRVs through the enhancement of energy efficiency together with leakage control. The study has also identified that the segmentation of water networks into DMAs is effective in improving monitoring and management. Giudicianni et al. trust that the integration of the concept of digital water will contribute significantly towards enhancing the sustainability and resilience of urban water systems to enable upcoming smart city development.

The application of DTs in water systems has immensely increased, proving their flexibility and effectiveness for use across various environments. Valverde et al. (2021) extend the explanation of how DTs improve the performance and efficiency of the water infrastructure with respect to operational decision-making for sewer networks and water resource recovery facilities. The integration of real-time data and advanced models within the DTs allows for operational optimization and smarter handling of data in complex water systems. Case studies from Global Omnium in Valencia, Spain, Aarhus Vand in Denmark, and DC Water in the United States further illustrate that, in general, the technology of digital twins allows for real-time monitoring, integration, and holistic management of systems, underlining their flexibility in a variety of water management contexts.

Garrido-Baserba et al. (2020) relate the fourth revolution to the digitization impelled by big data and artificial intelligence in the water sector. These technologies enhance operation, maintenance, and sustainability when integrated with urban water infrastructure. AI and big data analytics enable real-time insights and predictive capabilities, changing how decisions are made, resources are recovered, and assets are managed. This digital transition will bring changes in the socio-economic perspective, it will influence new business models, and it will demand new research and also new workforce development to meet the future demands of the water sector.

Pedersen et al. 2021 investigate the Living and prototyping DTs for an urban water system that is focused on multi-purpose value creation via models and sensors. While a living DT performs real-time operational and control functionalities, in prototyping DT, it would be used for design and planning without any real-time data coupling. Implementation at VCS Denmark showed how the system management can be empowered with data links, simulation models, and enhanced analytics. This is emphasized through open data standards and intersectoral collaboration to maximize the impacts of DTs for efficiency, resilience, and sustainability in the management of urban water.

Hietala et al., 2021 present different forms of collaboration in the digital transformation of municipal wastewater management, focusing on inter-organizational cooperation between Finnish water utilities. They identify four main modes: autonomous, limited company, central service organization, and standardization. These collaboration modes enhance ICT development and deployment, providing benefits such as predictive maintenance, efficient resource allocation, and improved data integration. While autonomous development is prevalent, collaboration through limited companies and standardization offers significant advantages in managing digital transformation challenges and improving overall operational efficiency and sustainability.

Van Rooij et al. (2021) proposed a DSS based on DTs to recover membranes in RO desalination plants. The study addresses bio-fouling caused by algal blooms, significantly impacting membrane efficiency. The DSS creates a DT of an RO vessel to evaluate maintenance strategies, including membrane cleaning, swapping, and replacement. Applied to the Carlsbad Desalination Plant, this approach optimizes maintenance schedules, reduces operational costs, and enhances the reliability and longevity of membrane systems, setting a new standard for membrane management in the desalination industry.

Udugama et al. 2021 explores the challenges and opportunities of applying Digital Twins to bio-manufacturing, highlighting potential gains in process efficiency and resource optimization. The following work details a five-step methodology for developing a full DT, starting with a basic steady-state process model and culminating in an advanced, validated model complete with bidirectional communications. A bench-scale ethanol fermentation serves as a test bed to demonstrate the improved monitoring and control functionalities of the developed framework. Key challenges include the need for high-fidelity models, real-time data integration, and operator interaction, with suggestions for future research to optimize biomanufacturing operations.

Botin et al. (2021) study DT applications representing urban spaces and vehicles to create a Living Laboratory and demonstrate how DTs in urban environments can enable interaction in achieving the United Nations Sustainable Development Goals. The work describes a method for the development of DTs using a network of vehicle sensing devices which, by processing in real-time via edge computing, modelling software, and machine learning algorithms, resulting in DTs that shall be used to analyze the urban space evolution, mobility, and the interaction of vehicles for the valuation of insights into urban planning and improvements of infrastructure toward sustainable and resilient urban environments.

The development of new methodologies and frameworks in WDN management has been strongly improved by combining DTs with legacy algorithms and innovative technologies. Ciliberti et al. (2021) propose a new digital transformation paradigm in the WDNetXL/WDNetGIS platform, focusing on life-cycle management and operational efficiency. The essential services, such as the Digital Water DMA Analyzer, optimize district metering area design for leakage reduction through pressure control, and the Digital Water Rehabilitation provides optimal pipe replacement plans. These digital services significantly improve the management and sustainability of WDNs by real-time data exploitation and advanced modeling techniques.

Ramos et al. (2022) talk about the integration of DT technologies to enhance WDN efficiency, showing substantial water savings and improvement in system operations through optimization algorithms and real-time data collection using GIS. A case study in Lisbon shows the ability of DTs to bring about 28% water savings through quick leak detection and optimal pressure control valve settings. This research puts forward the transformative effect of DTs on smart water management, emphasizing reduced water and energy losses and promoting sustainable operations.

Pesantez et al.(2022) assess the impact of the COVID-19 pandemic on water infrastructure based on a DT framework by fusing AMI information with hydraulic modeling. The study highlights the dramatic changes in residential and nonresidential water use patterns due to social distancing measures, which are creating increased pressures and increased water age within the distribution system. This approach really depicts the potential of DTs in providing real-time insight and enhancing operational decision-making to improve infrastructure resilience during unforeseen events.

Bonilla et al. (2022) provide a state estimation methodology for WDSs using GCNs coupled with hydraulic models to constitute a DT. This framework estimates the pump speeds from available data on pressure and flow rates and makes a very accurate prediction of the system’s hydraulic state. Validated in benchmark networks, this methodology shows high predictive accuracy and thus has great potential for DTs in improving WDS monitoring, management, and anomaly detection to improve overall operational efficiency and reliability.

Zekri et al. propose a smart water management framework using intelligent DTs and multi-agent systems in order to increase efficiency and distribution of water resources. This five-layer framework uses intelligent agents for data analytics, simulation of asset operation, and feedback from users in real-time. The framework is designed with much emphasis on autonomy and intelligence, using a reward-based mechanism to incentivize optimal water consumption—how DTs can improve asset management, leak detection, and system operations for sustainable use of water resources.

Matheri et al. (2022) review the integration of DTs, AI, and data-driven optimization in wastewater treatment plants for sustainable circularity and intelligent operations. The study highlights how CPS can be deployed in real-time for monitoring, predictive maintenance, and enhancement of decision-making frameworks. In this regard, adopting circular bio-economy approaches will transform wastewater treatment into resource recovery facilities that support sustainable development goals. Implementations of these technologies under which considerable operational cost savings, significant improvements in system reliability, and compliance with better environmental standards are realized truly illustrate the transformative capability of DTs in wastewater management.

Recent progress in developing digital technologies for water systems has focused on improving real-time monitoring, operational efficiency, and sustainability by using new applications and advanced frameworks. Dodanwala et al. (2023) present a digital technology framework for LOS in relation to potable water infrastructure systems. This integrates real-time data acquisition with established service standard benchmarks so that the performance evaluation and management of the water infrastructures can be automated. This framework improves strategic decisions as well as operational efficiency in the development of a cyber equivalent for a physical infrastructure that is facing aging infrastructure and/or variable service conditions. It follows ISO 55000 guidelines based on dynamic data integration and automatic LOS assessments to ensure sustainability and resilience in the water delivery service.

Ramos et al. (2023) confirm both applications of the SWG and DT technologies at the Gaula Water Distribution Network, Madeira, Portugal. Real-time monitoring, scenario analysis, and optimized pressure control were found to reduce significant water loss and improve the performance of the system. The DT model allowed for a potential reduction of 80% in water losses, saving about EUR 165,000 every year. This study underlines the importance of using DT and SWG for effective modernization of water management practices toward sustainable water usage and increasing the efficiency of the network, in general.

Overall, Grievson et al. (2022) describe the integration of digital solutions into water management: real-time optimization, total transparency, and predictive maintenance. A number of cases are presented that have underlined the transformative potential that digitalization can show in areas such as reduction of non-revenue water, improvement of the quality of water, and the management of infrastructure. Alongside opportunities, challenges about cybersecurity, data quality, and legacy systems call for collaboration in a multi-stakeholder perspective able to ensure digital transformation success. The research promotes creating future-proof frameworks that support innovative technologies, driving sustainable development and equitable water management practices.

Fu et al. (2022) introduced the development of DTs for biomanufacturing, considering a general framework for developing a full-fledged DT starting from a basic steady-state process model. For a case study on second-generation ethanol fermentation, this presented DT framework has been able to illustrate productivity enhancements of 20-33%. The following critical success factors have been identified: modeling accuracy, human operator actions, and economic value proposition of the models. Notwithstanding these benefits, the study recognized that for such interaction to be effective, highly advanced digital infrastructure, together with carefully designed HMIs that will help enhance the accuracy and robustness of the DT system.

Pedersen et al.(2022) introduce a diagnostic framework for addressing uncertainties in integrated urban drainage models used in living DTs. The framework enhances iterative model improvements by classifying errors across urban drainage system components using hydro-logic and hydraulic signatures from water level sensors. Applied in Odense, Denmark, this approach reveals discrepancies in model inputs, structural attributes, and temporal variability, improving model accuracy and transparency. This diagnostic framework leads to more reliable and efficient urban water management.

Gino Ciliberti et al. (2023) present a transformative approach to the digitization of WDNs by developing standardized methods for creating DTs for WDNs. Advanced hydraulic modeling is combined with AI, machine learning, and deep learning techniques; thus, a conceptual framework for WDN digital transformation is presented. This framework integrates the whole DTs with advanced network analysis, developing DWSs as plugins for QGIS software: Enhancing WDN planning, management, and design, continuous improvement of their digital representation, and improving technical decision-making and overall efficiency.

Additionally, Ramos et al. (2023) illustrated how DTs transform system operation and maintenance. DTs allow the detection of patterns in historical and real-time sensor data and thus inform predictive maintenance strategies, avoiding sudden failures and reducing costs to the very minimum. These technologies may be one of the primary drivers enabling the SDGs due to their reduced environmental footprint through better water management, pressure management, and resource preservation. There are still barriers, however, regarding scaling up with currently existing infrastructure in terms of data management issues, regulatory issues, and cybersecurity concerns. Further research is needed to improve forecasting water consumption and detecting leaks to fully leverage DT technology in enhancing WDSs.

Torfs et al. (2024) introduce WRRF models transitioning into DT applications with a focus on how to overcome a lack of consensus in DT definition and application. The main differences from traditional simulation models toward DTs point to continuous and automated data links and dynamic updating. Integrating mechanical with data-driven models into hybrid frameworks enhances their predictive power, hence operational efficiency. Examples of success stories range from Changi Water Reclamation Plant to Kolding WRRF and have shown that decision improvements in operation and real-time optimizations have been possible by the implementation of DTs. Successful DT deployment in WRRFs needs a holistic approach that includes stakeholder buy-in and adequate data management.

Menapace et al. (2024) present a proof-of-concept about optimal sensor placement using GNNs to support the development of DTs for WDSs. The paper presents a novel methodology which uses GNNs in the evaluation of pressure at the consumption nodes, guiding the optimal configuration of sensors with the goal of minimizing the estimation error. Applied to a synthetic case study, the approach demonstrated high accuracy in pressure estimation across various sensor configurations, highlighting the potential of GNNs in enhancing the accuracy and reliability of DTs in WDNs. This innovative method supports more effective monitoring and management of water systems, promoting improved operational efficiency and resource utilization.

SECTION: Gaps in Research
Despite all the advancements in applying DTs within the water industry, there still remain some major research gaps. A major gap is the integration and effective use of state-of-the-art AI and ML models with DTs for WDSs. While AI and ML hold prospects to enhance predictive analytics and operational efficiency, real-world applications are mostly curbed by the shortage of good-quality, granular time-series data needed to train strong models. The complexity of water consumption patterns and the requirement for much feature engineering make it difficult to implement models such as LSTM, Prophet, LightGBM, and XGBoost. It reflects the reality that AI models should be both accurate and generalizable within different contexts of the water industry.

Another critical gap is the optimization of maintenance operations within WDSs using DTs and advanced optimization algorithms, such as CP. How to integrate DTs with sophisticated scheduling models to address complex maintenance tasks with dynamic priorities and dependencies remains a less-explored avenue. This calls for setting up new research efforts toward developing scalable optimization methods for adaptation to the dynamic nature of WDSs that minimize operational costs and environmental impacts.

In addition, there is a need to develop scalable digital twin architectures that can handle the complexities involved in water distribution networks by considering diverse data sources, such as IoT sensor data, historical maintenance records, and environmental information. Current digital twin applications often focus on specific aspects, like pipeline health monitoring or water quality management, rather than working on an integrated view of all subsystems and external factors that influence water distribution. Such creation of integrated digital twin platforms would enable smooth interoperability between the different components involved, such as water quality assessment, leak detection, consumption prediction, and maintenance planning. That would need some research into data standardization methodologies and interoperability.

Successful DT adoption also needs a skilled workforce capable of managing these advanced systems. It is an imperative task to research programs for education and training tools to close the digital skill gap in the water industry. This will enable smoother transitions to digital platforms and realize maximum benefits from DT implementations.

Furthermore, digitalization in WDSs, especially regarding regulatory compliance and cybersecurity, is under-explored. With the increasing prevalence of digital systems, there is an acute need to ensure secure and resilient interconnected water distribution infrastructures from cyber threats. A great deal of research will be required to ensure DT platforms comply with relevant regulations, including data privacy policies like GDPR and ethical policies. Frameworks that properly balance operational efficiency against legal and moral imperatives will be critical to ensure both effective and responsible digital transformation of WDSs. The creation of the DT should, therefore, be a priority, enabling the discovery of those errors only when such a DT is created; hence, this paper proposes a DT platform for better and more precise water resource management in order to manage efficiently the support and maintenance of the water network.

SECTION: Proposed DTs Platform
This manuscript introduces the CAUCCES platform, a DT-based system integrating AI models for water consumption forecasting, IoT infrastructures for gathering data in real-time, and cybersecurity measures compliant with the regulatory context. Successfully deployed in, an SME in charge of the management of rural water supply services, the platform tackles challenges like water scarcity and demographic decline through showing how advanced sensing, communication, and information technologies may be beneficial in enhancing governance around water resources.

The platform provides an integrated framework for real-time monitoring and decision-making and digitization of the maintenance process for water distribution networks. It optimizes maintenance by using CP-based scheduling with DT technology to bring operational efficiency and service quality to a higher level, along with system reliability. Inspired by solutions for urban areas, CAUCCES tailors these technologies to the demands of rural needs, enabling functionalities such as remote meter readings, water quality monitoring, demand forecasting, and scenario-based system simulations.

Digital Twins, at the heart of the platform, are dynamic digital models of physical systems integrated in conformity with real-time sensor data to increase a system’s efficiency and sustainability. This makes CAUCCES an enduring solution to the challenges of modern-day water distribution.

Figureclassifies DT applications into operational and strategic. In an operational sense, DTs support monitoring and control; as such, they can also detect anomalies, optimizing any process—for instance, the automation of a water production facility. At a strategic level, ”predictive twins” leverage simulated data to model potential scenarios to drive design changes in systems, train personnel, and simulate incidents proactively.

Models are usually used by water utilities for the prediction of system behavior under normal conditions. However, actual performance deviates due to real demand, maintenance, and aging infrastructure. By integrating these factors, a DT creates a dynamic, real-time model that continuously adapts to changes in order to improve daily operations and long-term planning. This is how DTs have the potential to transform the management of water from static models to dynamic, scenario-based tools that empower utilities to navigate the future with confidence.

SECTION: CAUCCES Architecture
Figurepresents the architecture of the CAUCCES Smart Water Management System, which has been meticulously designed to integrate diverse data sources and cutting-edge technologies to enhance water management efficiency significantly. The architecture is structured into several interconnected layers, each tailored to perform specific functions contributing to the system’s overall effectiveness and operational intelligence.

The CPS represents the interconnected physical assets and digital system components that facilitate data generation, collection, and transmission. It comprises two key elements that work together to ensure the continuous flow of information from physical sensors to computational platforms:

These networks include IoT devices located throughout the WDS, including PLCs, meters, pumps, pipes, and gauges. Real-time data is collected at the various treatment, transmission, and distribution stages of water. The data collected becomes important in monitoring the performance of the system and determining inefficiencies or faults in the network. The deployment of IoT networks ensures extensive coverage of the entire water infrastructure with high-accuracy data capture.

The communication layer is important for the lossless and timely delivery of data gathered by IoT devices to downstream systems. In our architecture, data from IoT devices connected via the LoRaWAN protocol are aggregated and then securely transmitted to cloud platforms for further processing; thus, this ensures that the system has strong and scalable data handling, maintaining the integrity and timeliness of critical information across the network.

At the heart of this architecture lies the DT component, which creates accurate virtual replicas of physical water systems. This core element encompasses various models and a computational engine that transforms real-world data into digital entities. It also enables seamless communication between the physical and virtual systems, allowing for higher-level analysis, optimization, and decision-making:

This layer is essential for data integration and management. It controls access, processing, and the exchange of data within the system in such a way as to provide a safe and orderly environment for the sharing of data through APIs. The platform provides access to the controlled data and functionality while allowing integration with other external systems; therefore, the collaboration between two or more platforms in operations becomes much more effective. The layer also ensures the system can handle large volumes of data efficiently, supporting scalability and compliance with regulations such as GDPR.

Although not a self-contained layer, Geographic Information Systems (GIS) are truly part of the system architecture. GIS provides visual insight by displaying data and results of analyses on geographic maps, which significantly enhances spatial analysis. The platform supports both two-dimensional and three-dimensional mapping capabilities, as illustrated in Figuresand, respectively, which are pivotal in visualizing and interpreting the geographic information, fundamental for both operational and strategic decision-making in the water management domain.

The processing and analytics layer transforms raw data into actionable insights in the data analysis phase. This stage handles multiple data sources, categorized into real-time and historical data streams. The data typically undergo pre-processing, cleaning, and transformation on servers within this layer to ensure it is ready for optimization and predictive models. The critical components of this layer include:

Input Data: This layer gathers diverse types of data essential for analysis:

Meteorological data is sourced via APIs from regional weather stations, providing crucial environmental context.

Historical data consists of daily and even hourly water consumption records for the village, stored in dedicated databases for trend analysis and forecasting.

Real-time data from meters, pumps, and PLC devices are continuously captured and stored in relevant databases, feeding into real-time monitoring and analysis models.

Artificial Intelligence Models and Forecasting: A key component of this layer is the AI/ML process stage, where artificial intelligence and machine learning models analyze historical and real-time data. To forecast water consumption, we employed a combination of advanced models to forecast water consumptions, including LSTM, Prophet, LightGBM, and XGBoost. These models enable the system to perform extensive optimization and computational tasks, predict future water demand, detect network leaks, and calculate energy usage and carbon dioxide emissions. Integrating time series data allows for highly accurate forecasting and efficient resource management.

Business Intelligence and Dashboard Tools: Processed data is presented visually through intuitive dashboards and detailed reports, providing users with real-time insights and historical data analysis. These tools empower decision-makers to make informed, data-driven choices, ensuring operational efficiency and long-term sustainability in water management.

SECTION: Integrating AI/ML in Water Consumption Prediction
SECTION: Data Aggregation and Pre-Processing
Water consumption data, originally recorded at 15-minute intervals, is aggregated into daily, weekly, and monthly totals to align with the temporal granularity of meteorological data. This alignment allows for practical correlation analysis at different timescales.

SECTION: Meteorological Variables
Data from the AEMETprovides essential information about climatic conditions, augmenting the water consumption data and enabling the extraction of consumption patterns. These variables are listed in Tableand Figure.

The following part evaluates the correlation between water consumption and meteorological parameters using Pearson’s correlation coefficient (), which ranges from(perfect negative linear relationship) to(perfect positive linear relationship). This analysis helps identify the most influential meteorological factors for inclusion in forecasting models.

Definition: Pearson’s Correlation Coefficient

Whereis the number of observations,andare the individual data points of variablesand, and other terms are mathematical sums and products needed for the computation.

Figure, and Tablepresents the Pearson correlation coefficients (R) for the relationships between various climatic factors and the meteorology station parameters, used as a proxy for water consumption. For the provided dataset, several climatic factors exhibit significant correlations with maximum daily temperature, suggesting that these variables may also impact water consumption if temperature is considered a surrogate for this measure. A correlation coefficient greater than 0.4 is considered significant, indicating a meaningful linear relationship between two variables. In this dataset, most of the climatic factors, such as maximum temperature (tmax), medium temperature (tmed), and minimum temperature (tmin), show strong positive correlations with the average temperature, indicating that changes in these factors will likely affect water consumption patterns.

However, some variables, such as wind speed (velmedia) and wind direction (dir), have weaker correlations, suggesting a lesser impact on water consumption when the temperature is used as a stand-in. Moreover, correlations among the variables highlight potential multicollinearity issues, which must be addressed when selecting independent predictor variables for any forecasting models to avoid invalid results. Based on the correlations, the average temperature (tmex), which has the highest correlation with maximum temperature (tmed), could be considered a significant input variable in a water consumption forecasting model using methods such as LSTM networks.

SECTION: LSTM Model
The first model implemented on this platform for predicting water consumption is the LSTM network, which integrates climate variables along with real-time and historical water consumption data. By training on synthetic datasets derived from daily consumption records, LSTM captures long-term dependencies inherent in time series data. This makes it particularly effective in forecasting future water usage. The model combines historical water use patterns with real-time meteorological observations to deliver accurate and reliable predictions. Given its strength in analyzing sequential data, the LSTM model is crucial for strategic water management, enabling more informed decision-making and resource planning. Key Operations of LSTM Networks:

Forget Gate: The forget gate decides what information should be discarded from the cell state. It is computed as follows:

Input Gate:
The input gate updates the cell state by adding new information into the cell, calculated by:

Candidate Layer:
This layer creates a vector of new candidate values that could be added to the state:

Cell State Update:
The cell state is updated by combining the old state and the new candidate values, influenced by the forget and input gates:

Output Gate:
The output gate decides what the next hidden state should be, which contains information on previous inputs:

Hidden State Output:
The hidden state contains the output information to be passed onto the next timestep:

Data preparation for LSTM involves applying Min-Max scaling for data normalization:

The dataset is methodically partitioned into two segments: 80% for training and 20% for testing. This distribution allows the training set to predict future water consumption across specified periods effectively. Utilizing a structured approach, the LSTM network harnesses both historical and meteorological data to generate accurate forecasts of water consumption patterns. Below, we outline the step-by-step algorithm 1 for training the LSTM model tailored for predicting water consumption:

SECTION: Prophet Model
We employed the Prophet model to forecast daily water consumption from 2020 to 2024, integrating historical water usage data with maximum daily temperature as an external regressor. Prior analyses using the Pearson correlation coefficient indicated a significant positive correlation between water consumption and maximum temperature. This relationship suggests that higher temperatures lead to increased water usage due to activities like irrigation and cooling. By retaining missing values in the dataset, we utilized Prophet’s capability to handle incomplete data internally, preserving the integrity and variability essential for robust forecasting. The model incorporated maximum temperature as an external regress to account for temperature-related variations in water demand. Prophet is particularly suitable for this application because it handles time series data with complex seasonal patterns and additional regressors. The model is formulated as:

where:

is the forecasted water consumption at time,

represents the growth trend component (linear or logistic),

denotes the seasonal component modeled using Fourier series to capture annual and weekly patterns,

accounts for holiday effects using indicator functions,

is the maximum temperature on day,

quantifies the impact of temperature on water consumption,

is the error term, assumed to be normally distributed with a mean of zero.

The inclusion ofas an external regressor was implemented using Prophet’sfunction, enabling the model to learn the relationship between temperature and water demand dynamically.

During the model fitting process, the Prophet model was trained on the historical dataset, optimizing the model parameters to minimize the discrepancy between the predicted and observed water consumption. Prophet employs maximum likelihood estimation (MLE) to estimate the parameters by optimizing the following objective function:

where:

represents all model parameters, including, trend, and seasonal components,

is the actual water consumption,

is the predicted water consumption based on parameters.

After completing the training and validation phases, the model generated forecasts for future water consumption over two periods: from January 1, 2023, to July 1, 2024 (18 months), and from January 1, 2024, to July 1, 2024 (6 months). These forecasts utilized patterns identified from historical data, including trends, seasonal variations, holiday effects, and the influence of maximum temperatures. The anticipated water consumption values were calculated using:

where,,, andare the estimated components from the fitting stage, andrepresents the projected maximum temperature values, either derived from historical trends or provided as external forecasts.

Algorithm 2 outlines the steps in applying the Prophet model for forecasting water consumption.

SECTION: LightGBM Model with Feature Engineering
To enhance the forecasting accuracy of daily water consumption, we employed the LightGBM model, a gradient-boosting framework renowned for its efficiency and performance in handling large-scale data and complex features. This model integrates feature engineering techniques to capture temporal patterns and dependencies inherent in water consumption data.

LightGBM operates by constructing an ensemble of decision trees, where each subsequent tree focuses on correcting the errors of the previous ones. This iterative boosting process allows the model to capture nonlinear relationships and interactions between features, making it well-suited for time-series forecasting tasks. Key components of the LightGBM model are:

Objective Function: The model minimizes an objective function that combines a loss function with a regularization term to prevent overfitting:

where:

is the actual water consumption at time,

is the predicted water consumption,

is the loss function, typically MSE for regression tasks,

is the regularization term for the complexity of the trees.

Feature Engineering: Various features were created to enhance the model’s predictive performance:

Lag Features: Previous water consumption and temperature values were included to capture temporal dependencies:

whereis the lag period (e.g., 1 day, 7 days).

Rolling Means: Moving averages were computed to smooth out short-term fluctuations:

whereis the window size (e.g., 7 days).

Temporal Indicators: Features such as day of the week and weekend indicators were added to capture weekly seasonal patterns:

Data Normalization: Feature scaling was performed using standardization to ensure that all features contribute equally to the model training:

whererepresents the original feature value,is the mean, andis the standard deviation of the feature.

The LightGBM model effectively captures complex temporal and seasonal patterns in water consumption da by integrating these engineered features. This approach enhances the model’s ability to provide accurate and reliable forecasts, which are crucial for efficient water resource management. In following the pseudocode of the LightGBM model shown in algorithm 3.

SECTION: XGBoost Model with Feature Engineering
We employed the XGBoost model to enhance the accuracy of daily water consumption forecasting. XGBoost, known for its efficiency in regression tasks and regularization techniques to prevent overfitting, is well-suited for time-series forecasting. The dataset consists of daily water consumption and maximum temperature records from 2020 to 2024. Preprocessing steps included converting date strings to datetime objects, renaming columns for consistency, removing missing values in water consumption, and forward-filling missing temperature values to ensure data continuity.

SECTION: Model Evaluation
The forecasting models were evaluated using three essential statistical metrics: Mean Absolute Error (MAE), Mean Absolute Percentage Error (MAPE), and Root Mean Squared Error (RMSE). MAE measures the average magnitude of the errors in a set of predictions, without considering their direction, providing a straightforward assessment of prediction accuracy in the same unit as the original data. MAPE quantifies the error as a percentage, making it especially useful for comparing performance across different scales or datasets. RMSE, on the other hand, penalizes larger errors more heavily by squaring them before averaging, offering insight into the variability of the errors and emphasizing significant deviations in the predictions.

represents the average of the absolute differences between the predicted and actual values, providing a straightforward measure of the model’s prediction accuracy:

measures the average absolute percentage difference between the predicted and actual values, offering insight into the model’s accuracy relative to the actual consumption:

is the square root of the Mean Squared Error and represents the standard deviation of the prediction errors, providing a measure of the average magnitude of these errors:

whereis the number of observations,is the actual water consumption, andis the predicted water consumption.

By utilizing these evaluation metrics, we identified each model’s strengths and areas for improvement, guiding further refinements to enhance forecasting accuracy. This comprehensive evaluation is crucial for developing reliable water demand forecasts essential for effective water resource management.

Results of water consumption forecasting by the Prophet model with six regressors are presented in Figure, and they show large shortcomings for all forecast periods. Looking at the 6-month forecasting, while the model picks up broad seasonal trends and cyclical changes, there are deviations at sharp peaks and troughs that manifest a lack of robustness in handling transient phenomena or unmodeled noise. The identified discrepancies suggest that the model’s reliance on pre-determined regressors may not adequately capture the complex nature of water consumption dynamics, especially in the short term. Although the overall correlation with observed data appears to be acceptable, these problems raise some doubts about the reliability of the model for medium-term operational planning in environments characterized by frequent sudden changes. Looking ahead to the 18-month horizon, the shortcomings of the model become even more apparent. While some deeper seasonal patterns are still captured, there is a visible rise in cumulative error as the model struggles to mimic more complex variations. This kind of deterioration in performance could be due to a combination of static correlations between regressors and water use, along with a diminished importance of the chosen exogenous variables over time, and an inability to adapt to changing dynamics. Results: The findings indicated that the Prophet model with regressors performed reasonably well in short-term forecasting, though serious shortcomings occurred as this went further. Consequently, its adequacy for longer-term operational planning and strategic decision-making was highly questionable.

The performance of the Prophet model with regressors and custom seasonalities, as shown in Figure, despite capturing broad trends correctly, reveals several critical deficiencies. For the 6-month forecast, the model does indicate adherence to general consumption patterns; however, large deviations from actual data, particularly for sudden changes or high peaks, suggest that its representation of short-term fluctuations is not adequate. The seasonalities specific to certain domains try to catch the periodic fluctuations in demand and operational cycles; still, this customized approach hardly makes up for the discrepancies with rapid changes or special events in water use. It implies that the tailored seasonalities and regressors alone may not reach a degree of accuracy satisfactory for reliable short-term forecasts. Over the course of the 18 months for which forecasting was conducted, the limitations of the model become more pronounced. While it is able to reproduce the general patterns of the seasons over the long term, results diverge substantially from the actual data at higher temporal resolutions. This increasing divergence shows that the reliance of the model on fixed seasonalities and rigid associations with regressors is not sufficient to handle the compounding uncertainties and shifting dynamics over time. While the tailored seasonalities improve slightly the representation of general trends compared to models using generalized seasonalities, this improvement is of little consequence and does not approach the large disparities in capturing real-world variability. It results in that, though the Prophet model with its seasonality tailored incorporates some usefulness in recognizing general trends, its predictive precision for both immediate and long-term time frames is yet far from satisfactory, which strongly limits its use in practical applications characterized by high dynamism and variability.

The advanced variant of the Prophet model-which includes lag features, rolling means, and custom seasonalities showed in Figurepresents an improved performance in predictions by taking into consideration historical dependencies with softly varying trends. Looking at its 6-month-ahead forecast, the model fits well with the actual data of consumption and captures the short-term fluctuations and sudden changes in the trend. The lag features allow the model to capture temporal dependencies, and the rolling means create a smoothed representation of periodic variability that can work to improve the accuracy of the operational planning. Lastly, customized seasonalities further improve the model’s ability to conform to domain-specific periodicities that are highly effective at managing dynamic shifts in water demand patterns. In the 18-month projection, the model maintains its ability to capture seasonal patterns, though it is not as good at capturing finer-scale fluctuations and anomalies.
These differences can be explained by less temporal relevance of lagged variables on longer forecasting periods and the inherently higher problem of modeling unexpected changes in consumption behavior.

The developed Prophet Model with Advanced Feature Engineering showed in Figureleverages an expansive set of lagged variables, rolling statistics, and domain-specific customizations that enhance forecasting precision. It can also be seen that the 6-month forecast exhibits a high degree of agreement with real water consumption trends. The lag features embed temporal dependencies within the model, while the rolling mean features reduce the observed short-term variability and can thus better capture the fundamental patterns. Complemented by supplementary contextual data in the day-of-week effects and indications of weekends, the model can consider such a cyclical shift in demand fluctuations. The incorporation of multiplicative seasonality, along with Fourier-based seasonal components for both weekly and monthly cycles, allows the model to respond effectively to the intricate seasonal patterns associated with water consumption. In the case of the 18-month forecast, the model maintains strong performance in identifying long-term seasonal trends; however, it exhibits certain discrepancies when forecasting abrupt transitions and anomalies. This can be attributed to the fact that the predictive power of lagged variables and their rolling means weaken with the extension of horizons. Moreover, there are possible external influences not represented by the engineered features. Still, the inclusion of country-specific holidays and domain-specific seasonality somewhat combats these weaknesses and allows the model to remain robust over this longer forecast period.

The predictions of XGBoost model with feature engineering plotted in Figureexhibits strong performance in forecasting water consumption, benefiting from the same comprehensive set of engineered features as the advanced Prophet model. In the 6-month forecast, the model effectively captures short-term fluctuations and seasonality, closely aligning with actual water consumption data. The integration of lag features, rolling statistics, and temporal variables (day of the week, weekend indicators) allows XGBoost to leverage both temporal dependencies and cyclical demand patterns. Minor deviations during extreme consumption peaks suggest potential overfitting to specific patterns or the need for additional external variables. In the 18-month forecast, the model continues to demonstrate robustness in capturing overarching trends and seasonal patterns, though its accuracy diminishes in predicting sudden anomalies and small variations. The diminishing predictive power of lag and rolling features over longer horizons, combined with the inherent limitations of tree-based models in extrapolation, likely contribute to this reduction in performance. Despite these challenges, the model benefits from its ability to prioritize relevant features during training, ensuring that the most critical information drives the predictions.

The LightGBM model with feature engineering is showed inoffers a nuanced understanding of water consumption dynamics, particularly over short and medium-term horizons. For the 6-month forecast, the model demonstrates remarkable precision in tracking the actual water consumption trends, effectively capturing both abrupt shifts and recurring seasonal patterns. This performance can be attributed to its reliance on well-designed features, including lag variables and rolling means, which encapsulate historical consumption behaviors and smooth out irregularities. Moreover, LightGBM’s ability to assign feature importance dynamically ensures that critical variables, such as temperature and temporal markers like day-of-week or weekend indicators, are prioritized during the learning process. However, minor deviations during peak consumption periods suggest the potential for further optimization, perhaps through the inclusion of additional external drivers. Over the 18-month horizon, the model exhibits consistent performance in maintaining the overall trend alignment and seasonal pattern recognition, although some accuracy is sacrificed in capturing localized anomalies. This decline can be linked to the fading influence of lagged variables over extended periods and the inherent difficulty of modeling long-term variability with a gradient-boosting framework. Despite slight mismatches in predicting extreme events, the LightGBM model’s efficiency in handling large datasets and its capacity to generalize well over different temporal scales make it a compelling choice for forecasting tasks where both accuracy and computational efficiency are crucial.

By the use of an Stacking Ensemble model, our research investigated water consumption forecasting using a hybrid approach that combines multiple prediction techniques. Results are displayed in Figure. Analysis of 6-month forecasts revealed that merging different statistical approaches produced more accurate predictions than using any single method alone. The model successfully identified both day-to-day changes and seasonal trends in water usage patterns. While most predictions closely matched actual consumption data, some extreme usage peaks showed minor discrepancies, suggesting room for future refinement. When extended to 18-month predictions, the hybrid approach maintained its effectiveness in capturing both short-term fluctuations and long-term consumption patterns. The model proved particularly adept at identifying recurring seasonal changes in water usage. Empirical testing showed improved accuracy compared to traditional forecasting methods, especially when analyzing extended time periods. Though the model occasionally struggled to predict quick changes in consumption, it consistently provided reliable forecasts across various testing scenarios. These findings demonstrate the practical value of combining multiple forecasting techniques for water consumption prediction.

This LSTM Neural Network gives good results as showed in Figurein the forecasting of water consumption by using its strengths in portraying temporal dependencies within sequential data. The model stays close to the actual values during the 6-month forecast, showing good capture of short-term fluctuations and seasonality in the data. The LSTM architecture’s recurrent structure allows storing and using previously computed information at later time steps, which gives the network the capability to represent dynamic and nonlinear relations peculiar to water consumption patterns. Small deviations in the case of important peaks suggest potential influences from external factors not represented in the input features; however, the predictions generally show a high level of reliability. In the 18-month forecast, the LSTM continues to perform well in maintaining long-term seasonal trends and general consumption patterns. It is good at capturing dependencies over long sequences, which helps in sustaining its predictive accuracy over time. However, the model displays some limitation in dealing with things that represent abrupt changes or localized anomalies, as most long-horizon predictions are bound to do, because of the attenuation of temporal dependencies over such periods.

The LSTM and GRU hybrid model’s predictions are plotted in Figure, which has been good at capturing the short- and long-term dependencies of the water consumption dataset. In 6-month forecasting, the combination of LSTM and GRU architectures really models the sequential dependencies well and gives accurate predictions very close to real consumption patterns. The LSTM layers learn long-term trends, while the GRU layers introduce flexibility to account for more immediate temporal changes. Further, the inclusion of dense layers helps fine-tune interactions between features, and the dropout mechanism decreases overfitting, especially during periods of high variance. The hybrid structure ascertains a balanced approach to dealing with the complexities related to short-term fluctuations and periodic trends. The hybrid model demonstrates a high ability to maintain and extrapolate learned patterns throughout a long forecasting period of 18 months. While long-term prediction naturally shows some variances due to the nature of sudden changes in water demand, the model can maintain consistency with both seasonal and trend components. The addition of more dense layers increases the generalization capability of the model over long sequences, while dropout regularization prevents overfitting common in neural networks with high-capacity architecture.

The LSTM Neural Network with Rolling Mean Features takes a more simplified approach compared to the hybrid LSTM and GRU model with additional layers. Predictions obtained with this model are presented under FigureWhile rolling mean features succeed in smoothing out short-term fluctuations and providing a clearer representation of underlying trends, this model’s ability to adapt to sudden changes or to model complicated temporal patterns is limited by its lack of structural complexity—most specifically, the exclusion of GRU layers or additional dense layers. In the 6-month forecast, the model does well in generalizing trends and cyclical behavior, with the rolling mean features helping to stabilize the predictions. However, since this has no GRU layers, the model is less responsive to sharp, localized fluctuations; hence, slightly larger errors during abrupt changes in consumption compared to the hybrid model. To a certain extent, the rolling mean feature approach is able to expose more and more weaknesses in the 18-month ahead forecast. Although good at preserving long-term seasonal patterns, the model struggles more with smaller-scale oscillations and adaptive changes in water usage patterns. On the other hand, the hybrid model allows for much finer handling of the temporal dependencies over extended periods due to the combined strengths of LSTM and GRU layers.

The MV-LSTM model, presented by Niknam, exhibits its ability to fuse multivariate interdependencies by integrating external meteorological parameters with water consumption data. Predictions of water consumption are plotted in Figure. This enables the model to learn complicated relationships between climatic variables and water demand, which consequently enhances its performance in forecasting short-term consumption variability. The combination of these different input features makes the model more capable of learning temporal dependencies and complicated interactions, which guarantees stable predictive performance in shorter time frames. In longer horizons, MV-LSTM preserves the possibility of accurate predictions by maintaining seasonal patterns and general consumption trends. Its sensitivity to new changes decreases, yet it still reacts to dynamic external conditions due to the inclusion of the variables with lags and those representing meteorological data. By integrating multivariate inputs with sophisticated recurrent architectures, the MV-LSTM proves suitable for applications in which internal and external variables that impact water consumption need to be evaluated.

This study conducts an in-depth evaluation of a variety of forecasting models for the task of water demand prediction, with a special focus on their performance over both the short and long terms. Models considered range from various variants of Prophet to gradient boosting models using LightGBM and XGBoost and to state-of-the-art neural network architectures, including LSTM-based models and the lately proposed multivariate LSTM (MV-LSTM). Results in Tableindicate that the performances of these models differ substantially. Each of the methods thus has its pros and cons: while Prophet models show stable performance across the forecasting horizon, they reveal large improvements when advanced feature engineering is applied. The Prophet with Advanced Feature Engineering variant performs the best among the Prophet models: MAE of 5.76 and RMSE of 8.31 for the 6-month horizon, and MAE of 10.07 and RMSE of 15.02 for the 18-month horizon. Such improvement highlights the need to include domain-specific features, such as lagged variables and custom seasonalities, as these increase the model’s ability to recognize temporal patterns and seasonal trends. While Prophet models are computationally efficient and interpretable, they present limitations in adapting quickly to, for example, sudden changes in consumption for the longer forecast horizons.

Among all the gradient boosting models, LightGBM outperforms XGBoost for both short- and long-term horizons, with an MAE of 5.90 and RMSE of 8.25 for the 6-month horizon, and an MAE of 11.77 and RMSE of 18.31 for the 18-month horizon. This improved performance of LightGBM may be attributed to its capability of handling large datasets efficiently while capturing complex interactions among features by its gradient boosting framework. XGBoost is competitive but has slightly higher errors and more so with the longer-term horizon. Ensemble methods, such as stacking LightGBM and XGboost, are more robust but do not outperform LightGBM alone in terms of general accuracy. This underlines the stand-alone strength that LightGBM possesses for time series forecasting.

The neural network approaches, especially those based on LSTM, are capable of capturing complex temporal dependencies. The LSTM model performs well, with an MAE of 5.96 and RMSE of 9.38 for 6 months, showing its strength in short-term forecasting. However, the model’s performance slightly deteriorates for the 18-month horizon, with an MAE of 12.63 and RMSE of 20.66, pointing out some challenges in keeping high accuracy over longer time frames. The hybrid model LSTM + GRU, despite its architectural complexity, does not outperform the simpler configurations of LSTM, indicating that deeper layers and more components may introduce overfitting or a higher sensitivity to noise. The MV-LSTM proposed by Niknam outperforms all the other models with respect to accuracy in capturing multivariate dependencies. It realizes the lowest MAPE 15.48% for the 6-month horizon and performs well in the long-term horizon with an MAPE of 19.30%, which is the most accurate model concerning the relative percentage error. These results have highlighted the potential of multivariate approaches in leveraging external regressors to enhance predictive precision.

SECTION: Optimizing WDS Maintenance
In many rural water distribution networks, operators face challenges in determining the most effective routing and scheduling of maintenance activities. Such decisions are usually based on subjective judgment, which may lead to inefficiencies, especially where many activities with varying priorities and dependencies must be coordinated simultaneously. Without a systematic approach, operators are left to grapple with how to prioritize tasks in a manner that minimizes operational costs—travel time, CO2emissions, distance traveled—to the end user while resulting in longer times to complete tasks and suboptimal resource utilization. The problem becomes even more complicated when high-priority emergency tasks arrive at times that don’t agree with the existing schedule presented to the operator and when tasks depend on the execution of each other. This calls for more structured and dynamic scheduling with a view to incorporating uncertainties and task dependencies.

We are dealing with an NP-hard problem known as, in which there is a single resource that has to deal with multiple tasks, which may be interrupted (preemptions), new tasks may arrive at any moment, and some tasks may depend on the completion of others. This model incorporates, in each day, random assignments of dependencies between tasks to reflect real-world operational complexities where not all tasks are independent. The objective is to minimize general operational costs, including the total completion time, fuel consumption in liters, emissions of CO2, and delays of tasks, and optimally manage tasks with different priority levels, including high-priority emergency tasks, also known as emergency response activities while satisfying task dependencies.

Apart from saving time and delays in the completion of the tasks, the model also accounts for fuel consumption and CO2emissions by analyzing various task characteristics such as location, processing time, and gradients that affect fuel efficiency. With this scheduling model in place, the system is able to cope with the challenges in dynamic task arrivals, task dependencies, and preemptions while ensuring the proper execution of prioritized tasks. Given that the problem is NP-hard, we consider using CP as an approach that provides an optimized solution. In the following sections, we describe the mathematical formulation of the problem.

We have adapted the model to be compatible with CP, focusing on deterministic parameters. Uncertainties in processing and travel times are handled using expected or conservative estimates. The model aims to optimize the objectives while satisfying all constraints.

The objectives are to:

Minimize the total completion time ().

Minimize the total fuel consumption ().

Minimize the total CO2emissions ().

Minimize the total delays and penalties ().

Letbe the set of all tasks indexed by.

Letbe the set of processing segments for taskdue to preemption, indexed by.

Letbe the set of task dependencies, wheremeans taskdepends on task.

An example of task dependencies is provided in Table.

For each task:

: Deterministic processing time required for task(in hours), based on expected or conservative estimates.

: Deterministic travel time from taskto task(in hours), based on expected or conservative estimates.

: Fuel consumption for processing task(in liters).

: CO2emissions for processing task(in kg).

: Location coordinatesof task.

: Priority level of task(higher value indicates higher priority).

: Task’s release time (arrival time). For regular tasks,; for emergency tasks,.

: Distance from taskto task(in kilometers).

: Fuel efficiency of vehicle type(in km per liter).

: Emission factor of vehicle type(in kg CO2per liter of fuel).

: Start of the working day (e.g., 8:00 AM).

: End of the working day (e.g., 3:00 PM).

: Vehicle type required for task(e.g., Van, Small Truck).

: Maximum allowed number of preemptions per task.

Tableprovides an example of tasks and associated parameters.

The travel times and distances between tasks are provided in Table.

The fuel efficiency and emission factors for the vehicle types used are given in Table.

: Variables that define when each task or task segment starts and ends.

: Scheduled start time of segmentof task.

: Scheduled completion time of segmentof task.

: Scheduled processing time of segmentof task.

: Number of segments into which taskis divided due to preemption, where.

: Binary variables that determine the order in which tasks are performed relative to each other.

: Binary variable;if taskis scheduled immediately before task, 0 otherwise.

:

: Binary variable;if taskis preempted, 0 otherwise.

: Binary variable;if taskdepends on task, 0 otherwise.

: Binary variable indicating if segmentof taskis scheduled before segmentof task.

Where:

are the weights for time, fuel consumption, CO2emissions, and delays and penalties, respectively.

: Completion time of the last task segment.

: Total fuel consumption for processing and traveling.

: Total CO2emissions for processing and traveling.

: Total delays for emergency tasks beyond their release times.

The fuel consumption and CO2emissions for traveling between tasks are calculated using the following equations:

Using the data from Tables,, and, the calculated fuel consumption and CO2emissions for traveling are presented in Table.

: Ensure that each task’s total scheduled processing time, including preempted segments, matches the required time.

:

For all segmentsof task:

:

If taskdepends on task(i.e.,):

This ensures that taskcannot start before taskis completed.

:

When taskis scheduled immediately before task:

:

To prevent overlapping of processing times on the single machine, we include the following constraints for all tasksand their segmentsand:

Where:

is the completion time of segmentof task.

is the start time of segmentof task.

is a binary variable defined as:

is a sufficiently large positive constant.

:

Ensure tasks are scheduled within working hours:

:

:

: Delays for emergency tasks are included in the objective function throughas shown in Equation ().

:

:

Ensure that each task is preceded and succeeded by at most one other task:

(Miller-Tucker-Zemlin constraints):

Introduce variablesfor each task:

In addition to the objective function, we define the following performance metrics to evaluate the scheduling model:

:

This represents the total delay beyond the release timesfor all tasks.

:

This represents the percentage of time spent on processing tasks relative to the total time from the start to the completion of all tasks.

The above model addresses uncertainties in processing and travel times by using deterministic estimates, such as expected or conservative values. By adopting CP, we optimize the schedule while satisfying all constraints and providing robust solutions that effectively handle task dependencies, variable release times, preemptions, and multiple objectives (see Algorithmfor the pseudocode of our CP-based approach).

Note: The deterministic approach simplifies the model for CP solvers while still practically accounting for variability. This allows for efficient computation and implementation using tools like Google OR-Tools, which are well-suited for handling complex scheduling problems with the defined constraints.

The comparison and improvement of the proposed scheduling model against conventional operator methods are illustrated in Tableand Figure. These results represent the average performance obtained from 20 independent executions of the algorithm to ensure statistical robustness and reliability.

SECTION: Security Layer in DTs Platform
In the digital transformation era, DTs have become a cornerstone for enhancing operational efficiency and decision-making across industries. These virtual replicas, integral to systems from manufacturing to smart cities, leverage real-time data to mirror and predict the physical world’s behavior. However, the complexity of DTs introduces multiple layers of cybersecurity risks that must be meticulously managed. Cybersecurity for DTs is not just an add-on but a foundational component that ensures the safe functioning of these systems. Each aspect, from hardware and software to models and algorithms, requires comprehensive protection to defend against cyber threats. Without robust cybersecurity measures, DTs could become liabilities, offering cyber criminals potential backdoors to critical infrastructure.

To mitigate these vulnerabilities, implementing predefined security layers is essential. As detailed in Table, CAUCCES integrates a range of tailored cybersecurity strategies specifically for the context of smart water management. These strategies include advanced encryption methods for securing data at rest and in transit, rigorous access controls to limit interactions with DT systems to authorized personnel, and continuous monitoring to detect and respond to threats in real-time. The table also outlines the specific cybersecurity approaches applied in the CAUCCES project to protect DTs used in managing WDSs. This includes securing communication channels that transmit sensitive data, employing anomaly detection techniques to quickly identify potential threats, and implementing robust data flow integrity measures.

The integration of these cybersecurity measures is critical to maintaining the integrity and reliability of DTs. As these systems increasingly support essential infrastructure—from healthcare to public utilities—the stakes for cybersecurity can hardly be overstated. Ensuring the resilience of DTs against cyber threats is not merely about protecting information but about safeguarding public welfare and the environments these systems serve.

By proactively addressing cybersecurity and embedding it within DT technologies, organizations can prevent potential vulnerabilities, ensuring that DTs enhance, rather than compromise, the digital future. The CAUCCES project underscores the criticality of incorporating robust cybersecurity strategies within the DT framework for water management. By addressing key areas, including smart meter security, communication network protection, employee training, database security, anomaly detection, data privacy, real-time monitoring, and collaborative approaches, the project sets a benchmark in fortifying water infrastructure resilience against evolving cyber threats. This comprehensive approach strengthens infrastructure while fostering a culture of security awareness and preparedness, serving as a model for future DT and cybersecurity integration initiatives.

SECTION: Conclusion
This paper has explored the transformative potential of DTs in the water distribution sector, underscoring their pivotal role in enhancing system efficiency, reliability, and sustainability. By integrating IoT devices, advanced AI, and ML algorithms, DTs offer a dynamic and robust platform for simulating real-world water systems, enabling predictive maintenance, real-time monitoring, and strategic decision-making.

We presented a novel DT platform within the CAUCCES project, which integrates sophisticated AI/ML models—including LSTM networks, Prophet, LightGBM, and XGBoost—for accurate forecasting of water consumption based on historical and meteorological data. The model evaluations demonstrated that incorporating advanced feature engineering and hyperparameter tuning significantly improves forecasting accuracy, which is essential for effective water resource management. For instance, the Prophet model with advanced feature engineering achieved a MAE of 5.76 and a MAPE of 18.61% over a 6-month forecasting horizon, outperforming basic models.

Additionally, we addressed the optimization of WDS maintenance by formulating a scheduling problem using CP. The proposed model effectively minimizes total completion time, fuel consumption, CO2emissions, and delays, enhancing operational efficiency and reducing environmental impact. The results indicated a 14% reduction in total completion time and a 17% decrease in CO2emissions compared to conventional methods, highlighting the efficacy of the CP-based approach in handling complex scheduling problems in WDS maintenance.

Moreover, the platform’s emphasis on cybersecurity ensures the integrity and confidentiality of data, a critical aspect given the increasing threats in the digital landscape. Implementing robust cybersecurity measures aligned with standards like ISO 27001 protects the system against potential cyber-attacks, ensuring continuous and reliable service delivery.

Future research lines could prioritize the integration of more advanced artificial intelligence and machine learning methodologies, including deep learning frameworks and ensemble techniques, with the focus of improving the accuracy of the prediction of water consumption and anomaly detection. Combination of real-time data analytics with optimization techniques may, therefore, yield a possible way to shift toward more dynamic and adaptive management of water distribution systems, one that reacts rapidly to change and unexpected events. Likewise, the expansion of this platform to greater and complex water networks and integration with other utility systems can provide urban resource management in an altogether more holistic approach. In addition, a better user interface and extensive training programs for utility operators and stakeholders could help achieve greater adoption of the platform. There is a need for continuing compliance with evolving cybersecurity measures and regulatory requirements in order to maintain data security and system integrity. Lastly, future releases of the platform could contain elements focused on assessing and reducing environmental impacts, such as water loss and energy consumption, and thereby contribute significantly to sustainable development goals.

SECTION: Declarations
This project is carried out within the framework of the funds of the Recovery, Transformation and Resilience Plan, financed by the European Union (Next Generation). The publication is part of the Spanish Strategic Cybersecurity Project “Artificial Intelligence applied to Cybersecurity in Critical Water and Sanitation Infrastructures (***/**)” funded by Instituto Nacional de Ciberseguridad de España (INCIBE).

The authors declare no conflicts of interest relevant to the content of this article.

Not applicable.

Not applicable.

All code and datasets used in this study are publicly available at.

Not applicable.

All authors contributed equally to the conception, design, drafting, and revision of the manuscript.

SECTION: References