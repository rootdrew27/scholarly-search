SECTION: A time-causal and time-recursive analogue of the Gabor transform
This paper presents a time-causal analogue of the Gabor filter, as
well as a both time-causal and time-recursive analogue of the Gabor
transform, where the proposed time-causal representations obey both
temporal scale covariance and a cascade property over temporal
scales. The motivation behind these constructions is to enable
theoretically well-founded time-frequency analysis over multiple
temporal scales for real-time situations, or for physical or
biological modelling situations, when the future cannot be accessed,
and the non-causal access to the future in Gabor filtering is therefore
not viable for a time-frequency analysis of the system.

We develop a principled axiomatically determined theory for
formulating these time-causal time-frequency representations, obtained
by replacing the Gaussian kernel in the Gabor filtering with a
time-causal kernel, referred to as the time-causal limit kernel, and
which guarantees simplification properties from finer to coarser
levels of scales in a time-causal situation, similar as the Gaussian
kernel can be shown to guarantee over a non-causal temporal domain. We
do also develop an axiomatically determined theory for implementing a
discrete analogue of the proposed time-causal frequency analysis
method on discrete data, based on first-order recursive filters
coupled in cascade, with provable variation-diminishing properties
that strongly suppress the influence from local perturbations and
noise, and with specially chosen time constants to achieve
self-similarity over scales and temporal scale covariance.

In these ways, the proposed time-frequency representations guarantee
well-founded treatment over multiple temporal scales, in situations when the
characteristic scales in the signals, or physical or biological
phenomena, to be analyzed may vary substantially, and additionally all
steps in the time-frequency analysis have to be fully time-causal.

SECTION: 
The Gabor filter, proposed by Gabor, defines a time-frequency
transform corresponding to a windowed Fourier transform, with the
Gaussian kernel used as a temporal window function.
By varying the temporal duration of that Gaussian window
function, time-frequency decompositions can be obtained at different
temporal scales. Specifically, when using this type of time-frequency
decomposition, the time-frequency representations at any coarser level of
temporal scale will be related to the time-frequency representations at
any finer temporal scales, by both a temporal scale covariance property and a
cascade smoothing property over temporal scales.

The Gabor function is, however, not a time-causal kernel, in the sense
that the Gaussian window function makes use of information from the future in
relation to any time moment. This property, thus, prevents Gabor filtering from being
used in real-time situations, in which the future cannot be
accessed.

Instead, for real-time processing ofauditory
signals, approaches such as the Gammatone filter have been
developed and used by Johannesma,
Patterson,,
and Hewitt and Meddis.
The Gammatone filter does, however, not obey similar theoretical
properties over a time-causal temporal domain as the Gabor filter
family obeys over a non-causal temporal domain,
regarding temporal scale covariance and
cascade smoothing properties.
A related form of time-frequency analysis, based on time-causal and
time-recursive temporal filtering operations,
has been proposed by Lindeberg and Friberg,
however, not reaching
full temporal scale covariance, as in the work to be presented here.
For more general overviews of methods for time-frequency analysis, we
refer the reader to the treatments by Feichtinger and Strohmer,
Qian and Chen,
Gröchenig, Flandrinand the references therein.

The subject of this article is to describe a time-causal analogue of
Gabor filtering, that makes it possible to define time-frequency
representations for real-time situations, and which also obeys
temporal scale covariance and cascade smoothing property over temporal
scales, in such a way that time-frequency representations at different
temporal scales can be theoretically related. To achieve this property,
we shall replace the non-causal Gaussian kernel in the Gabor filter
with a time-causal kernel, referred to as the time-causal limit
kernel, and which ensures theoretically consistent treatment of
structures in temporal signals over
multiple temporal scales, see Lindeberg.
By a slight modification, the resulting time-frequency representation
can also be made fully time-recursive, implying that it can
be computed in terms of a set of first-order
integrators coupled in cascade, with especially selected time
constants to achieve temporal scale covariance. For discrete
implementation, the first-order integrators can, in turn, be
approximated by a small set of first-order recursive filters coupled in
cascade, making real-time implementations both straightforward and
computationally very efficient on regular
signal processing hardware.

In this way, the presented theory provides both a principled theoretical
framework for expressing time-frequency representations for modelling
and analyzing physical and biological processing for which the future
cannot be accessed, as well as a framework for processing and analyzing
temporal signals in real time.

The presented theoretical framework is intended for applications where
it is critical to perform time-frequency analysis in real time,
specifically where time-delayed analysis of pre-recorded temporal data
is not applicable or else regarded as an unrealistic simplification
of the actual physical situation. Such constraints arise in time-critical technical
systems, where real-time time-frequency analysis may be an integrated part of a
control loop mechanism, or a real-time analysis or monitoring system,
as well as when
modelling physical or biological processes, for example the brain and the nervous
system, (such as the analysis of sound stimuli in auditory perception),
where it constitutes a strong evolutionary advantage both for an
individual and a species to be
able to react fast,, in fight or flight scenarios.

Due to the presented computationally very efficient discrete implementation of
the proposed time-causal and time-recursive analogue of the Gabor
transform, this time-frequency transform could also, beyond real-time
applications, be beneficial for offline analysis of larger datasets,
since it can be very well
approximated by applying a low number (here 4 to 8) of recursive
filters coupled in cascade.

SECTION: 
In Section, we begin by stating two important
properties of the regular Gabor filters and the regular Gabor transform under temporal
scaling transformations, as well as in relation to time-frequency
analysis over multiple temporal scales, that we will then generalize
to a non-causal temporal domain.

Sectionthen defines time-causal
analogues of Gabor filters and the Gabor transform, obtained by
replacing the Gaussian kernel in these time-frequency representations with a special
time-causal kernel, referred to as the time-causal limit kernel.
The theoretical background to the time-causal limit kernel in terms of
temporal scale-space kernels is described, as well as basic properties
of this kernel that we will build upon.

Sectionthen shows how the
desirable properties in terms of temporal scale covariance and a
temporal cascade smoothing property hold for the proposed time-causal
analogues of Gabor filters and the Gabor transform.
Sectionoutlines how the time-causal analogue
of the Gabor transform can be
implemented in practice on discrete signals, in terms of fully
time-causal and time-recursive operations, also suitable for real-time
implementation.

Sectiongives a theoretical
analysis of properties of the proposed time-frequency analysis
concept, regarding temporal delays and frequency selectivity characteristics.
Sectionpresents experiments of applying the proposed
concepts to multi-scale time-frequency analysis of an audio signal
over multiple temporal scales,
for four main use cases regarding the parameter settings.
For comparison, we also show the result of computing truncated and
time-delayed Gabor transforms for the same signal, based on using a
similar temporal delay for the truncated and time-delayed Gabor
transforms as for the time-causal and time-recursive analogue of the
Gabor transform, while setting all contributions, that would have implied
forbidden access to the future, to zero.

Sectionthen derives a set of
theoretical estimates, to characterize basic properties of the proposed
time-causal and time-recursive analogue of the Gabor transform, in
terms of frequency selectivity,
and how those properties differ from the regular non-causal Gabor
transform, based on fully continuous responses to ideal sine waves.
Sectionthen complements that
theoretical analysis will numerical simulation experiments, to characterize
how robust the resulting time-causal frequency estimates will be to
noise, and then also including the effects of discretizations over time and
in the frequency domain, that are necessary for a discrete implementation.

Sectionsummarizes the basic
covariance properties under transformations of the signal domain, that
the proposed time-causal and time-recursive analogue of the Gabor
transform obeys under basic transformations of the signal domain, and
which thereby imply a certain degree of robustness to these classes of
transformations of the input signal.

Finally, Sectionconcludes with a summary of some
of the main conceptual results.

SECTION: 
This paper also comprises an extensive appendix with complementary
theory and technical details, which the treatment in the main part of
the paper builds upon, but where many technical details have been put in the appendix,
to keep the main presentation of the paper as conceptual as possible,
and as a simplification for the first-time reader of the paper.

Appendixgives an extensive treatment
of theoretical motivations why the proposed time-causal time-frequency
analysis concept can be regarded as a time-causal analogue of the
Gabor transform. A set of theoretical arguments, in terms of
information-reducing properties is developed, by which
the Gaussian kernel can be singled out as a canonical choice of
temporal window function when defining a non-causal time-frequency
transform, and which in this way uniquely singles out the Gabor
transform as a canonical time-frequency transform over a non-causal
temporal domain. By then stating as similar as possible requirements
regarding the formulation of a time-causal frequency analysis concept, as can
be stated given the constraints arising from the fact that the future
cannot be accessed in a time-causal scenario,
we present a set of theoretical arguments, that
lead to using the time-causal limit kernel as a canonical temporal
window function for a time-causal time-frequency analysis.

Appendixthen addresses the problem of
formulating an as theoretically well-founded approach for defining a
discrete analogue of the proposed time-causal analogue of the Gabor
transform. Based on a classification of which discrete temporal kernels
guarantee that the number of local extrema, or equivalently the number
of zero-crossings, must not increase when filtering from finer to coarser levels of
temporal scales, we first arrive at a finite set of possible candidate
time-causal kernels, out of which the single choice of first-order
discrete integrators arises as the unique choice, that also constitutes
a true numerical approximation of the continuous first-order
integrators coupled in cascade, and which describe the temporal smoothing
effect of the time-causal limit kernel used for defining the proposed
time-causal analogue of the Gabor transform. Specifically, a detailed
outline of an algorithm for computing the proposed discrete
analogue of the time-causal analogue of the Gabor transform is
given in Appendix, with a complementary
description for real-time implementations in Appendix.

Appendixdescribes a discrete
analogue of the continuous Gabor transform, that arises out of the
classification of the discrete kernels that guarantee non-creation of new
local extrema from finer to coarser levels of scale.

Appendixoutlines how
inverse transforms of the time-causal analogue of the Gabor transform
can be defined. Notably, those inverse transforms are, however, not
time-causal—it is explicitly explained why. Therefore, those inverse
transforms may not be directly applicable for time-critical real-time
applications, why this contribution should then mainly be intended for
temporal processing that is not time-critical, such as offline
analysis. With respect to the main target context of this paper,
concerning real-time computations of time-frequency transforms, the
treatment in Appendixshould therefore be regarded
as mainly theoretical, in the respect that it demonstrates
that the proposed new time-causal time-frequency
analysis concept constitutes a true time-frequency transform.

SECTION: 
Withdenoting the variance of the Gaussian window
function, the Gabor filter is defined as

and the Gabor transformof a functionas

Convolution of a signalwith a Gabor functionis therefore related to the Gabor transform ofaccording to

The top row in Figureshows Gaussian kernels at a few levels of
scale, and the top row in
Figureshows the real and imaginary parts
of corresponding Gabor functions, obtained by multiplying the Gaussian
kernel with a complex sine wave.

By varying the temporal scale parameterin the Gabor transform, different trade-offs
can be obtained between the resolution in the temporal domainthe resolution in the frequency domain. A long temporal scale will
imply a high
resolution in the frequency domain, at the cost of a lower resolution in
the temporal domain, whereas a short temporal scale will increase the
resolution in the temporal domain, at the cost of a lower resolution in
the frequency domain. By using multiple values of the temporal scale
parameter in parallel, it is hence possible to obtain multiple
trade-offs between these conflicting requirements.
When constructing such time-frequency representations at multiple
scales, it is, however, essential that the resulting
representations are mutually compatible, which we will henceforth
show that they are, in terms of temporal scale covariance and temporal
cascade smoothing properties.

SECTION: 
Under a scaling transformation of the temporal domain,

for some temporal scaling factor, the Gaussian kernel
transforms as

provided that the temporal scale parameterin the transformed
domain is related to the temporal scale parameterin the
original domain according to

This property implies that the Gabor function transforms
according to

provided that the angular frequencyin the transformed
domain is related to the angular frequencyin the original
domain according to

This transformation property does, in turn, mean that the Gabor transform
of a rescaled temporal signal

is related to the Gabor transform of the original signal according to

with

In other words, this temporal scale covariance property implies that
under a rescaling of the temporal domain, it is possible to perfectly
match the time-frequency representation of the rescaled signal to the
time-frequency representation of the original signal, provided that
the values of the angular frequency parameterand temporal scale
parameterare transformed accordingly.

SECTION: 
Due to the semi-group property of the Gaussian kernel

it follows that the Gaussian kernel at a coarse temporal scaleis related to the Gaussian kernel at a finer temporal scale

This property does, hence, imply that the Gabor transformat a coarse temporal scaleis related to the Gabor transformat any finer temporal scaleaccording to

In other words, provided that the Gaussian kernel can be regarded as a
simplifying kernel from finer to coarser levels of temporal scales,
which it indeed is, due to the theory of continuous temporal
scale-space kernelsin LindebergSection 2.1,
this property implies that
the Gabor transform at any coarse temporal scalecan be
regarded as a simplification of the corresponding Gabor transform
at any finer temporal scale.
This property constitutes a strong support for using the Gabor
transform over multiple temporal scales, to formulate a multi-scale
time-frequency analysis.

SECTION: 
Under a temporal shift

the Gabor transform transforms according to

corresponding to a temporal translation covariance property.
The Gabor transform is therefore closed under a shift of the temporal axis.

SECTION: 
A fundamental problem when trying to apply the above Gabor filtering
theory to real-world temporal signals, however, is that the temporal
window function,the Gaussian kernel, is not
time-causal. The Gaussian kernel accesses values of the signal from the
future in relation to any temporal moment, and can therefore not be
used for processing real-time signals, for which the future cannot be
accessed.

In the following, we will describe a way to define a time-causal
analogue of Gabor filtering, by replacing the Gaussian kernel with a
specially chosen kernel, referred to as the time-causal limit kernel,
and which obeys both the properties of temporal scale covariance and a
cascade property over temporal scales, to ensure a well-founded
definition of a time-frequency analysis over multiple temporal scales,
also in the case of a truly time-causal temporal domain.
Specifically, for the resulting time-causal analogue of the Gabor
transform, the computations are also fully time-recursive, and
can be implemented as the composed convolution with a set of truncated
exponential kernels coupled in cascade, in turn, equivalent to a set of first-order integrators
coupled in cascade.

SECTION: 
When to formulate a time-causal analogue of the Gaussian window
function, one may ask: “Would any time-causal function do?”.
That is, however, not the case. Of crucial importance with respect to
a multi-scale analysis is that the transformation from a finer to a
coarser temporal scale does not introduce new temporal structures at
coarser levels of scale, not present at finer levels of scale.

In the area of temporal scale-space theory, developed by
Koenderink,
Lindeberg and Fagerströmand
Lindeberg,, this topic has been extensively
treated for the domain of regular temporal or spatio-temporal signals;
in other words, signals without a complementary explicit treatment of
local frequencies in the signal.

Specifically, the notion of a temporal scale-space kernel has been
defined as a kernel that guarantees that the number of local extrema
(or equivalently the number of zero-crossings) in a temporally
smoothed signal must not exceed the number of local extrema in the
original signal. Summarizing the treatment in
LindebergSection 2.1,
it can, based on classical results by Schoenberg, be
shown that a (not necessarily time-causal) 1-D continuous kernel is scale-space kernel if
and only if it can be decomposed into convolutions with a Gaussian kerneland/or a set of truncated exponential kernels coupled in cascade.

By adding the complementary requirement of temporal causality, it
additionally follows that truncated exponential kernels

coupled in cascade are the only possible temporal scale-space kernels,
that respect forbidden access to the future,
and thus the natural candidate window functions to be used, when to formulate a
time-causal analogue of Gabor filtering.

Each such primitive truncated exponential kernel does, in turn,
correspond to a first-order integrator of the form

wheredenotes the input signal andthe output
signal. In this way, the temporal smoothing process, resulting from a
temporal scale-space kernel, will follow the input signal, although
not fully, and also with a certain amount of temporal delay, as
determined by the time constant.

SECTION: 
Out of the multitude of possible ways of combining truncated
exponential kernels with different time constants in cascade, it can
be shown that a particular way of choosing the time constants does
additionally allow for simultaneous temporal scale covariance and a
cascade property over temporal scales.
Consider the temporal kernel defined as the infinite convolution of a
set of truncated exponential kernels in cascade, having a composed
Fourier transform of the form (see Lindeberg)

whereis a distribution constant that determines the temporal
scale levels according to a geometric distribution.
Over the temporal domain, this function corresponds to an infinite
convolution of truncated exponential kernels in cascade

where

Under convolution with the temporal smoothing kernel defined in this
way, a smaller value of the distribution parameterwill lead to a
denser sampling of the temporal
scale levels, at the cost of longer temporal delays and and increased
amount of computations. A larger value ofwill, on the other hand,
lead to more
rapid temporal response properties (shorter temporal delays) as well
as less computations, however, at the cost of a more sparse sampling of
the temporal scales, which may affect the results, if a multi-scale
analysis also aims at tracking features across temporal scales.

When approximating the time-causal kernel using a finite numberof
temporal scale levels, the temporal scale levels are instead determined according to
(see Lindeberg),

and with the finer scale time constants according to
(see Lindeberg)

where, thus, the finer scale
temporal scale levelswill cluster infinitely dense near scaleas.

As described in Lindeberg, the
resulting temporal limit kernel,, defined as the
infinite convolution of truncated exponential kernels with time
constants, is covariant under temporal scaling transformations
of the form

for integer values of

provided that the temporal scale parameters are matched according to

The time-causal limit kernelalso obeys the following cascade
smoothing property over temporal scales
(see Lindeberg)

here, for simplicity, expressed only as a relation between adjacent
levels of temporal scale (and).

The middle and bottom rows in Figureshow examples of time-causal limit kernels for a few
combinations of the temporal scale valuesand the
distribution parameter.

SECTION: 
If we multiply the time-causal limit kernel with a complex sine wave,
then we obtain the following complex-valued extension of the time-causal
limit kernel

which can be seen as a time-causal analogue of the Gabor function.

The middle and bottom rows in
Figureshow examples of such time-frequency kernels for a few combinations of
temporal scale valuesand angular frequencies.

SECTION: 
Motivated by the above construction, we can also define a time-causal
analogue of the Gabor transform () according to

Note specifically, that, by the definition of the temporal smoothing kernelin terms of a set of truncated exponential kernels coupled in cascade,
in turn equivalent to a set of first-order integrators in cascade,
the temporal smoothing process, needed to implement this operation in
practice, can be performed in a fully time-recursive manner,
in the sense than no other temporal memory of the past is needed than
the information contained in the multi-scale representation of the
primitive temporal smoothing stages over multiple temporal scales itself.
In this respect, the time-causal analogue of the Gabor transform lends
itself to real-time modelling of physical or biological processes, as
well as to real-time processing of measurement signals, by computations
that are inherently local over time.

In analogy with the relationship () between Gabor filtering
and the Gabor transform, the time-causal analogue of the Gabor
transform is related to filtering with the complex-valued extension of
the time-causal limit kernel () according to

Thus, we can interpret the kernels shown in the bottom four rows in
Figureas describing the
essential effect of the time-frequency filtering operations that take
place in the time-causal analogue of the Gabor transform.

A derivation of an inverse transform for the time-causal analogue
of the Gabor transform is given in
Appendix, as well as
an outline of how to define other possible inverse transforms of this
overcomplete time-frequency transform.

SECTION: 
In this section, we will describe a set of theoretical properties that
the complex-valued extension of the time-causal limit kernel and the
time-causal analogue of the Gabor transform obey, with regard to
defining a time-frequency analysis over multiple levels of temporal
scales.

SECTION: 
A complementary motivation for why the proposed
time-frequency analysis concept can be regarded as a time-causal
analogue of the Gabor transform is given in
Appendix.

In that appendix, first of all, a set of principled theoretical symmetry
arguments is presented, regarding theoretically well-founded
processing of signals over different temporal scales, that uniquely single out
the choice of the continuous Gaussian kernel for defining a
time-frequency transform over a non-causal temporal domain, where the
relative future in relation to any pre-recorded time moment can indeed
be accessed. These principled arguments, thus, uniquely lead to the
Gabor transform as a canonical time-frequency analysis concept over a
non-causal temporal domain.

Then, it is shown how the formulation of as similar principled
theoretical symmetry arguments as possible, given the additional
contraints due to the restriction to time-causal window functions
only, for which the future cannot be accessed,
lead to the choice of the time-causal limit kernel as a
canonical temporal window function for formulating a multi-scale
time-frequency analysis concept over a time-causal temporal domain.
These theoretical arguments do, thus, show how the proposed time-causal
time-frequency analysis concept can be determined in a principled way,
based on desirable symmetry properties with respect to processing over
multiple temporal scales.

Over purely either non-causal or time-causal temporal domains, as
well as over joint either non-causal or time-causal spatio-temporal
domains, corresponding principled ways of reasoning, based on related
theoretical symmetry properties, can be shown to single out canonical
classes of temporal smoothing kernels in models for either purely
temporal or joint spatio-temporal models of receptive fields,
see Lindeberg.
Specifically, the Gaussian kernel is in these ways singled out as the
canonical temporal smoothing kernel over a non-causal temporal domain,
whereas the time-causal limit kernel arises as a canonical choice of
temporal smoothing kernel over a time-causal temporal domain.

In these respects, there are conceptual similarities between the proposed
way of defining a time-causal time-frequency analysis, and previously
developed approaches for processing either purely temporal signals or
joint spatio-temporal video in a strictly time-causal manner.

SECTION: 
Under a scaling transformation of the temporal domain,

for some temporal scaling factor,
for someand any, the time-causal analogue of the
Gabor function,, the complex-valued extension of the
time-causal limit kernel (), transforms according to

provided that the angular frequency is transformed according to

and the temporal scale parameter according to

This property follows from the scaling property ()
of the time-causal limit kernel under temporal scaling transformations for, wheremust be an integer.

Similarly, the time-causal analogue of the Gabor transform
() applied to a rescaled temporal input signal

is related to the time-causal analogue of the Gabor transform applied
to the original signal according to

with

In these ways, both the complex-valued extension of the time-causal
limit kernel and the time-causal analogue of the Gabor transform obey
similar transformation properties under temporal scaling
transformations of a time-causal temporal domain as the regular Gabor function
and the regular Gabor transform obey over a non-causal temporal domain.

SECTION: 
Based on the cascade smoothing property over temporal scales
() for the time-causal limit kernel
(),
it follows that the time-causal analogue of the Gabor transform will obey a similar cascade
smoothing property

which in turn can be applied recursively, to express a cascade
smoothing property from any finer to any coarser (discrete) levels of
temporal scalein the time-causal analogue of the Gabor transform.

In this respect, the time-causal analogue of the Gabor transform obeys
a structurally similar cascade smoothing property over temporal scales
over a time-causal temporal domain
as the regular Gabor transform ()
obeys over a non-causal temporal domain,
with the minor differences that (i) the non-causal Gaussian kernel is
replacedby a set of truncated exponential kernels coupled in cascade,
and (ii) the temporal scale levels are discrete in the time-causal
analogue of the Gabor transform, whereas the temporal scale levels are
defined over a continuum for the regular Gabor transform.

SECTION: 
Under a temporal shift

the time-causal analogue of the Gabor transform according to

In other words, the time-causal analogue of the Gabor transform is covariant under shifts of the
temporal axis.

SECTION: 
These properties together imply that the time-frequency representation
obtained from the time-causal analogue of the Gabor transform has the
theoretically attractive properties that it is closed under
(i) temporal shifts and (ii) uniform rescalings of the temporal axis
for temporal scaling factors that are integer powers of the
distribution parameterfor the time-causal limit kernel.

In these respects, the presented method for time-causal frequency analysis obeys essentially similar
transformation properties as the regular Gabor transform over a
non-causal temporal domain, and as can
be described by the Heisenberg group
(see Feichtinger and Gröchenig).

SECTION: 
When to implement the above operations for processing discrete signals
in practice, there does indeed also exist a
corresponding discrete theory of temporal scale-space kernels to build
upon.

SECTION: 
Following the results of an axiomatic classification of discrete temporal scale-space
kernels, characterized by the property that they are guaranteed to not
increase the number of local extrema or zero-crossings in a discrete
signal, in LindebergSection 4.1, in turn based on
classical results by Schoenberg, with these arguments
summarized in Appendix,
we do for discrete signals replace the temporal smoothing operation in
the time-causal limit kernel with a
cascade of first-order recursive filters
normalized to the form

which constitutes both the discrete analogue of the first-order continuous integrators
(), and which is also maximally
well-conditioned with respect to possible numerical
errors.

Note in particular in this context that, since the time
constantis positive, the feedback factor in the recursive
update is guaranteed to always be less than 1, thus guaranteeing that
spurious perturbations in the discrete measurement signal or due to
numerical errors in the computations are guaranteed to be reduced over
time. This damping effect is, of course, stronger for larger values of
the time constant.

With respect to the numerical stability of this implementation method, it
does, furthermore specifically follow, from the concept of temporal
scale-space kernel itself, that the number of local extrema
(or equivalently the number of zero-crossings) is guaranteed to not
increase by these discrete filtering operations. In this way, the
resulting discrete implementation is guaranteed to serve as
a formal smoothing transformation over time, to gradually suppress the
influence of spurious fine-scale structures in the signal, such as
local perturbations or noise.

The resulting discrete approximation can also be formally be shown to
correspond to a true numerical approximation of the corresponding
continuous theory, see Appendix.

SECTION: 
Then, to obtain the same amount of temporal smoothing as in the
continuous case, we make use of
the fact that the variance of a single first-order integrator is

and computefrom the desired scale incrementbetween adjacent levels of temporal scale levels

according to LindebergEquation (55)

see Appendixfor a detailed
outline of how to implement these computations in practice.

By this way of determining the time constantsfor the discrete
temporal smoothing operations, the discrete variance of the discrete temporal
smoothing kernels, that define the temporal window functions in the resulting
discrete analogue of the time-causal analogue of the Gabor transform

will be equal to the continuous variance of the corresponding
continuous smoothing kernels

that define the temporal window functions in the true continuous
time-causal analogue of the Gabor transform. In this respect, the
notion of temporal scale, as reflected by the temporal duration
of the temporal window function, is preserved between the
continuous theory and the discrete implementation.

SECTION: 
Specifically, all the temporal smoothing computations needed to
implement the time-causal analogue of the Gabor transform will
therefore be local over time, and do not require any complementary
memory of the past beyond the last previous time frame,
since all the necessary information of the past is
stored in the temporal multi-scale representation itself.
In this way, the time-causal analogue of the Gabor transform is fully
time recursive, and lends itself to real-time processing of signals
using a compact signal processing architecture.

Appendixgives a detailed outline of
how to implement the temporal smoothing operations in terms
of strictly time-recursive computations for real-time applications.

SECTION: 
For practical implementations, we usually choose the distribution parameterof the time-causal limit kernel asor, and approximate the time-causal limit
kernel at the finest level of scale in a multi-scale analysis using
the firsttofirst-order recursive filters having the longest
time constants.

Due to the exponential decrease of the time constants
as function of the scale depth, the numerical error caused by such a
truncation will for many purposes be quite moderate. If a more
accurate numerical implementation is needed for special purposes, then
the truncation error can be reduced by increasing the number of temporal
scale levels, however, at the cost of more computational work.

SECTION: 
In this section, we will describe properties of the proposed
time-causal analogue of the Gabor transform, based on a theoretical
analysis of the temporal delays and the frequency selectivity
characteristics of the proposed methodology for
time-causal time-frequency analysis.

SECTION: 
Due to the temporal causality of the temporal window function in the
time-causal analogue of the Gabor transform, all such measurements
from a signal will be associated with non-zero temporal delays.

To estimate the temporal delay of the time-causal limit kernel, we can
estimate the temporal mean of the continuous time-causal limit kernel
as

Based on an approximation of the time-causal limit kernel in
terms of Koenderink’s scale-time kernel,
the temporal location of the temporal maximum of the time-causal limit
kernel can also be estimated as
(see LindebergEquation (39))

The latter estimate corresponds to a slight overestimate, while constituting
a better estimate of the temporal delay than the temporal mean.

From these expressions, we can clearly see that the amount of
temporal delay is proportional to the temporal scale of the
temporal window function in units of the standard deviation
of the temporal smoothing kernel.
We can also see that the temporal delay becomes shorter, when
increasing the value of the distribution parameterin the
time-causal limit kernel.

For the two default values of the distribution parameterandconsidered in this work, these temporal
delay estimates do specifically assume the values according to
Table, based on estimates in terms of the mean valueor the temporal maximum.

Specifically, the ratio between the temporal delays, based on the
position of the temporal maximum of the time-causal limit kernel
for the two default valuesor, is given by

In other words, the estimate of the temporal delay based on the
temporal position of the temporal maximum point of the temporal
smoothing kernel is for the same value of the temporal duration
of the temporal smoothing kernel in terms of its temporal varianceabout 70 % longer when usingcompared to using.Thus, if aiming at reducing the temporal
delays for real-time processing,
then usingis very much preferably compared to using.

Furthermore, since these estimates of the temporal delay are
proportional to the temporal standard deviationof the
time-causal limit kernel, it follows that, when choosing the temporal
standard deviation of the time-causal limit kernel proportional to the
wavelengthcorresponding to the angular frequencyin the time-frequency transform, as can be motivated from requirement
of temporal scale covariance, the temporal delays will be
different and specifically inversely proportional to each angular frequency. In
this respect, the time-causal analogue of the Gabor transform differs
fundamentally from the regular non-causal Gabor transform, in that special
attention has to be put on handling the different temporal delays for the
different angular frequencies, that will result in a time-causal time-frequency
transform defined from the principled requirement of temporal scale covariance.

SECTION: 
When using the time-causal analogue of the Gabor transform for
estimating local frequencies based on spectrograms, it is as
previously mentioned natural to
let the temporal scale parameter in units of the temporal standard
deviationbe proportional to the wavelengthof the angular frequency.
Denoting this proportionality factor by, we should thus have:

If we use a temporal-scale-dependent temporal window functionfor defining a time-frequency analysis

from which we then define the spectrogram from the absolute value

and then want to measure the response to a sine wave of a given
angular frequency

then it can be shown
(see Lindeberg and FribergEquation (114),
as well as Sectionin the present
paper, specifically the extended derivation leading to
Equations ()
and ())
that the dominant component in the frequency response, that describes
this dependency for values ofnear, is given by the entity

which on a logarithmic dB scale assumes the form

The variability in this entity, as function of the free angular
frequency, does, hence, describe the frequency
selectivity of the spectrogram, based on the time-frequency analysis
concept for the temporal window function.

For the regular non-causal Gabor transform, we have

or in dB

whereas for the time-causal analogue of the Gabor transform, we obtain

or in dB

Figureshows the result of plotting these entities for
characterizing the frequency selectivity for the two
values of the wavelength proportionality constantand,
and also using the two different values of the distribution parameterfor the time-causal limit kernel.

First of all, an immediate consequence of choosing the temporal
standard deviationof the temporal window
function proportional to the wavelengthcorresponding to the
angular frequencyis that the relative width of any spectral
band, as measured in terms of logarithmic angular frequencies,
will be independent of the angular frequencyof any probing sine wave signal.
Again, this property reflects the basic requirement of temporal scale
covariance, so as to be able to handle input signals with different
frequency characteristics in a similar manner.

Furthermore, as can be seen from the graphs, the
frequency selectivity for the time-causal spectrogram based on the
time-causal analogue of the Gabor transform is less narrow than for the
spectrogram based on the regular Gabor transform.

The frequency selectivity also becomes less narrow when increasing the
distribution parameterin the time-causal limit kernel, used as the
temporal window function for defining the time-causal spectrograms.
In this respect, there is a trade-off issue in that a higher value
of the distribution parameterleads to shorter temporal delays,
while then also making the frequency selectivity less narrow.

The difference widths of the spectral bands obtained in these ways do,
in turn, affect the ability of the corresponding time-frequency
transforms to resolve nearby frequencies, in that
more narrow spectral bands decrease the interference effects between
nearby frequencies in the time-frequency transform, compared to
corresponding interference effects between nearby frequencies
caused by wider spectral bands.

Fundamentally, we cannot expect the time-causal analogue of the Gabor
transform to have as narrow frequency selectivity properties as the
regular Gabor transform, since the time-causal analogue of the Gabor
transform can only make use of information about what has occurred in
the past, whereas the Gabor transform also grabs information from
the relative future in relation to any pre-recorded time moment. Additionally, the
Gaussian temporal window function in the Gabor transform corresponds
to an infinitely divisible distribution over a continuum of temporal
scale increments, whereas the time-causal limit kernel used as
temporal window function in the time-causal limit kernel is based
on macroscopic non-infinitesimal scale steps.

The frequency
selectivity of the time-causal limit kernel can, however, be steered
to become more narrow, by decreasing the distribution parameterdown towards 1. Then, however, the temporal delay will increase,
and additionally more computational work will also be needed to
implement the corresponding time-frequency analysis method,
since a larger number of layers will be needed to sufficiently well
approximate the time-causal limit kernel with a truncated finite
number of layers, when the distribution parameteris closer to 1.

Additionally, the frequency selectivity does also, for spectrograms
based on both the non-causal Gabor transform and the time-causal
analogue of the Gabor transform, become sharper when increasing the
proportionality constantrelative to the wavelength. Variations of
this parameter do thus also lead to a similar trade-off issue, in that a
larger value ofwill lead to sharper frequency selectivity
properties, while simultaneously increasing the temporal delay, since
the temporal scale of the temporal window function will increase.

From a requirement of being able to form the basis for making
decisions about possible actions in a real-time scenario, these
properties thus imply that in real-time scenarios it could be very
valuable to simultaneously perform multiple time-frequency analysis
stages over multiple time scales, which the proposed time-causal
analogue of the Gabor transform is highly suitable for.

SECTION: 
Figureshows an example of a straightforward
application of the presented theory for computing time-causal
spectrograms of an audio signal. In this application, we have let the
temporal scaleof the time-causal window function in the
time-causal frequency transform be proportional to the wavelengthfor each angular frequency,
for two values of the distribution parameterandin the discrete approximation of the time-causal limit kernel,
as well as for the two different proportionality constantsand.

As can be seen from these figures, the
frequency selectivity becomes more narrow when decreasing the
distribution parameter, whereas the temporal delay on the other hand
becomes shorter when increasing this parameter, in agreement with
the results of the above theoretical analysis in
Sectionand Section.

We can also see that the fine-scale spectrograms in the
top row have better ability to resolve temporal transients, however, at
the cost of a coarser frequency resolution. For the coarser-scale
spectrogram in the bottom row, the temporal scale is longer, leading
to a
sharper resolution of the frequencies, however, at the cost of a lower
temporal resolution regarding transients. These conflicting
requirements, thus, strongly motivate a multi-scale time-frequency
analysis, so that different trade-offs between the relative advantages
of using either shorter or longer temporal scales for the temporal
window function can be obtained, or at best even be obtained
simultaneously, by combining information from multi-scale spectrograms
over different temporal scales.

As a result of the theoretical
properties of the presented time-causal frequency transform, the
coarser-scale spectrogram can be seen as simplifications of the
corresponding finer-scale spectrograms, due to the cascade smoothing property over
temporal scales. In this example, the only essential difference
between these spectrograms at the different scales is that the coarse scale spectrogram
is computed withadditional layer of first-order temporal
integration relative to the fine scale spectrogram, which thus also saves
substantial computational work, if several multi-scale spectrograms are to be
computed in parallel in a real-time time-frequency analysis.

If attempting to compare the results from a truly time-causal analysis
to a non-causal analysis in an offline scenario, where the non-causal
analysis has access to the relative future in relation to any time
moment, while the time-causal analysis has not, we could, of course,
in general assume that the non-causal analysis should be able to
perform better, since it has access to more information.
To compare a time-causal analysis to other approaches in a more
realistic manner, it is therefore
more appropriate to also prevent access to the relative future in
relation to any time moment, for the other non-causal approaches that the
time-causal analysis is compared to.

Figureshows the result of such a
comparison between the proposed time-causal analogue of the Gabor
transform with the regular Gabor transform, with the substantial
modifications of the original non-causal approach in that (i) a
temporal delay has been added, corresponding to the temporal delay of
the corresponding (continuous)time-causal limit kernel for the same value of the
distribution parameteraccording to
(), and (ii) with the Gaussian
window function then truncated for the time moments when it would have
implied access to the relative future in relation to any pre-recorded
time moment.

As can be seen from the resulting truncated time-shifted Gabor
spectrograms, the resulting
truncation of the Gaussian window function in the Gabor transform
corresponding to the faster temporal response properties forthen
leads to substantial distortions in the spectrograms. Specifically,
the otherwise sharper frequency selectivity properties of the regular
Gabor transform are by the temporal truncation operation
replaced by a substantial widening of the spectral
bands, notably in relation to transients in the signal.
In this way, the resulting spectrograms become more noisy,
which could be expected to lead to problems for later processing
stages, that are designed to handle such spectrograms as their input.

Furthermore, the desirable theoretical properties of the regular
Gabor transform, in terms of a cascade smoothing property over
temporal scales and temporal scale covariance, will no longer hold after
the temporal truncation of the time-delayed Gabor transform.

Additionally, the true time-causal analogue of the Gabor transform can also
be computed much more efficiently than the truncated time-delayed Gabor
transform, because of the implementation of the time-causal analogue
of the Gabor transform in terms of a few layers of computationally
highly efficient first-order recursive filters coupled in cascade,
whereas the implementation of the truncated time-delayed Gabor
transform is based on explicit convolutions over support intervals of
longer temporal duration.

In these ways, the proposed time-causal analogue of the Gabor
transform should constitute a much better choice for performing a
time-causal time-frequency analysis thanperforming antruncation of a time-shifted Gabor transform, to
enforce temporal causality.

SECTION: 
Due to the requirement of temporal causality, we cannot,
as previously described, be able to expect fully similar
properties of a time-frequency analysis based on the time-causal
and time-recursive analogue of the Gabor transform as for
the regular non-causal Gabor transform, since a time-frequency
analysis based on the regular Gabor transform will for every time
moment also have access to information from future, which the time-causal
and time-recursive analogue of the Gabor transform does not have
access to. A non-causal time-frequency analysis will therefore be
based on more information than a time-causal time-frequency
analysis.

For this reason, it is of interest to characterize how the results
from a time-causal time-frequency analysis may differ from the results
of a non-causal time-frequency analysis, in terms of quantitative
performance measures.

In this section, we will perform such an analysis, based on
theoretical estimates regarding the the abilities of the time-causal
vs. the non-causal Gabor transforms to estimate the frequency of a
single sine wave. We will also provide explicit estimates of the width
of a spectral band for the time-causalthe non-causal
time-frequency analysis concepts, which constitutes a characteristing
property regarding the ability to separate nearby frequencies.

Then, in the following Section, we
will perform a complementary experimental analysis regarding the
robustness of local frequency estimates to noise, for actual
discrete implementations of the time-causal and time-recursive
analogue of the Gabor transform.

SECTION: 
Following Lindeberg and FribergAppendix
“Frequency selectivity of the spectrograms” on page 45 in that
paper, let us consider
the response of the time-causal time-frequency analysis
to a sine wave signal with angular frequency:

When computing the time-causal analogue of the Gabor transform,
we first compute the real and imaginary componentsand, respectively, according to

From basic rules for trigonometric functions, we have that:

The result of convolving these components with the time-causal limit
kernelcan then be expressed as a multiplication with
the magnitude of the the Fourier transformand adding the phaseof the
time-causal limit kernel.

With additionally the notationand,
however, with the arguments
ofandhenceforth dropped to save space, we then get

Thereby, after simplification, the magnitude of the spectrogram

is given by

wheredenotes the magnitude of the Fourier transform of
the time-causal limit kernel according to
()
andthe argument of the same Fourier transform.

Since the time-causal limit kernelis a low-pass filter, it follows that for angular frequenciesin the spectrogram near the angular frequencyof the
input sine wave, the entity

will, except for the non-essential scaling factor,
be the dominant term in the above expression for the spectral response,
and will thus forserve as
a reasonable approximation of the frequency selectivity propertiesfor the time-causal and time-recursive analogue of the Gabor transform
near the peak over the angular frequencies in the spectral band.

A specific consequence of the form for the expression
() is that, if we
disregard the influence of the smaller terms

and

in (),
where

then in the ideal
noise free case, the maximum value over the angular
frequenciesin the spectrogram, as modelled according to the
approximation

will be assumed for the angular frequency

since the magnitude of the Fourier transformin Equation ()
assumes its maximum value over the angular frequenciesfor. To that order of approximation, the estimate of
the angular frequency could therefore be regarded as bias free.

Next, one may ask: Could we also estimate the influence on the
frequency estimates, obtained from local extrema over the angular
frequency in the spectrogram, caused by the lower order termsandin the reformulation of the expression
() into

and also simultaneously study the influence of local perturbations in
the signal, in case there would be
interfering structures in the signal for other frequencies,
such as additional sine waves with nearby frequencies, or noise added to the
idealized model signal?

For angular frequenciesnear the angular frequencyof the input sine wave, it will hold that the absolute value of
the oscillatory termwill on average be
larger than the value of

whereis the wavelength corresponding the angular
frequencyof the input sine wave. This relationship follows
from the fact that fornear, we have that

because of the low-pass nature of the time-causal limit kernel.

Thus, to the next order of approximation, if we disregard the
influence on the spectrogramin () due to
the term, then the oscillatory factorin the oscillatory termin Equation () will after a Tayor expansion
approximation of the form

with the informal ordo notation “” here used as a place holder for
terms that are on average of smaller magnitude than the preceding terms,
have a relative influence on the
spectral band in the spectrogram, in relation to
the dominating term, of order

which when choosingreduces to

Furthermore, if we choose the temporal durationof the time-causal limit kernel proportional to
the wavelengthcorresponding to the angular frequencyin the time-frequency transform according to
(), then it follows after insertingaccording to ()
andinto the Fourier transform
() of
the time-causal limit kernel, that the resulting
perturbation measure

or in dB

will be independent of the angular frequency, in accordance with
required property of temporal scale covariance.

Hence, we can simply read off an estimate of the order of magnitude of
the relative influence of the oscillatory termin relation to the magnitude of the
dominant termin the approximation of
the spectrogramnear the center
of a spectral band from the values of the graphs in
Figurefor,
for each one of the four different use cases
regarding the default choices of the wavelength proportionality factorand the distribution parameterfor the time-causal limit kernel.

Computed numerically, we do, in turn, obtain the values according
to Tablefor the four main
use cases obtained by choosing the wavelength proportionality factorand the distribution parameter of the time-causal
limit kernel.
For comparison, Tableshows
corresponding perturbation measures computed for the regular
non-causal Gabor transform for.

From these estimates, we can conclude that, although the regular Gabor
non-causal Gabor transform leads to substantially smaller values of
these perturbation measures, the values of the perturbation measures for
the time-causal and time-recursive analogue of the Gabor transform
are quite low for the four main use cases studied here, with the largest magnitudedB assumed for the use
case with the wavelength proportionality factorand the
distribution parameterfor the time-causal limit kernel.
That use case does, in turn, correspond to the shortest temporal delay out
of the here considered four use cases.

Concerning the remaining termaccording to () in the
spectrogramaccording to
(),
the influence of that term differs from the influence of the
oscillatory term, in that it only affects
the variability in one direction of the angular frequency,
and may thus lead to a systematic bias.
In terms of magnitude, the relative influence of this term in
relation to the dominant termis, however, of the order of

with the corresponding relationship forwhen the
temporal durationis proportional to the
wavelengthcorresponding to the angular frequencyin the spectrogram

or in dB

where this entity is also independent of the angular frequency, because of the temporal scale covariance property.

In terms of numerical values, the above relation implies that we
obtain the dB value for the perturbation measureby multiplying
the dB value for the perturbation measureby 2.
In view of the dB values, listed forin Table,
the influence of the termon the frequency
estimate from a single sine wave ought therefore to be very marginal
for the four main use cases considered in this work.

SECTION: 
To estimate how much the frequency estimate of an ideal sine wave can
be expected to vary from the ideal estimateaccording to (), let us in the
following approximate the closed-form expression
() for the square of the
spectrogramby a
second-order Taylor expansion around the angular frequencyof the input sine wave.

By combining
Equations ()
and (), let us write the square of the spectrogram in
Equation () as

where the only explicitly time-dependent entity

assumes values in.

Let us next, again, let the temporal scalebe proportional to
the angular frequencyaccording to
(), and additionally reparameterize the variations
in the angular frequencyaround the angular frequencyof the sine wave according to

where the relative frequency variability variableshould then
assume values near.

By calculating the second-order Taylor expansion
of the logarithm for
the resulting expression for the square of the spectrogram, truncated to the firstfactors,
with the calculations performed in Mathematica,
we then obtain a resulting expression of the form

where the explicit expressions for,andare, however,
too complex to be reproduced here.

Truncating this Taylor expansion after the second-order term, and then
differentiating the resulting expression with respect to,
thereby gives that the estimate of the relative frequency variability
variable, given by

This result does, in turn, mean that the frequency estimatewill be off from the ideal valueby a factor of

By plotting the graphs of the estimated valueof the
relative frequency variability variable according to
() as function of the time-dependent factoraccording to () for each one of the main four
use cases, thus for the different values of the distribution wavelength proportionality
factorand the distribution parameter of the
time-causal limit kernelstudied in this article,
we find that the graphs decrease monotonically as function of,
and that the graphs are also approximately symmetric around the origin,
with the extreme values, thus, assumed at either of the ends of the
interval.

Tablesummarizes the extreme values
obtained in this way for each one of the main use cases for the
time-causal and time-recursive analogue of the Gabor transform.
As can be seen from this table, the resulting frequency estimates
become very close to the ideal value for the four considered main use
cases, in the ideal noise free continuous case considered here.

Specifically, for a discrete implementation of the time-causal and
time-recursive analogue of the Gabor transform, we could then expect this
source of error in the resulting frequency estimates to be far below the
errors caused by quantizing the frequencies in a discrete
approximation of the continuous time-frequency transform.

SECTION: 
Beyond estimating the variability in the frequency estimates, it is
also of interest to estimate how wide the spectral bands will be for
the different types of time-frequency analysis methods.
Starting from the approximation of the spectrogramfor an ideal sine wave
in terms of the dominant componentaccording to () and
(), let us therefore estimate
the width of a spectral band from the two values ofandfor which

whererepresents the lower bound andrepresents the upper bound, with.

Again, letting the temporal scalebe proportional to
the angular frequencyaccording to
(),
and reparameterizing the angular frequencyas

we are therefore, after using the explicit expression foraccording to Equation (), to solve the
equation

in terms of the variable,
to give the two rootsandwith.

Tableshows numerical values concerning the
estimates of the widths of the spectral bands obtained in this way,
for the four main use cases considered in the this paper, regarding the different values of the
wavelength proportionality factorand the distribution parameterof the time-causal limit kernel, based on approximations using
the firstfactors in Mathematica.

In this table, we have also
defined the following compact measure of the width of the spectral band

as well as computed the relative lower and upper bands of the spectral
bands according to

which are notably independent of the angular frequencyof the input
sine wave, due to the temporal scale covariance property for the
time-causal and time-recursive analogue of the Gabor transform.

Tableshows numerical values of
corresponding descriptors obtained for the regular non-causal Gabor
transform, obtained by solving the equation,

As can be seen from comparing the time-causal results in
Tableto the non-causal results
in Table, the spectral bands are
somewhat wider for the time-causal and time-recursive analogue of the
Gabor transform than for the regular non-causal Gabor transform,
with the values of the compact bandwidth descriptorhaving the following ratios

between the time-causalthe non-causal time-frequency
analysis concepts for the four different main uses.

Thus, the measureof the width of a spectral band, in
terms of logarithmic frequencies, is about
12 % or 22 % larger for the time-causal and time-recursive analogue
of the Gabor transform compared to the regular non-causal Gabor
transform, depending on whether the value of the distribution
parameterfor the time-causal limit kernel is chosen as eitheror.

SECTION: 
Beyond the above characterizations of the proposed time-causal
time-frequency analysis method in the ideal noise free case, it is
also of interest to investigate how sensitive the resulting frequency
estimates will be due to noise. First of all, we can note that the
frequency sensitivity curve for a spectral band, as approximated
byaccording to () for the time-causal
and time-recursive analogue of the Gabor transform, is, for values of the
angular frequency rather near the peak angular frequency
at, rather symmetric around,
as can seen in Figureand from the
approximate symmetry of the relative delimitersandof a spectral band in Table.

Thus, if a signal contains superimposed added noise with rather uniform
spectral properties over the different angular frequencies,
then we could expect the contributions from the noise to the variations
over the angular frequencyacross a spectral band to
comparably well balance each other, such that the angular frequency
estimateobtained by applying a peak detector over the
variations over the angular frequency in the spectrogram ought to not
deliver excessively biased frequency estimates
in either direction of the angular frequency.

In this section, we will perform a characterization of this property
experimentally, and also in the discrete case, which then,
beyond the idealized continuous theoretical analysis
in Section, thereby also
characterizes the influence on the accuracy of local frequency
estimates due to the discretization steps, needed to
transfer the continuous formulation of the time-causal and
time-recursive analogue to a discrete implementation,
according to Section.

SECTION: 
To analyze the frequency selectivity properties for a discrete
implementation of the proposed time-causal and time-recursive analogue
of the Gabor transform, we proceeded as follows:

A set of 5 logarithmically spaced frequency intervals,,,,and,
was selected. Within each such frequency interval, 10 random
frequencies were chosen, drawnfrom a uniform random distribution
over a logarithmic frequency domain.

For each such frequency, a sine wave of amplitude 1 and duration
3.0 secondswas
generated, with sampling frequency 44.1 kHz, corresponding
to CD quality. Furthermore, different amounts of white Gaussian
noise was added to each signal, with the following 6 standard deviations
for the noise.

For each such noisy signal, 6 different types of auditory spectrograms were
computed, with 4 of these auditory spectrograms being time-causal,
based on the time-causal and time-recursive analogue of the Gabor
transform for wavelength proportionality factorand distribution parameterfor the
time-causal limit kernel, and 2 of these auditory spectrograms being
non-causal, based on the regular regular non-causal Gabor transform
with wavelength proportionality factor.

The discrete implementation of the time-causal and time-recursive
analogue of the Gabor transform was according to the treatment in
Section, with the temporal smoothing operation
performed in terms of 8 layers of first-order recursive filters
coupled in cascade. The discrete implementation of the Gabor
transform was based on temporal smoothing with the sampledGaussian kernel truncated at the tails for a truncation errorbelow.

The auditory spectrograms were computed over the frequency intervalwith 48 uniformly sampled frequencies per
octave over a logarithmic frequency scale, and with the standard deviationsfor the temporal window functions in the time-frequency
transforms proportional to the frequency in an interior part of the
frequency interval. In the transitions between the interior part of
the frequency and the exterior parts, we did, however, here use
hard thresholding of the temporal scale values of the temporal
window functions (as opposed to the soft thresholding approach according to
Appendix, that we otherwise use
for computing auditory spectrograms), to guarantee true
proportionality with respect to the interior frequencies in the frequency
range. The reason for using this thresholding operation on the temporal scale
values is to prevent too long temporal
scale values for lower frequencies or too short temporal scales for
higher frequencies.

For the wavelength proportionality factor, the bounds on the
linear range of the temporal scale values were, while for
the wavelength proportionality factor, the bounds on the
linear range of the temporal scale vales were.

For both of the casesand, the temporal scales of
the temporal window functions were therefore proportional to the
frequency in the spectrogram for frequencies in the rangle, that is for a frequency interval
that with a reasonable margin clearly contains the range of the randomly generated
frequencies for the signals for which the spectrograms are computed.

Then, to obtain local frequency estimates and to quantify the accuracy
of these estimates, we proceeded as follows:

To avoid possible boundary effects, the first 10 % and the last
10 % of the temporal points were discarded. Thus, the following
temporal operations were only performed within the central 80 %
of the temporal sample points.

For each time moment, the discrete frequencyfor the global maximum in the absolute value of the spectrogram over the
logarithmic frequencies was determined:

Each such discrete frequency estimatewas then
interpolated to a subresolution frequency estimateof
higher resolution by parabolic interpolation, that is by fitting a
second-order polynomial to the variation over the discrete
logarithmic frequencies over the nearest neighbours just below and
just below the determined discrete frequency estimate, and then
determining the peak position of that local second-order polynomial:

Measures of the temporal mean and the temporal standard deviations of
these frequency estimates were computed, by first computing the
logarithmof the ratio between the frequency estimateand the
reference valueof the true frequency, and then exponentiating
the statistical mean and standard deviation
measures computed over the logarithmic frequency
domain, thus leading to a multiplicative bias measureand a multiplicative spread measureof the forms

Tableshows the results
of performing these operations for the 4 types of time-causal
spectrograms and the 2 types of non-causal spectrograms, with the
results for all the 5 frequency intervals with 10 samples in each interval
pooled into the reported values for the multiplicative bias valuesand the multiplicative spread values, and with the
results for each use case and each noise level compactly shown on the form

As can be seen from these results, the multiplicative bias valuesare very close
to the ideal value, with the deviations being of the order ofor lower for all the noise levels.
The multiplicative spread valuesare somewhat further away from their ideal
values, with increasing deviations from the ideal valuefor
increasing noise levels, but still for noise levels
up tothe deviations are below. Only when the noise level is as high
as, the deviations of the multiplicative spread values from
the ideal value of 1 reach values of the order of.

Notably also, comparing to the effects of the quantization error,
which with the chosen parameter settings of using 48 logarithmically
distributed frequency levels per octave should correspond to a
relative quantization error of the order of,
that is to a quantization error of the order of, we can note
that the shapes of the frequency selectivity curves for the
time-causal and time-recursive analogue of the Gabor transform are
very compatible with the chosen method for parabolic interpolation, to
obtain frequency estimates of much higher resolution than the raw
discretization of the frequency values in the discrete implementation.

In these respects, the frequency estimates obtained from the time-causal
and time-recursive analogue must be regarded as very accurate, and
specifically also consistent with the results from the previous theoretical analysis
of the frequency selectivity properties for the fully continuous spectrograms, as
derived in Sectionand as
summarized in Table.

A possible explanation of why these error measures are very low,
also in the presence of substantial amounts of noise,
is that the temporal filtering operations in the proposed discrete
implementation of the new time-causal time-frequency transform
are based on provably variation-diminishing filtering operations
(see Appendices–),
which should then strongly reduce the influence of local perturbations and noise.

Finally, it should be remarked that we have in this experiment
deliberately chosen a very much simplified peak detection algorithm,
that for at each temporal moment
detects just the main peak (the global maximum) over the logarithmic frequencies in
the spectrogram. More realistically, in an actual algorithm for
performing local frequency estimation in real-world signals, it is
more appropriate to detect multiple peaks (several local maxima) over the
logarithmic frequencies, to be able to simultaneously handle
responses to multiple local frequencies in the input signal.

Additionally, to prevent spurious responses to noise or other interfering
structures in the data, it can also, for auditory signals recorded from sound
sources with more complex spectral characteristics than a pure sine
wave, be more appropriate to precede the above peak
detection step with a local bandpass filtering stage,by
filtering the absolute value of the spectrogram with a negative second-order derivative
of a Gaussian kernel in the logarithmic frequency direction, as done
in Lindeberg and FribergSection
“Auditory features from second layer receptive fields”, see
specifically the subparagraph on “Spectral sharpening” on page 31 in
that paper.

If additional temporal delays can furthermore be acceptable, it is also
possible to combine such a spectral sharpening operation with
complementary filtering in the temporal
direction, to additionally reduce the spread of the local frequency
estimates.

In this treatment, we have on the other hand deliberately chosen an as
much simplified peak detection method over the logarithmic frequencies
as possible, in order to as far as possible reveal the properties of
the pure time-frequency transforms, without having the results being
further influenced by the properties of more refined methods for
spectral sharpening.

SECTION: 
To summarize, similarly to the regular Gabor transform,
the proposed time-causal and time-recursive analogue of the Gabor
transform is covariant under the
following transformations of the input signal:

Temporal shift:

Temporal rescaling:

Frequency shift:

Amplitude rescaling:

In this respect, the proposed time-causal and time-recursive analogue of
the Gabor transform can be expected to have a robust behaviour for
signals that may undergo these basic types of transformations over the
signal domain.

In the area of computer vision, the formulation of
provable covariance properties for mathematically based image
operations has been established as an effective way of
substantially increasing the robustness of
visual operations to the influence of the variabilities generated by
natural image transformations,
see Lindebergand the
references therein. In a similar way, we propose that the formulation
of provable covariance properties for other classes of signal domains,
such as the temporal and auditory signals considered in this paper,
can be essential for increasing the robustness of signal processing
operations, that are to operate on real-world data generated from
physical or biological processes with substantial variabilities.

SECTION: 
We have presented a framework for performing time-frequency analysis
over multiple temporal scales in a way that is fully time-causal and
time-recursive. In this way, the presented theory makes it possible to
perform time-frequency analysis for both modelling and processing
real-world physical or biological signals, as well as expressing
corresponding signal processing operations in real time.

The time-causal analogues to the Gabor function and the Gabor
transform, that we have presented, obey true temporal scale covariance
under uniform rescalings of the temporal domain, for rescaling factors
that are integer powers of the distribution parameterfor the
time-causal limit kernel, that represents the temporal smoothing kernel
in the time-causal analogue of the Gabor transform. The time-causal
analogue of the Gabor transform, that we have proposed in this work,
does also obey a cascade smoothing property over temporal scales, which
ensures that a time-frequency transform at a coarse temporal scale can
be treated as a simplification of the corresponding time-frequency
transform at any finer temporal scale. In these ways, the proposed
representations generalize unique properties of the Gabor functions
from a non-causal temporal domain to a truly time-causal temporal
domain.

In essence, the Gaussian kernel, which is used as the temporal window function in
the regular non-causal Gabor transform, can, based on the arguments developed in more
detail in Appendix,
be regarded as the canonical temporal
smoothing kernel over a non-causal temporal domain.
The time-causal limit kernel, used as temporal window function in the
proposed new time-causal frequency analysis, can based on as close as
possible arguments over a time-causal temporal domain, be regarded as the
canonical temporal smoothing kernel over a time-causal temporal
domain. For these conceptual reasons, we refer to the new time-causal
frequency analysis concept as a time-causal analogue of the Gabor transform.

Concerning the discrete implementation, we have also presented
an axiomatically based theoretical framework, outlined in
Appendix, for defining a
discrete analogue of the proposed time-causal analogue of the Gabor
transform, based on a set of first-order recursive filters coupled in
cascade. Due to the positive time constants in these recursive
filters, the corresponding temporal filtering operations are guaranteed to obey
provably variation-diminishing properties, which is important for the numerical
stability, by provably reducing the influence of local perturbations
and noise.
This method for discrete implementation does also constitute a true
numerical approximation of the corresponding continuous theory.

An explicit algorithm for computing a discrete analogue of the
proposed time-causal analogue of the Gabor transform has been outlined
in Appendix, with further details regarding a
strictly time-recursive implementation in
Appendix.

In contrast to the regular non-causal Gabor transform, the proposed
time-causal time-frequency analysis concept is inherently associated
with temporal delays, for which we have presented closed-form
estimates in Section, showing that the temporal
delay is proportional to the temporal scale parameter measured in
dimension, and that the temporal delay becomes shorter for
increasing values of the distribution parameterof the time-causal
limit kernel.
We have also in Sectionsandanalyzed the frequency
selectivity properties of the proposed time-causal analogue of the
Gabor transform, with comparisons to the regular non-causal Gabor
transform, with specific emphasis on how different choices of the temporal
scale parameterand the distribution parameterof the time-causal
limit kernel affect the frequency selectivity properties, specifically
showing that the frequency selectivity becomes less narrow for
increasing values of the distribution parameterof the time-causal
limit kernel.

In these respects, requirements of short temporal delays
and narrow frequency selectivity properties constitute conflicting
requirements, that should be balanced for any specific application.
In this context, however, computing the time-frequency analysis over
multiple temporal scales, as the proposed time-causal analogue of the
Gabor transform is highly suitable for, should, however, also be
considered as an alternative, since then multiple trade-offs between
temporal delays and frequency selectivity properties can be obtained
simultaneously, over variations of the temporal scale in the temporal
window kernel of the time-causal time-frequency transform, and with a
very small amount of additional computations.

To quantify how accurate the resulting local frequency estimates can
be expected to be for the time-causal and time-recursive analogue of
the Gabor transform, as well as how the properties of the proposed time-causal and
time-recursive analogue of the Gabor transform differ from the
properties of the regular non-causal Gabor transform, we have in
Sectionformulated theoretical
estimates based on closed-form expressions for the resulting
time-causal spectrograms defined from a single ideal sine wave. These estimates
indicate that the variations in local frequency estimates ought to,
in the continuous case, be
very low for the studied four main use cases, regarding the default
values of the wavelength proportionality factorand the distribution
parameterfor the time-causal limit kernel. The spectral bands
obtained with the time-causal and time-recursive analogue of the Gabor
transform will, however, be somewhat wider
(of the order of 12 % or 22 % wider in terms of logarithmic frequencies when measuring
the width of the spectral band at half the peak value)
compared to the spectral bands obtained with the regular
non-causal Gabor transform, depending on whether choosing
the distribution parameter asor.

In Section, we have then performed an
experimental characterization of the accuracy of the resulting local
frequency estimates, for the proposed and computationally very
efficient discrete implementations of the proposed
time-causal and time-recursive analogue of the Gabor transform, in
terms of a low number (4 to 8) of first-order recursive filters coupled in cascade.
For a set of synthetic sine waves with added white Gaussian noise,
we have shown that even for
noise levels up to 100 %, the multiplicative bias values and the
multiplicative spread measures
(see Table)
are very close to their ideal values to be equal to 1,
thus showing that the proposed time-causal and time-recursive
analogue of the Gabor transform should have the possibility to compute
very accurate local frequency estimates, if embedded within otherwise
well-designed algorithms for local frequency estimation.

We have also derived a family of inverse transforms of the proposed
time-causal analogue of the Gabor transform in
Appendix.
In contrast to the forward transform, those inverse transforms are,
however, not time-causal, and inevitably associated with additional
temporal delays. Thus, those inverse transforms may not be
directly applicable for time-critical real-time applications, why
this contribution should in that context mainly be regarded as of theoretical
interest, to clearly show that the proposed time-causal analogue of the Gabor
transform constitutes a true time-frequency transform, or intended for
applications that are not time-critical, such as offline analysis.

We propose that the theoretical constructions described in this
article could serve as a valuable tool for expressing the first layers
of time-frequency analysis when modelling physical or biological
processes in situations where non-causal access to the future is
simply not realistic, as well as for expressing real-time
time-frequency analysis methods for real-time processing, in
particular in situations where a multi-scale analysis is warranted to
capture different types of temporal structures at different temporal
scales, by using multiple temporal window functions of different
temporal duration.

Additionally, because of the computationally very efficient
discrete implementation, using the proposed time-causal and
time-recursive analogue of the Gabor transform could also be
considered as a computationally very efficient tool, when to perform
offline time-frequency analysis on larger datasets, especially if
the time-frequency analysis is to be performed over multiple temporal
scales.

SECTION: Acknowledgements
Python code, that implements a subset of the time-frequency analysis
methods described in this paper, is available
in the pygabor package, available at GitHub:

as well as through PyPi:

I would like to thank the anonymous reviewers for valuable comments
that have improved the presentation.

SECTION: 
In this appendix, we will present conceptual theoretical arguments
for time-frequency analysis that (uniquely) lead to using the Gaussian kernel as
a canonical temporal window function in a non-causal time-frequency transform,
and thus to the Gabor transform over a non-causal
temporal domain. Then, we will present as corresponding as possible
arguments for a time-frequency analysis over a time-causal temporal
domain, that then lead to instead using the time-causal limit kernel as the
canonical temporal window function, in the proposed time-causal
frequency analysis concept.

Let us assume that we, for a non-causal temporal domain, are going to
define a time-frequency analysis over multiple temporal scales by
pointwise multiplication of any temporal signalby a complex
sine waveand then integrating the result using some
temporal window function, that depends on some temporal
scale parameter:

A fundamental problem then concerns what temporal window functions
should be regarded as natural or desirable? Specifically, a crucial
problem concerns how to relate temporal window functions at different
scales, to ensure that a time-frequency representation at a coarse
scale can be regarded as some sort of simplification or abstraction of
the time-frequency representation at any finer scale.

If we choose address this problem by requiring that the convolutions of
the real and imaginary components of the productwith the temporal smoothing function should be regarded as
simplifications, in the sense that the number of local extrema or
the number of zero-crossings in the
temporally smoothed product must not increase from finer to coarser
temporal scales, then this problem can be addressed by the tools of
temporal scale-space theory, described in
LindebergSection 2.1.

According to this temporal scale-space theory, a temporal smoothing
kernel is referred to as a temporal scale-space kernel if for any input signal
it has the property that the number of local extrema (or equivalently the number of
zero-crossings) in the convolved signal cannot exceed the number of
local extrema in the input signal. Based on results by
Schoenberg, it can furthermore be stated that a
continuous smoothing kernel is a scale-space kernel if and only if it has
a bilateral Laplace-Stieltjes transform
of the form

forand some,
where,,andare real andis convergent.

In this expression, the factorcorresponds
to possibly time-delayed Gaussian kernels

while the factorscorrespond to truncated exponential
functions

or

for some strictly positive.
The product form in ()
does furthermore imply that all possible convolutions of such
primitive smoothing kernels constitute possible candidates to choose
from, when to define a transformation from any finer scale to any coarser
scale, in a multi-scale time-frequency analysis concept that is
guaranteed to ensure formal simplifications from any finer scale to
any coarser scale.

A complementary question then concerns if it would be appropriate to
impose further restrictions to reduce the search space for possible
time-frequency analysis methods? A very desirable complementary
requirement to impose is to require the possibility of defining
a continuum of possible temporal scale parameters. A formal way of
adding such a requirement is by imposing a semi-group condition

on the family of temporal smoothing kernels. If we, in addition,
as is possible over a non-causal temporal domain,
require this semi-group property to be continuous with
respect to the temporal scale parameter, then the Gaussian kernel
() is singled out as the unique
choice among the otherwise possible primitive temporal primitives
(),
() and
().

If we, in addition, require the temporal smoothing kernels to be
symmetric, so that they do not introduce any temporal delays, then we are
thus lead to the conclusion that the resulting multi-scale
time-frequency analysis must correspond to the Gabor transform.

If we, on the other hand, consider temporal signals over a time-causal
temporal domain, then we cannot use the Gaussian kernel or those
truncated exponential kernels that would imply forbidden access to the future.
The only possible temporal smoothing kernel to choose from will then
be the time-causal truncated exponential kernels of the form
().

In principle, all possible combinations of such kernels would guarantee a
simplification from finer to coarser levels of scale. Again, one may,
however, ask if it would be desirable to impose further conditions to
reduce the search space? Notably, we cannot impose a semi-group
structure with respect to a continuous scale parameter in the
time-causal case, since the convolutions with sets of truncated
exponential kernels in cascade by necessity implies that the temporal
scale levels have to be discrete. Additionally, theoretical arguments
in LindebergAppendix 1 show that a requirement of
semi-group structure over a time-causal temporal domain would lead to
unnecessarily long temporal delays.

For these reasons, we should instead seek other forms of complementary
requirements. A weaker extension of the semi-group property of the
Gaussian kernels is to instead focus on the cascade smoothing
property

that applies to the non-causal temporal scale-space
representationobtained by
smoothing any temporal signalwith a Gaussian kernel

Thus, for a time-causal temporal scale-space representation, obtained
by smoothing with a time-causal temporal scale-space representation
with a time-causal temporal smoothing kernel

we require that the time-causal temporal scale-space representation
should satisfy a cascade smoothing property of the form

for some incremental convolution kernel,
that transforms the temporal scale-space representation from the
temporal scale levelto the temporal scale level.

Specifically, to guarantee that the amount of information in the
signal, measured in terms of the number of local extrema, or
equivalently the number of zero-crossings, must not increase from the
temporal scale levelto the temporal scale level,
then that incremental convolution kernelshould be a temporal scale space
kernel. Specifically, from the classification of such temporal
scale-space kernels above, the incremental kernel must correspond to a
set of truncated exponential kernels coupled in cascade.

If we additionally restrict ourselves to the fact that the temporal
scale levels have to be discrete for a time-causal scale-space
representation, because of the discrete nature of the temporal scale
levels, as arising from the restriction to truncated exponential
kernels coupled in cascade, then the simplest choice will therefore be that
the transformation between adjacent temporal scale levels should be
given by convolution with a single truncated exponential kernel.

In this way, we have arrived at an overall architecture, where the
temporal scale-space representation should be constructed as a cascade
of successive convolutions with truncated exponential kernels with
possibly different time constants. What then remains, is to determine
how to choose these time constants.

For the ability of the temporal smoothing
kernels to appropriately reflect a quantitative notion of temporal
scale, it is specifically desirable that the temporal smoothing
kernels should also transform
properly under temporal scaling transformations. In other words,
under a scaling transformation of the temporal domain of the form

for some temporal scaling factor, the temporal smoothing kernel
should transform according

A deeper theoretical analysis in
LindebergSection 3 of the property of temporal scale
covariance in relation to temporal smoothing kernels, that are
constructed from truncated exponential kernels coupled in cascade,
shows that the particular definition of the time-causal limit kernel,
from having a Fourier transform of the form

ensures that the temporal smoothing kernels will then lead to temporal
scale covariance. This will hold in the sense that for temporal scaling factorsof the
form

with temporal scaling transformations of the form

the temporal smoothing kernels will transform according to

provided that the temporal scale parameters are matched according to

Over a non-causal temporal domain, the continuous Gaussian kernel also
obeys such a similar scaling transformation property

as the time-causal limit kernel obeys.

The Gaussian kernel and the time-causal limit kernel do also
constitute the preferred choices among kernels that guarantee
non-creation of new local extrema (or equivalently zero-crossings)
from any finer to any coarser level of scale, over the respective
domains of either non-causal or time-causal kernels. In these
respects, these kernels constitute the canonical kernels with
strong information-reducing temporal smoothing properties,
over either non-causal or time-causal temporal domains.

In this way, the time-causal limit kernel carries as many as
possible of these information-reducing theoretical properties of the Gaussian kernel from a
non-causal temporal domain to a time-causal temporal domain.

Since these underlying properties do also carry over to time-frequency analysis
in the ways described in Sectionand
Section, we do therefore refer to
the proposed new time-causal time-frequency analysis concept as a
time-causal analogue of the Gabor transform.

Concerning treating the time-causal limit kernel as a time-causal
analogue of the Gaussian kernel, it has previously been shown that the
time-causal limit kernel can replace the role of the non-causal
temporal Gaussian kernel in time-causal models of spatio-temporal receptive fields
for video analysis (see Lindebergand
Jansson and Lindeberg) as well as in time-causal models
of spatio-temporal receptive fields in biological vision
(see Lindeberg).

Note that, due to the fundamental differences between a time-causal and
non-causal domain, we cannot, however, expect to be able to carry over all the
theoretical properties of the Gabor transform to a time-causal
frequency analysis.

First of all, by not having access to information from the future, an
analysis based on the time-causal limit kernel will not have access to
the same amount of information as an analysis based on the Gaussian
kernel, and can therefore not be expected to be able to compete with the Gaussian
kernel on a fair basis,
if evaluated in an offline scenario,
if comparisons would be made between an analysis based on the Gaussian
kernel, with an associated oracle that has non-causal access to
the future, and an analysis based on the time-causal limit kernel,
with restricted access to only what can be derived from information that has
occurred in the past.

Fundamentally, because of the temporal causality, the temporal
time-frequency analysis is associated with inescapable temporal
delays, caused by filtering information from the past only, and using
filters of non-infinitesimal size, as further described in
Section.

As described above, it is neither possible nor desirable to aim at
carrying over a semi-group property over temporal scales to a
time-causal temporal domain, because such a semi-group property would lead to
excessive temporal delays. Due to the semi-group property over a
continuous temporal scale parameter, the
Gaussian distribution is infinitely divisible, which among other
things implies special properties in terms of noise suppression for any
regular temporal signal and specifically more narrow frequency
selectivity in the context of a time-frequency analysis, as further
detailed in Section.

By decreasing the distribution parametertowards 1, the
time-causal limit kernel could, however, be made successively more
divisible, and then also making the frequency selectivity properties more
narrow. Such a decrease in the distribution parameterwould,
however, also lead to longer temporal delays, as well as a need for a
larger amount of computations, and may therefore not be
desirable in time-critical situations.

What we have focused on in the development of this time-causal
time-frequency analysis concept is therefore instead the provably
variation-diminishing properties of the temporal window functions,
which also lead to excellent numerical properties for the resulting
discrete implementation of the forward transform.

SECTION: 
This appendix describes theoretical arguments, by which we can arrive
at the conclusion that a both natural, theoretically well-founded and
computationally very efficient way of implementing a discrete analogue
of the time-causal analogue of the Gabor transform is by filtering the
product between a discrete input signaland a sampled complex
sine wavewith a set of first-order recursive filters coupled in cascade.

Following the treatment in LindebergSection 4.1, a discrete kernel is referred to as a discrete temporal
scale-space kernel if it: (i) obeys temporal causality in the sense
that it does not require access from the future, and
(ii) guarantees that for any temporal signal the number of local extrema
(or equivalently the number of zero-crossings) in the convolved signal
does not exceed the number of local extrema in the original signal.

Let us initially, first consider the not necessarily time-causal case.
According to the classification of discrete (not necessarily
time-causal) scale-space
kernels in LindebergSection 4.1, based on
theoretical results by Schoenberg, a (not necessarily
time-causal) discrete kernel
guarantees non-creation of new local extrema (or equivalently
zero-crossings) if and only if it has a generating function of the form

where,,and.

To interpret this result, we can from the components in this
expression note that

the factorsandcorrespond to binomial smoothing of the form

the factorsandcorrespond to
first-order recursive filters of the form

the factorcorresponds to infinitely divisible
distributions (see the monograph on this topic by Sato), where the
case specificallycorresponds to convolution with the
non-causal discrete analogue of the Gaussian
kernel (see Lindeberg) and the casecorresponds to convolution with
time-causal temporal Poisson kernel
(see Lindeberg and Fagerström), which obeys a
continuous semi-group property over temporal scales for discrete
temporal signals, however, at the cost of longer temporal delays.

The product form of this expression does, furthermore, mean that
(not necessarily time-causal) discrete scale-space kernels correspond
to convolutions of the above primitive kernels.

If we are to implement a discrete analogue of time-frequency analysis
based on variation-diminishing temporal kernels, then the above primitive
temporal kernels do therefore constitute a very natural set of primitive
temporal smoothing kernels to choose from. Due to the requirement of temporal
causality, we do, however, have to exclude those candidates that would
imply forbidden access to the future.

For our task of also approximating the properties of the time-causal
analogue of the Gabor transform numerically, the first-order recursive
filters of the form

do in this context stand out as the natural candidate to select,
since such first-order filters do precisely constitute appropriate
numerical approximations of the first-order integrators
(), that represent the functional effect of
performing convolutions with truncated exponential kernels
of the form () (see the treatment below for an explicit proof).

For convenience, we specifically choose to express the discrete
first-order integrators of the form

which is also maximally well-conditioned with respect to possible numerical
errors or perturbations in the input signals.

To show that the discrete recursive filter
() can be regarded as a numerical
approximation of the continuous first-order integrator, let us first
introduce the following specialized notation for the time constantin the
continuous case
()

Let us then, given a temporal sampling distance,
approximate the temporal derivativeusing Euler’s method

which gives

and which, in turn, can be rewritten as

Removingfrom each side and rearranging the
terms, then gives

which can be rewritten as

and which clearly corresponds to the form

provided that the continuous time constantis related
to the discrete time constantin such a way that

that is, if and only if

In this way way have shown that proposed discrete method for
implementing the discrete temporal smoothing stage in the
proposed discrete analogue of the time-causal analogue of the Gabor
transform can be regarded as a true numerical approximation of the
continuous temporal smoothing stage in the proposed continuous
time-causal analogue of the continuous Gabor transform.

Combined with the above theoretical result, showing that this form of
temporal smoothing is also guaranteed to have variation-diminishing
properties in the sense of guaranteeing that the number of local
extrema, or equivalently the number of zero-crossing in the filtered
signal cannot increase with the temporal scale, we propose to refer to
the resulting composed discrete implementation method as the discrete
analogue of the time-causal analogue of the Gabor transform.

SECTION: 
This appendix gives an explicit overview of how to implement the
computation of the discrete analogue of the time-causal analogue of the
Gabor transform for a digital signal. For simplicity, we first
describe the case for offline data, where the computations are not
performed in a real-time situation.

Let us assume that the signal has been sampled with a time increment, and that we for some proportionality factorare going to compute the discrete
time-frequency transforms for the angular frequenciesat the respective temporal scale levels, proportional to the
wavelengths corresponding the angular frequencies

Then, we first define the temporal sampling rateas

and the temporal scales adjusted to the temporal sampling rate as, leading to the following values, when
expressed in units of the temporal variances of the temporal window functions

Given a pre-selected value of the distribution parameterof
the time-causal limit kernel, we should then perform the corresponding
operations:

Given the set of angular frequenciesand the set of temporal
sampling indices,
multiply the input signalby sine and cosine functions

For each angular frequency,
compute a set of temporal scale levelsaccording to a geometric
distribution ():

withaccording to ().

For each angular frequency,
compute a corresponding set of scale increments:

with the additional definition.

For each angular frequency,
compute the time constantsfor a set of temporal recursive
filters of the form ()
according to ():

For each angular frequencyand for
both the cosine and the sine parts of input signal multiplied by
cosine and sine waves according to () and
(), couple the
following sets of first-order recursive filters in
cascade () over increasing values
of the temporal scale levels(and for a unit parameterization of
time with time increments of the form)

using the discrete signalsand,
respectively, as the input data to the chain, and perform the explicit discrete
filtering operations
(see Appendixfor a more detailed
description of how this can be done in a real-time situation).

This results in the following real and imaginary components of the discrete analogue
of the time-causal analogue of the Gabor transform:

over the temporal sampling indices, the angular frequenciesand the temporal scale levels

Compute the spectrogram components as

When applying this method for computing an audio spectrogram, intended
to analyze audio data, as are to be perceived by a human, it can,
additionally, be valuable to perform soft thresholding on the temporal
scale levels at the lowest and the highest frequencies, to prevent the
temporal delays from becoming too long for the lowest frequencies and
preventing the temporal integration time to become too short for the
highest frequencies.

Therefore, instead of definingaccording to
(), when computing audio spectrograms,
we defineas

wheredenotes a lower bound on the temporal
window scale, and where one may chose¶.

Correspondingly, to prevent the temporal delay from being too long for
low frequencies, a soft upper bound on the temporal scale is defined
as

for suitable values ofand. As default values for
these parameters, we useandwith.

By these adaptations, self-similarity over temporal scales will, as a
consequence, only hold in an intermediate range of the temporal
frequencies, consistent with previous
evidence that the resolution of
pitch perception is the highest in an intermediate range of frequencies and then
decreases for both lower and higher frequencies
(see Hartmannand Moore).

Of course, other types of modifications to delimit the range of
temporal scales for low and high frequencies could also be considered.

SECTION: 
This appendix describes how to implement the multi-scale temporal
filtering operations underlying the computation of the discrete analogue of
the time-causal analogue of the Gabor transform, in a fully time-causal
and time-recursive way suitable for real-time computations.

For this purpose, we focus on itemin the above outline in
Appendix, concerning the overall implementation of
the discrete time-causal time-frequency transform.

For each angular frequency, a cascade of recursive filter
is to be initiated, with the time-constants for the recursive filters
determined according to ().
Then, the actual procedure for coupling these recursive filters in
cascade can be expressed on the form outlined in the
pseudocode in Algorithm.

The computational work required to implement this algorithm for a
single angular frequency, besides the initial computation
of the sine and cosine functions, basically
corresponds to two additions and one multiplication for each of the
two cosine and sine channels, multiplied by thenumber of layers, which by necessity have to be computed sequentially.

Then, when handlingmultiple angular frequencies, which for a
purely serial implementation requires computational work
proportional to the numberof
angular frequencies, the computational work depends upon to what
extent the inherently parallel computations over the functionally independent
angular frequencies can be distributed over multiple cores.

Compared to an implementation of the regular Gabor transform, the
computational work for the discrete analogue of the Gabor transform
can for moderate valuesof the number of layers (usually 4 to 8 layers)
specifically be expected to be substantially lower than for an
implementation of the regular Gabor transform, based on explicit
temporal convolutions over temporal intervals of longer duration.

SECTION: 
In view of the classification of the discrete scale-space kernels in
Appendixabove, there is one family of
discrete smoothing kernels that stands out as a discrete analogue of
the Gaussian kernel over a non-causal domain
(see Lindeberg) of the form

wheredenote the modified Bessel functions of integer order
(Abramowitz and Stegun). These kernels obey a semi-group
property over scales

and can specifically be shown to constitute a better discrete
approximation of the properties of the continuous Gaussian kernel than
the sampled Gaussian kernel (see Lindeberg).

Based on using this discrete analogue of the Gaussian kernel as the
temporal window function in a discrete time-frequency transform

for integer, we can thus treat the definition
() as a discrete analogue of the regular
non-causal Gabor transform.

The spectrograms in Figurehave been
computed using this method for discrete implementation of the Gabor
transform, complemented with temporal shifts and truncations of the
filter for the input values that would have implied forbidden access
to the future in relation to any pre-recorded time moment.

SECTION: 
Following the treatment in TeolisSection 4.5.2, regarding the
inverse transform of a windowed Fourier transform, we can derive an
inverse transform of the time-causal analogue of the Gabor transform as
follows:

The time-causal analogue of the Gabor transform is defined according
to Equation ():

wheredenotes the time-causal limit kernel defined from having a
Fourier transform of the form (),
or equivalently defined from an infinite set of truncated exponential kernels
coupled in cascade, with the time constantsdefined from
the temporal scale parameterand the distribution parameteraccording to
() and (). The time-causal
limit kernelis specifically equal to
0 for, because of the temporal causality.

If we define the following combined translation and reversal operator

then we see that the time-causal analogue of the Gabor transformis the Fourier transform of the
function,,

According to the inverse of the Fourier transform, we then have

Multiplying both sides of this equation byand integrating over, then gives

from which we, noting thatfor, get

which, in turn, by the change of variables, can be simplified to

This is an explicit expression for an inverse of the time-causal
analogue of the Gabor transform.

Note, that this inverse transform is, however, not time-causal, since
for any given time moment, only values of the time-causal analogue of
the Gabor transform from the future will have an influence on the signal
at the present moment.

Note, furthermore, that there are also other possible
ways to define inverse transforms of the time-causal analogue of the
Gabor transform based on the relationship
(), by estimating
the original signalfrom a combination of the inverse Fourier
transform of the time-causal analogue of the Gabor transformwith
the time-causal limit kernelat either a single time momentor a set of time moments over a more
compact time interval than the entire temporal axis for.

Note, specifically, that if we, with the aim of reducing the temporal
delays when computing the inverse transform, choose to instead use the
relationship () for gathering
information from the inverse Fourier transform of the time-causal
analogue of the Gabor transformover a shorter temporal interval, such that the
resulting inverse transform corresponding to ()
will then be reduced to the form

we cannot, however, reduce the durationof the temporal
support interval too much, and specifically not let the durationtend to zero, since the time-causal limit kerneltends to zero when the time variabletends to zero.

Thus, the need for accumulating information, about the values of
time-causal analogue of the Gabor transform over extended periods of time, will lead to
inevitable additional temporal delays when computing the inverse
transform. This points to a trade-off problem in that a larger
durationcould be expected to enable more accurate
estimates of the inverse transform, while then also increasing the
temporal delay, which may, thus, strongly influence the potential applicability of using
the inverse transform in time-critical applications.

SECTION: References