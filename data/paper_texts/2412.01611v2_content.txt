SECTION: Characterizing Jupiter’s interior using machine learning reveals four key structures
SECTION: Introduction
Unveiling Jupiter’s internal structure is key for studying and constraining its formation and evolution with implications for other giant planets. NASA’s Juno missionprovided precise measurements of Jupiter’s gravity field, which are essential for constraining its interior. Additional constraints come from atmospheric measurements taken by the Galileo entry probe and Juno, and the cloud-level temperature derived from Voyager radio occultations.

Early Juno measurements suggested the need for a dilute core in Jupiter to match the hemispherically symmetric gravity field, but this came at the expense of incompatibility with atmospheric composition measurements. To address this, an inward decrease in the heavy element mass fraction, Z (or metallicity), was proposed, which was shown to be unlikely from an evolution modeling perspective. Other approaches to fit the atmospheric metallicity involved either lowering internal densities by increasing the temperature at 1 bar, or arbitrarily modifying the equation of state (EOS) for hydrogen and helium. More recent studies considered the existence of a radiative layer that could separate Jupiter’s upper atmosphere from the deep Z-poor interior, allowing for atmospheric enrichment in metallicity.

Juno also revealed hemispherical asymmetries in Jupiter’s gravity field, which are attributed to deep winds that significantly affect both the symmetric and asymmetric components of the gravitational signature, adding constraints to the range of possible internal structures. These internal flows were shown to reach a depth ofkm within Jupiter. Most interior models account for the dynamical contribution to the gravity field () by allowing it to have some typical ranges, which do not necessarily reflect the plausible solutions for each specific model and its solid-body properties.takes an alternative approach, optimizing the cloud-level wind and wind decay profile for each interior model and its background density, allowing for very largeby arbitrarily varying wind decay depth with latitude.

Modeling the interior of a gas planet constrained by its gravity field is a multidimensional, nonlinear, non-unique problem that is traditionally analyzed statistically through per parameter distributions and pair-wise correlations (e.g.,), or by selecting the best-fitting (preferred) models (e.g.,). Identifying typical, characteristic interior structures (i.e., combinations of interior parameters) can provide further information on the wide multidimensional solution phase space and highlight effective parameters that can simplify the representation of plausible structures, making the search for them more effective, reducing the high computational costs involved.

In this study, we propose a fully consistent coupled interior and wind model where each interior model, computed using the accurate concentric Maclaurin spheroid (CMS) method, is uniquely matched to Jupiter’s observed gravity field by using its own solid-body solution and a physically viable wind model. This method enables the generation of a large sample of plausible dilute core models for Jupiter, defining the permissible range for the dynamical contribution to the gravity field. Then, performing clustering analysis across the high-dimensional space of interior models simplifies them into a 2D phase space. This framework can also be adapted to explore the interiors of other giant planets.

In Sect., we describe our modeling setup and the process used to generate a sample of plausible interior structures. Sectionfocuses on analyzing the range of plausible interior models and their associated observables. Sectionpresents a clustering analysis to identify key interior structures of Jupiter and shows how these structures simplify the internal model’s dimensionality. We conclude in Sect..

SECTION: Methods
In this section, we build on the methodology developed by, but also incorporated a wind model to obtain a sample of feasible solutions. Figureillustrates the interior structure model and the schematic workflow used in this study. Details of the computational steps are outlined below and in Sect..

SECTION: Jupiter interior structure model
We calculated interior models using the CMS method, based on a publicly available GitHub code. The CMS method assembles a rotating fluid planet fromconstant density spheroids, constructed by their equatorial radii to compute the planetary mass, shape, moment of inertia, and gravitational moments by solving each spheroid’s gravitational and rotational hydrostatic equilibrium. Moreover, radial profiles of various physical properties are computed (e.g., density, pressure, entropy, and composition). The results of CMS are sensitive to the spacing grid of spheroids, so we used the same equatorial grid as inwithspheroids, in similarity to the exponential grid shown to best reproduce Jupiter analytical polytropic solution. The equatorial radius measured at 1 bar pressure,is unaltered in our models, so as Jupiter’s rotation period ofh.

The gravitational moments, representing the planet’s shape and mass distribution, are precisely measured by Juno:

whereis the harmonic degree,is Jupiter’s equatorial radius,is the planetary mass,is the radial coordinate,is the latitude,is theth Legendre polynomial, andis the density which can be expressed as, whereis the density from solid-body rotation (calculated by the CMS method), andis the dynamical density due to the wind. The normalized moments of inertia (NMoI, whereis the moment of inertia about the rotation axis) is computed according to Eq. (5) from.

Following the setup ofand, we modeled Jupiter’s internal structure with four layers: an outer envelope, an inner envelope, a dilute core, and a possible compact core (see Fig.). The outer envelope is assumed to be isentropic, with its adiabat determined by the temperature at 1 bar,. This temperature, acting as a proxy for the deep interior entropy, was measured by the Galileo entry probe asand reanalyzed from Voyager radio occultations to reach. We set the hydrogen and helium abundances to be consistent with the Galileo probe atmospheric measurements, whereandare the mass fractions of hydrogen and helium in the outer envelope, respectively. The envelope’s metallicity,, was measured in the atmosphere to exceed the solar abundance. Recent interior models continue to struggle with meeting this observational constraint.

The lower-than-protosolar helium abundance measured in Jupiter’s atmosphere by the Galileo probe, assuming the planet’s overall helium abundance is protosolar, suggests a deep enrichment of helium within the planet. A region where hydrogen and helium are immiscible could separate the He-poor outer envelope from the He-rich inner envelope, with inward helium enrichment potentially caused by ”helium rain”. While the phase transition pressure defining this region,, remains uncertain, numerical simulations suggest it ranges between 0.8 and 3 Mbar. We set both envelopes to have the same metallicity,. The helium mass fraction in the inner envelope and dilute core is adjusted to ensure the total planetary mean helium abundance aligns with the protosolar value of.

The dilute core is modeled as a region with a gradual inward increase in heavy elements, following:

whereis the maximum mass fraction of heavy materials in the dilute core,denotes the extent of the dilute core in normalized mass, andcontrols the steepness of thegradient. We set. Formation-evolution models of Jupiter suggest that the dilute core should be relatively small, extending up to 20% of Jupiter’s mass. Most current models do not feature a sufficiently small dilute core, with only models frommatching this theoretical constraint. We explored interior models with dilute cores extending betweenof Jupiter’s mass, with maximum metallicity ranging from 0.06 to 0.45. Finally, a compact core composed entirely of heavy elements is considered, defined by its normalized equatorial radius,, with its mass,, determined through the CMS calculation. Recent studies resulted in compact cores sized(e.g.,). We explored interior models with a compact core ranging betweenJupiter’s radius, equivalent to masses of.

The variety of EOSs for hydrogen and helium being used and uncertainties related to their interpolation, provide further uncertainty in Jupiter’s plausible structures. This has been extensively studied by examining how using various EOSs affects the resulting interior models. In this study, we adopted the state-of-the-art pure H and He from, and accounted for their non-ideal interaction using the tables from. For a given pressure and temperature, we calculate densities using the additive volume law (AVL) including the mixing effects:

whereandare the pure species densities and abundances of hydrogen, helium, and heavy elements, respectively. The volume change resulting from interactions between H and He is accounted for by. The entropy is similarly computed using the AVL:

whereare the pure species entropies. The entropy change due to mixing of H and He is represented by. We used the Sesame water EOSto account for the heavy elements. To compute the densities(in) as a function of pressure(in Mbar) in the compact core we used the ”rock” analytical formula from:

SECTION: Exploration of plausible interior models with NeuralCMS
We reduced Jupiter’s interior structure to seven controlling variable parameters discussed in Sect.:,,,,,, and. To explore the phase space of these parameters and find parameter combinations consistent with Juno gravity data, we used NeuralCMS, a deep learning approach regressing the CMS model. NeuralCMS is a deep neural network model, predicting the even gravitational momentstoand the mass given a combination of the seven interior parameters mentioned above. It is trained on a large sample of wide-ranged CMS-computed interior models of Jupiter allowing the performance of an extensive grid search for plausible interior models with a reduced computational runtime by a factor of. NeuralCMS was applied to eliminate models inconsistent with Juno and reduce the parameter range. Due to the small measurement uncertainty ofand, actual CMS calculations were performed to exclude models falsely predicted to be plausible.

The grid search procedure follows the approach described in, where all parameter combinations are explored using a uniformly spaced grid for each parameter withgrid points, resulting ininterior models per grid search iteration, without prior assumptions on the model parameters. Models consistent with Juno’s observations are selected based on the interior criteria in Table, added with a prediction error from NeuralCMS,, to the allowable deviation from Juno’s measurements. The interior criteria allow interior models to deviate significantly from the Junouncertainty onand, which isto investigate the permissible range of interior models allowed by a self-consistent wind model.

In this study, we build upon the two grid search iterations conducted by. The initial iteration considers the maximum prediction errors on the dataset used to train NeuralCMS, to roughly reduce the range of the interior parameters. The second grid search uses a denser grid, theprediction errors on the training dataset,, and the reduced parameter range, followed by CMS calculations to retrieve a sample of plausible interior models. To obtain a larger sample, a third grid search iteration was performed with the further narrowed parameter range from the second iteration,, and an even denser grid. The third and final iteration with NeuralCMS yielded approximatelyplausible interior models within, which were recalculated with CMS to retrieve a sample ofparameter combinations that satisfy the interior criteria (Table). The three grid search stages are summarized in Table. We confirmed that NeuralCMS does not add uncertainty to the distribution of interior parameters by verifying that no plausible models were excluded by it. This was done by recalculating (with the CMS method) the third grid search iteration with a larger prediction error margin, close the maximum errors on the validation dataset for,, and.

SECTION: Coupled thermal wind model with modified surface wind
The observed cloud-level wind and gravity data impose constraints on the flow dynamics and, consequently, the dynamical contribution to Jupiter’s gravity field. In fast-rotating giant planets like Jupiter, large-scale flows are predominantly governed by geostrophic balance. Given the largely zonally symmetric nature of Jupiter’s flow, the leading order dynamical balance is between the flow gradient in the direction parallel to the axis of rotation and the latitudinal density perturbations, given by a thermal wind (TW) balance:

whereis the wind,andare the static (solid-body) density and gravity fields, computed with CMS,is the direction parallel to the axis of rotation, andis the anomalous density field. For a detailed derivation of this form of the TW balance, see. The wind-induced gravitational moments are then calculated based on the anomalous density field

where. This balance was used to determine the depth of Jupiter’s winds using Juno’s gravity data, and similarly for Saturn using Cassini’s gravity data.

In this study, we followed the methodology of, where the cloud-level wind profile and its decay are adjusted to best fit the Juno-measured even and odd gravity harmonics,to. We accounted for uncertainties in the observed cloud-level wind, by selecting plausible models that are withinof the observed wind (see Fig.a). Firstly, we decompose the observed wind into the firstLegendre polynomials, where the coefficientsset the latitudinal wind profile. During optimization, these coefficients are allowed to vary, resulting in a modified cloud-level wind,. Next, the modified windis projected parallel to the axis of rotation and then decayed radially using a continuous, monotonic decay function that is a linear combination of exponential and normalized hyperbolic tangent functions (see Fig.b). The wind depth remains constant across all latitudes. Projecting parallel to the rotation axis and applying radial decay have been demonstrated to provide the most probable flow structure for explaining the gravity measurements. We note thatalso uses this procedure, in addition to another degree of freedom that allows for latitude-dependent wind decay.

The CMS calculation provides radial profiles of each interior model’s equipotential surfaces, density, temperature, and composition. These profiles serve as the background (static) state for each interior model, which is then used in Eq., to couple the interior model with a wind model. This approach allows for the consistent selection of interior models that match with the observed cloud-level wind within its uncertainties and the Juno-measured gravitational moments within Juno’suncertainty. We applied the wind model to themodels accepted by the interior criteria discussed in Sect.(shown as blue histograms in Fig.) and identified 491 plausible interior structures that satisfy both the interior and the wind criteria (see Table). These wind-constrained models are shown in red histograms in Fig..

SECTION: Results I: Plausible range of interior structures
Figurepresents the distributions of interior model parameters and observables for the plausible interior structures that satisfy the interior criteria (blue histograms) and the subset that additionally meets the wind criteria (red histograms). In this section, we examine the differences between these two sets of models and analyze the resulting ranges of parameters and observables. Figureshows the pair-wise relations (corner plot) of all 491 plausible interior models.

SECTION: Distribution of the observables
We find that the lower gravity harmonicsand(Fig.a,b) are strongly constrained by applying the wind model, indicating that the explored range was sufficiently broad. The wind constraint is different from that used by(black lines in Fig.), where they examined the plausible dynamical contribution to the even gravity harmonics through random sampling of, using a constant background state for the TW optimization described in Sect.. They selected plausible solutions based on similar wind criteria to those used in this study (Table). We note that the results frompresented here represent only the wind-allowed range for the static, not the distribution of plausible interior models. The comparison here is therefore intended for these allowable ranges, as also shown in Table. Comparing our results to theirs, we observe a different range forand a comparable distribution for(see Fig.a,b and Table). The higher-order even gravity harmonics exhibit a narrower range due to the applied interior criteria, meaning that their values are largely determined by the interior structure. For, the observable which is more challenging to fit, we find a different range thanwith the largest allowed deviation from Juno to be(for an interior model withand). Forandwe observe much tighter distributions compared to. Tablealso compares our findings with two previous studies that determine the permissible range of dynamical contribution to the gravity harmonics matching the gravity field observations, and also magnetic field constraints. Our results are more consistent with these studies than with. For, our deviations from the Juno measurements are larger than in the previous studies, consistent with the finding that the best-fit wind solutions favor smaller values for.

During our exploration, we allowed the planetary mass to vary within the uncertainty stemming from various values reported for the gravitational constant. This is similar methodologically to allowing variations in the equatorial radius while keeping the mass constant, as done byand. Figureg shows that the mass was not constrained by the wind model. Similarly to the gravity harmonics higher-order than, the NMoI is primarily determined by the interior structure, and the wind model further constrains it. We find values of(uncertainty) for the sample of 491 plausible models. This result is consistent with, who derived values ofwith abstract models that match Juno’s, and the range for the preferred model from, with(shown in green line in Fig.), which is on the edge of our allowed range.presented empirical structure models of Jupiter matching the measured,, and equatorial radius, but with a lower derived NMoI of.

The preferred model from, which matches Jupiter’s gravity field by allowing the wind depth to vary with latitude, is represented by the green lines in Fig.. Their study indicated that if the wind depth is kept constant across latitudes, the optimized cloud-level wind deviates byfrom the observed values, much more then the observed uncertainties, and well outside our wind criteria. Our modeling setup is different than their preferred model by the exact helium rain and the dilute core regions implementation, the EOS used for H-He mixture, where they use the tables from, but most importantly the wind approach. We show in Fig.a-f that their model is either on the edge of our allowed range for the gravitational moments and NMoI, or falls outside it. We find that while their model meets the interior criteria for the even gravity harmonics, it is excluded as a plausible structure after applying the coupled wind model. Fittingis challenging with most available EOSs, as demonstrated by, who showed that achieving a good fit requires EOSs associated with highvalues, above 180 K, much higher than the Galileo probe measurement of 166.1 K imposed by.

SECTION: Distribution of the interior physical parameters
Next, we present the range of parameters defining Jupiter’s interior, along with the resulting mass and distribution of heavy elements within the planet. First, it is important to note that NeuralCMS significantly narrows the ranges of parameters such as,,,, and. Figureh-o shows that the distribution of the interior parameters remains largely unchanged when wind constraints are applied. We note that the peak values in the histograms do not necessarily correspond to a plausible combination of parameters. Our models indicate a preference for high, and small compact core mass () ranging from 0 to 5.3, which is consistent with findings from previous studies. Additionally,andexhibit strong positive correlation, resulting in a higher number of models with increased envelope metallicity, reaching up to(2.3 times the solar value), associated with.

The characteristics of the dilute core in our models are consistent with those calculated using the same EOS from, though with a different setup. The plausible range ofis found to be betweenand betweenfor. We report values for the masses of heavy elements in the different regions in the interior (also shown in Fig.) defined the same as in. The mass of heavy elements in both envelopes, corresponding to the envelope metallicity and not the enrichment in the dilute coreranges from 1.6 to 10.9and is primarily determined by the value of. The excess mass of heavy elements in the dilute core regionranges from 7.6 to 19.6. The total mass of heavy elements in the planetvaries between 17.9 and 25.8. This means that our models have most of their heavy elements in the dilute core region instead of in the envelope, in agreement with.

SECTION: Results II: Characteristic interior structures
The range of plausible interior structures for Jupiter, shaped by the complex interplay of properties like composition, compositional gradients, and thermal structure, makes it challenging to identify typical structures. However, determining such representative structures can simplify our characterization of Jupiter’s interior, provide valuable multidimensional insights, and enable meaningful comparisons with other giant planets.

SECTION: Clustering analysis based on the interior parameters
The variability among plausible interior structures can be explored and simplified through clustering analysis, which helps identify characteristic interior structures of Jupiter by classifying common combinations of parameters. In this study, we used the-means method which was successfully used to characterize the behavior of Jupiter’s magnetosphere. We used the sample of 491 plausible interior models with their seven defining parameters (Fig.) for this analysis. To avoid biases, we standardized the parameters by subtracting the mean and dividing by the standard deviation.

The-means algorithm starts by randomly selectingcluster centroids and assigning each of the 491 data points to the nearest centroid based on Euclidean distance. The centroids are then updated as the mean of their assigned points. This process repeats until centroids no longer change. To ensure robust results, the algorithm runs multiple times with different initializations, selecting the setup with the lowest sum of squared distances. The analysis was performed using the Matlab ”kmeans” function. The optimal number of clusters was determined by an ”elbow analysis”, which shows how variance decreases with an increasing number of clusters (Fig.). In our case, variance drops sharply up to four clusters, with only marginal improvement beyond that. Adding more than four clusters yields little additional simplicity despite a minor variance reduction at nine clusters.

To demonstrate that the sample size of 491 is sufficient for statistical analysis, we performed the same analysis on sub-samples of varying sizes, as shown in Fig.. Our results indicate that for sub-samples with fewer thandata points, the variability in the elbow analysis is too high to statistically validate the quality of the clustering. Additionally, for these smaller sub-samples, there is a significant reduction in variance when using more than four clusters, which is not observed in larger sub-samples. In contrast, for the larger sub-samples, the behavior of the elbow plot closely resembles that of the full sample, supporting the robustness of our clustering analysis.

Figureshows the variability of the interior parameters across the four clusters. The parameters controlling the envelope (and) are distinguished between clusters, where two clusters are characterized by high values of these parameters and the other two clusters have low values. Conversely, The transition pressure setting the helium rain region, and the mean planetary helium mass fraction set byare not classified within the four clusters. Similar to the envelope parameters, the parameters controlling the planet’s core (,, and) are also separated between clusters, but with two different clusters characterized by high (low) values forand(), and vice versa for the other two clusters. These relationships between the core-controlling parameters are consistent with previous studies. Additionally, we find that the smallest plausible dilute cores are associated with a relatively hot and heavy envelope. Overall, the clusters represent four unique combinations of two envelope configurations and two core configurations. Again, we note that the parameter combination represented by the mean values of each cluster is not necessarily a plausible combination.

SECTION: Reducing the dimensionality to two effective parameters
As discussed above, the resulting clusters are distinguished by their envelope and core states, indicating that interior structures can be effectively represented in a 2D phase space with two key parameters representing these states. Figurepresents all 491 plausible interior structures, color-coded by their assigned cluster, according to two effective parameters: the product of temperature at 1 bar and envelope metallicity (which distinguishes between hot and heavy versus cold and light envelopes), and the ratio of dilute core extent to maximum dilute core metallicity (which differentiates between extended and light versus small and heavy dilute cores). The latter parameter also correlates with the compact core radius and mass (see Fig.), where an extended dilute core is associated with a larger (heavier) compact core. The descriptors used (i.e., cold versus hot, small versus extended, light versus heavy) are relative to the derived plausible range (Fig.), with ”light” and ”heavy” referring to metallicity (molecular weight). Figurealso presents the fraction of interior models within each cluster, showing a higher density of models with a hot and heavy envelope and a small and heavy dilute core. A schematic of the four characteristic Jupiter interior structures, including the full parameter range of each cluster, is provided in Fig.. Importantly, we show that Jupiter’s interior structure can be effectively explained using a 2D phase space, clearly representing the four distinguishable characteristic structures. Moreover, the overlap at the edges of clusters suggests they represent characteristic structures rather than distinct end members.

Additional observational and theoretical constraints can be applied to the sample of plausible interior structures to refine the selection. Models consistent with atmospheric measurements and theoretically bound for the helium rain region, meeting the observational criteria listed in Table, are marked with black circles in Fig.. These criteria include a temperature at 1 bar lower than 178 K (close to the upper bound from reanalysis of the Voyager radio occultations derived by), higher than solar atmospheric (envelope) metallicity, and a helium rain transition pressure lower than 3 Mbar. Most highlighted structures fall within a cluster characterized by a cold and light envelope and a small, heavy dilute core, suggesting that Jupiter’s interior structure might be confined to this specific characteristic structure or at least a narrow region in the phase space (Fig.). This structure is also highlighted with a thick frame in Fig.. Under these constraints, the minimalrequired to accommodate at least a solar abundance of heavy elements in the envelope exceeds 175 K, which is higher than the upper limit of 174.1 K derived from Voyager radio occultations, suggesting that the deep interior entropy might not be represented by the measured.

SECTION: Conclusion
In this study, we explored a wide range of Jupiter’s structural models with self-consistent interior and wind models constrained by Juno’s gravity field measurements, observed cloud-level wind, and atmospheric observations from both Juno and the Galileo entry probe. These models feature four layers: an outer envelope defined by the temperature at 1 bar and atmospheric metallicity, an inner envelope with the same metallicity but enriched in helium due to helium rain, a dilute core characterized by compositional gradients, and a possible compact core.

We present a robust framework for characterizing Jupiter’s interior using machine learning techniques, which can also be applied to study the interiors of other giant fluid (exo)planets. Our approach uses NeuralCMS, a deep neural network model, to efficiently reduce the range of plausible interior structures and explore the full parameter space. Subsequently, we compute interior models using the accurate CMS method, integrated with a wind model that has been demonstrated to best explain the observed asymmetric gravity field. We used a state-of-the-art EOS for hydrogen and helium; however, using alternative available EOS could yield different plausible ranges and distributions of interior models, potentially impacting the clustering analysis. This methodology ensures a consistent selection of plausible models.

The wind constraints result in a different range of plausible dynamical contributions to the gravity field () compared to the values found by, who used random sampling ofcombinations to account for the wind in their interior models, as well as by. These differences may arise from variability between the background density profiles used to derive wind-induced gravity harmonics and differences in the EOS. We show that the even gravity harmonicstoare predominantly determined by the interior structure, thus suggesting that our derived range more accurately reflects the wind effects relevant to interior modeling.

The application of wind constraints has further implications: while the distribution of parameters controlling the interior does not change significantly by applying the wind model, the range of plausible interior parameters is more narrowly defined. This is particularly important for addressing physical features that recent interior models have struggled to reconcile with observations and theory, such as the temperature at 1 bar, atmospheric metallicity, and the extent of the dilute core.

Clustering analysis reveals combinations of seven interior parameters with similar characteristics, offering deeper insights than traditional pair-wise relations or preferred models. We identify four characteristic interior structures of Jupiter that differ in their envelope and planetary core configurations. Specifically, the envelope is categorized as either hot and heavy or cold and light, and the core configuration varies between a small, heavy dilute core with a small compact core or the opposite (relative to the derived plausible interior range). These four different configurations are expected from a mass balance perspective.

The classification process enabled us to simplify Jupiter’s interior characteristics into two effective parameters: one representing the envelope state and the other representing the core state. This reduced the dimensionality of the analysis from a 7D space to a 2D phase space, clearly highlighting the four characteristic structures. Within the reduced 2D phase space, we highlight the models most consistent with the combination of atmospheric measurements (and) and show that they mostly fall within a specific characteristic cluster, thus providing a further important reduction towards one key internal model. These models are characterized by a small and heavy dilute core with mean values ofand. Our refined results on the extent of the dilute core are consistent with previous studies byand, but diverge from the formation-evolution models of, which suggest a less extended dilute core. However, even these constrained models face challenges in matching with both supersolar atmospheric metallicity and the observationally consistent 1 bar temperature, indicating that these measurements might not fully represent Jupiter’s entire envelope within this modeling setup.

SECTION: References
SECTION: Grid search iterations with NeuralCMS
SECTION: Corner plot of plausible interior models
Figureshows the pair-wise relations of the sample of 491 plausible interior models.