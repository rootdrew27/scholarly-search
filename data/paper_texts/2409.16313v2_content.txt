SECTION: SEA-ViT: Sea Surface Currents Forecasting Using Vision Transformer and GRU-Based Spatio-Temporal Covariance Modeling
Forecastingsurface currents is essential for applications such as maritime navigation, environmental monitoring, and climate analysis, particularly in regions like the Gulf of Thailand and the Andaman Sea. This paper introduces, an advanced deep learning model that integrates Vision Transformer (ViT) with bidirectional Gated Recurrent Units (GRUs) to capture spatio-temporal covariance for predictingsurface currents (U, V) using high-frequency radar (HF) data. The nameis derived fromSurface Currents Forecasting usingsionransformer, highlighting the model’s emphasis on ocean dynamics and its use of the ViT architecture to enhance forecasting capabilities.is designed to unravel complex dependencies by leveraging a rich dataset spanning over 30 years, incorporating ENSO indices (El Niño, La Niña, and neutral phases) to address the intricate relationship between geographic coordinates and climatic variations. This development enhances the predictive capabilities forsurface currents, supporting the efforts of the Geo-Informatics and Space Technology Development Agency (GISTDA) in Thailand’s maritime regions. The code and pretrained models are available at.

SECTION: Introduction
Understandingsurface currents is critical for various maritime applications, such as navigation, fisheries management, and climate modeling. These currents play a pivotal role in shaping marine ecosystems and influencing human activities in both coastal and open ocean environments. Traditional methods for extracting surface current vectors from High-Frequency (HF) radar data often rely on deterministic models, which struggle to capture the complex, non-linear spatio-temporal dependencies inherent in ocean current dynamics.

In response to these challenges, we introduce(short forea Surface Currents Forecasting Usingsionransformer and GRU-Based Spatio-Temporal Covariance Modeling), an advanced deep learning framework that integrates the Vision Transformer (ViT)with bidirectional Gated Recurrent Units (GRUs) to model the spatio-temporal covariance of sea surface currents. The namereflects both the model’s focus onsurface currents and its use of thesionransformer architecture to enhance forecasting accuracy.

The ViT, originally designed for image-based tasks, has demonstrated strong capabilities in capturing global dependencies and structural patterns in data. By applying this architecture to sea surface current forecasting,can effectively model long-range spatial interactions, which are crucial for accurately predicting ocean dynamics. The ViT’s self-attention mechanism allows the model to focus on the most relevant spatio-temporal features across the sea surface, providing a significant advantage over traditional convolutional models that have limited receptive fields.

This novel approach is specifically designed to predict the U and V vector components of sea surface currents with high accuracy. The significance of this model is particularly notable for Thai waters, including the Gulf of Thailand and the Andaman Sea, where precise current forecasting is essential for effective maritime operations and environmental management. By leveraging the global attention capabilities of the Vision Transformer alongside the temporal memory strengths of GRUs,overcomes the limitations of traditional models and provides a robust tool for understanding and predicting sea surface currents in these critical regions.

Additionally, the inclusion of the ENSO index, which accounts for oceanic changes driven by climate phenomena like El Niño and La Niña, enhances the model’s predictive ability by capturing both short- and long-term dependencies across space and time. This integration makeswell-suited to handle the dynamic and complex nature of sea surface currents, supporting a wide range of maritime and environmental applications.

SECTION: Data Handling and Preprocessing
The dataset for predicting sea surface currents includes historical HF radar measurements, which are represented as vectors, geographical coordinates (latitude, longitude), and timestamps (datetime). Additionally, the ENSO index is used to account for climate-induced variations. The ENSO index is categorical, with values indicating neutral (0), El Niño (1), and La Niña (2) conditions.

SECTION: Data Splitting
The dataset is partitioned into three subsets: training, validation, and testing. This split ensures that the model is evaluated on unseen data and helps in tuning the hyperparameters effectively. The proportions of the split are typically 70% training, 15% validation, and 15% testing, though these may vary based on the dataset size and specific experimental needs.

SECTION: Normalization of Sea Surface Current Vectors
Normalization is a crucial preprocessing step that adjusts the data to a common scale, improving the convergence and performance of the machine learning model. For sea surface current vectorsand, we use standard score normalization (z-score normalization), defined by:

where:
-andare the original sea surface current components in the eastward and northward directions, respectively,
-andare the mean values ofandover the training set,
-andare the standard deviations ofandover the training set,
-andare the normalized sea surface current components.

Normalization is applied to ensure that the input featuresandhave zero mean and unit variance. This scaling is particularly beneficial for models that rely on gradient-based optimization techniques. The z-score normalization transforms the data into a distribution with a mean of 0 and a standard deviation of 1, which standardizes the influence of each feature on the model. The benefit of this transformation in the context of predicting sea surface currents includes:

Improved Convergence:

By standardizing the input features, the gradients computed during backpropagation are scaled similarly, which often leads to faster and more stable convergence of the optimization algorithm.

Better Performance:

Normalization can help in achieving better performance metrics as it ensures that the model treats all features on an equal footing during training.

SECTION: Integration with Temporal and Spatial Features
The normalized sea surface current vectorsandare combined with other features such as latitude, longitude, datetime, and the ENSO index. This integration allows the model to account for the spatial and temporal context of the sea surface currents:

Temporal Features:

The datetime information is crucial for capturing temporal dependencies and variations in sea surface currents.

Normalization ofandensures that these temporal patterns are not distorted by variations in the scale of the current vectors.

Spatial Features:

Latitude and longitude provide spatial context.

Although these features are not normalized, their integration with the normalizedandvectors allows the model to capture geographical influences on current patterns.

Climate Features:

The ENSO index represents large-scale climate phenomena and is used as an external input to account for significant climate-induced variations.

It complements the normalizedandvectors by providing context for broader climate impacts.

In summary, the normalization of sea surface current vectorsandis a key preprocessing step that standardizes the data, improving the model’s efficiency and performance. By applying this technique, we ensure that the model can effectively learn and predict the complex dynamics of sea surface currents in Thailand’s waters.

SECTION: Model Architecture
The proposed architecture integrates bidirectional Gated Recurrent Units (GRUs) for capturing temporal dependencies with a transformer-based self-attention mechanism for modeling spatial interactions. This hybrid approach leverages the strengths of sequential and spatial feature processing to enhance the prediction accuracy of sea surface current vectors.

SECTION: Bidirectional GRU Layer
Bidirectional GRUs extend the capacity of traditional GRUs by processing input sequences in both forward and backward directions. This bidirectional processing allows the model to capture temporal dependencies that span both past and future contexts, which is crucial for understanding the dynamics of sea surface currents.

The bidirectional GRU update and reset gates are defined as follows:

where:
-denotes the sigmoid activation function,
-andare weight matrices for the update gate,
-andare weight matrices for the reset gate,
-andare bias terms.

The hidden stateis updated by combining the previous hidden state and the current input through:

where:
-denotes element-wise multiplication,
-andare weight matrices for the hidden state update,
-is the bias term.

Bidirectional GRUs are essential for this model as they enable the learning of temporal patterns in the sea surface currents, such as seasonal and cyclical variations, from both past and future data points.

SECTION: Self-Attention Layer
The self-attention mechanism in the transformer model allows the network to focus on different parts of the input sequence, capturing dependencies across both time and space. The attention mechanism is defined mathematically by:

where:
-(query),(key), and(value) are matrices derived from the input features,
-is the dimension of the key vectors.

The scaled dot-product attention computes the relevance of each query with all keys, adjusting the influence of each value based on these relevances. Specifically, the attention weights are computed as:

whereandare the query and key vectors for the-th and-th positions, respectively.

This attention mechanism enables the model to dynamically focus on relevant spatial features, such as latitude and longitude, and their interactions with temporal components, including datetime and ENSO index. It allows the model to capture complex spatial dependencies and temporal correlations in sea surface currents.

In this work, we extend the GRU-Transformer architecture to predict the sea surface current vectorsand. The bidirectional GRU layer processes the temporal sequences of input features, capturing the evolution of sea surface currents over time. The transformer self-attention layer models the spatial correlations and interactions between features, enhancing the prediction accuracy forandcomponents.

By combining these components, our model leverages both temporal and spatial information, providing a robust framework for predicting sea surface currents in Thailand waters.

SECTION: Training Procedure
The training procedure involves multiple steps, starting from data preprocessing to model deployment via MLOps integration. Below is a detailed breakdown:

SECTION: Data Overview and Input Format
The input dataset for sea surface currents prediction includes several key features such as temporal (‘datetime‘), spatial (‘lat‘, ‘lon‘), and vector components of the sea surface currents (‘u‘, ‘v‘), along with the ENSO (El Niño Southern Oscillation) index. These features play a crucial role in the model’s ability to predict sea surface currents accurately, as they capture both the physical properties and the climate-related patterns that influence the ocean’s dynamics. The ENSO index, in particular, is widely acknowledged as a significant climate variable impacting oceanic currents, making it a critical feature in models that account for long-term climatic variations (e.g., El Niño and La Niña events).

A sample of the input data format is provided in Table. Each row in the dataset represents a specific timestamp and geographical location, characterized by the latitude and longitude coordinates. The variablesanddenote the eastward and northward components of the sea surface current velocity, respectively, measured in meters per second (m/s). The ‘ensoindex‘ column reflects the ENSO phase during the observation, with values indicating neutral, El Niño, or La Niña conditions.

SECTION: Detailed Analysis of Input Data
The dataset captures the dynamic behavior of sea surface currents over time and space. The temporal granularity, provided by the ‘datetime‘ feature, ensures that changes in current velocities due to diurnal or seasonal variations can be modeled. Moreover, the geographical coordinates (‘lat‘, ‘lon‘) allow the model to learn spatial dependencies, which is crucial for capturing localized oceanic phenomena such as gyres, upwelling, and coastal boundary currents.

The **Datetime** feature represents the specific time at which the sea surface current measurement is recorded. Since ocean currents are influenced by both short-term fluctuations (such as tidal cycles) and long-term changes (such as seasonal shifts and climate anomalies), capturing time-based information is crucial for accurate predictions.

In the context of time series modeling, **Datetime** can be mathematically represented by decomposing the time into cyclical components. For example, we can capture daily, monthly, and yearly cycles using Fourier series:

Where:
-represents time,
-represents the period (e.g., daily or yearly),
-andare Fourier coefficients.

This allows the model to capture both periodic behavior and long-term trends in sea surface currents, such as tides, diurnal cycles, or seasonal variations.

The **Latitude** () and **Longitude** () features provide the spatial coordinates of the measurements, offering geographical context. These coordinates help the model learn how ocean currents vary spatially.

From a physical perspective, the variation of sea surface currents can be described by the Coriolis effect, which causes moving fluids (like ocean water) to deflect due to the Earth’s rotation. The Coriolis force is mathematically represented by:

Where:
-is the mass of the water,
-is the angular velocity of Earth (),
-is the velocity of the current,
-is the latitude.

This force varies with latitude and must be considered in the prediction of sea surface currents, especially in large-scale climate models.

The **U** and **V** components represent the velocity of sea surface currents in the eastward and northward directions, respectively. These components are crucial for predicting the direction and magnitude of ocean currents.

Mathematically, the sea surface current vector can be expressed as:

Where:
-is the velocity in the eastward direction,
-is the velocity in the northward direction,
-andare the unit vectors in the eastward and northward directions, respectively.

The magnitude of the current is given by:

And the direction (angle) of the current relative to the eastward direction can be calculated using:

Accurate modeling of these vector components is crucial for understanding the dynamics of ocean currents, which are influenced by forces such as wind, tides, and pressure gradients.

The **ENSO Index** (El Niño-Southern Oscillation) is a critical climate indicator that affects large-scale weather patterns and ocean currents. Changes in ENSO phases (e.g., El Niño, La Niña) lead to significant shifts in sea surface temperature and wind patterns, which in turn influence sea surface currents.

The ENSO index can be mathematically represented as an external forcing term in the model, which modulates the influence of other features over time. For instance, the ENSO indexcan be introduced as a weighted factor in the prediction of current velocities:

Physically, ENSO impacts ocean dynamics through changes in pressure gradients, leading to modifications in geostrophic currents (currents that result from the balance between Coriolis forces and pressure gradients). The large-scale surface temperature anomalies can also be represented using the Navier-Stokes equations to capture the fluid dynamics.

The Navier-Stokes equation for fluid flow in the ocean, influenced by external climate factors like ENSO, can be simplified as:

Where:
-is the density of the seawater,
-is the pressure,
-is the dynamic viscosity,
-is the gravitational acceleration,
-represents the ENSO-induced external forces.

Incorporating the ENSO index into the model allows it to adapt to global climate variability, improving the accuracy of long-term predictions of sea surface currents.

SECTION: Predicting Sea Surface Currents with Physical Constraints
In order to enhance the prediction accuracy of sea surface currentsandin Thailand waters, advanced mathematical modeling techniques that incorporate physical principles are utilized. This approach ensures that the models not only capture the empirical data but also adhere to fundamental physical laws governing fluid dynamics.

**1. Transformer-Based Self-Attention Mechanism**

The Transformer model’s self-attention mechanism captures the temporal dependencies crucial for predicting sea surface currents. The attention mechanism is defined as:

where,, andare the query, key, and value matrices respectively, andis the dimensionality of the key vectors. This mechanism allows the model to weigh past observations based on their relevance, capturing long-term trends such as seasonal variations in sea currents.

**2. GRU-Based Temporal Modeling**

Gated Recurrent Units (GRUs) handle short-term dependencies in the data, critical for capturing immediate fluctuations in sea surface currents. The GRU equations are:

whereis the update gate,is the reset gate,is the candidate hidden state, andis the output hidden state. The GRU model effectively manages both the short-term variability due to tidal cycles and the long-term trends influenced by seasonal changes.

**3. Spatio-Temporal Covariance Modeling**

The covariance matrixcaptures the spatial and temporal relationships between sea surface currentsand. This is expressed as:

whereis the mean vector ofand. This modeling approach allows for the understanding of how currents are correlated across different spatial regions and times, which is essential for capturing both local and regional variations.

**4. Incorporation of Physical Principles**

To ensure the predictions align with physical laws, we incorporate constraints derived from fluid dynamics:

- **Navier-Stokes Equations**: These equations describe the motion of viscous fluid substances and are crucial for modeling ocean currents. In a simplified form, for an incompressible fluid, they are expressed as:

where:
-is the density of seawater,
-is the pressure,
-is the dynamic viscosity,
-is the gravitational acceleration.

This equation models the balance of forces acting on the sea surface currents, including inertial forces, pressure gradients, viscous forces, and gravitational effects.

- **Geostrophic Balance**: For large-scale ocean currents, the geostrophic balance is often used to describe the balance between the Coriolis force and pressure gradient force:

whereis the Coriolis parameter andis the geostrophic velocity. This balance helps predict the currents based on pressure fields and the Coriolis effect, particularly important in the tropics where geostrophic currents are significant.

**5. Combined Transformer and GRU Model with Physical Constraints**

The integration of Transformer and GRU models, along with physical constraints, is formulated as:

wheredenotes concatenation of outputs from both models, andandare the output weights and biases. The inclusion of physical constraints in the loss function is represented as:

This augmented loss function ensures that predictions remain physically plausible and adhere to fundamental fluid dynamics principles.

In summary, the integration of complex mathematical techniques and physical constraints enhances the ability of the AI model to predict sea surface currentsandaccurately. This approach ensures that the model captures both empirical data and fundamental physical principles, providing robust and reliable predictions for Thailand waters.

SECTION: Data Analysis
A preliminary analysis of the dataset reveals several important insights. The variability in the ‘U‘ and ‘V‘ components suggests significant temporal and spatial changes in sea surface currents, likely driven by both local factors (e.g., tides, wind patterns) and global climate phenomena (e.g., ENSO phases). The ENSO index, in particular, shows a strong correlation with variations in the current vectors, as expected based on climatological studies. The inclusion of this index in the model provides the necessary context to capture long-term oceanic shifts influenced by El Niño and La Niña conditions.

By normalizing these features and incorporating data augmentation techniques, the training process becomes more efficient and robust, leading to better generalization and prediction accuracy across different ocean regions and time periods.

Each row contains sea surface current vector componentsandat a specific latitude and longitude, along with the ENSO (El Niño Southern Oscillation) index, which is a critical indicator of sea surface temperature anomalies.

SECTION: Data Normalization
To improve the performance and stability of predictive models for sea surface currentsand, standard deviation normalization, also known as z-score normalization, is applied specifically to these components. This approach standardizes the data, transforming each feature so that it has a mean of 0 and a standard deviation of 1.

**Standard Deviation Normalization**

For sea surface current componentsand, the normalization is computed as follows:

where:
-represents the original value of the sea surface current component,
-is the mean of the feature across the dataset,
-is the standard deviation of the feature across the dataset.

**Relevance for Predicting Sea Surface Currents**

1. **Uniform Scaling for Prediction**: The componentsandof sea surface currents can vary significantly in magnitude. Standard deviation normalization ensures that these components are on the same scale, which helps machine learning models, such as Transformers and GRUs, to process these features effectively. Proper scaling is essential for accurate model training and prediction.

2. **Improved Model Training**: Normalizingandhelps in achieving faster and more stable convergence during model training. Since many machine learning algorithms are sensitive to the scale of input features, standard deviation normalization helps in mitigating issues related to gradient descent optimization.

3. **Robustness Against Outliers**: This normalization technique is less affected by outliers compared to other methods like min-max scaling. Given the potential for anomalies in environmental data, standard deviation normalization provides a more robust approach to feature scaling.

**Sample Calculation**

Consider the sea surface current componentwith a meanand standard deviation. For a specific observation, the normalized valueis calculated as:

Similarly, if for the sea surface current component, the meanand standard deviation, and a specific observation is, then the normalized valueis:

By applying standard deviation normalization specifically toand, we ensure that these features are scaled appropriately for model training, enhancing the accuracy and effectiveness of predictions related to sea surface currents.

SECTION: Data Augmentation
To enhance the robustness of the model, data augmentation techniques are employed. These techniques involve introducing controlled perturbations to the input data, thereby simulating natural variations and expanding the training dataset. Specifically, augmentation is applied to spatial coordinates (‘lat‘, ‘lon‘) and the sea surface current components (‘u‘, ‘v‘).

Spatial coordinates (‘lat‘, ‘lon‘) are slightly perturbed to account for minor variations and inaccuracies in geographical measurements. The perturbation is modeled as:

where:

andare the augmented latitude and longitude values,

andare random perturbations drawn from a uniform distribution within a specified range, e.g.,and, whereis a small positive constant.

This approach generates variations in spatial coordinates that simulate minor geographical discrepancies.

To account for natural fluctuations and measurement noise in the sea surface currents, Gaussian noise is added to the ‘u‘ and ‘v‘ components. The noisy components are computed as:

where:

andare the augmented sea surface current components,

andare Gaussian noise terms with mean zero and variancesand, respectively.

By adding Gaussian noise, the model is trained to be more resilient to variations in sea surface current measurements, improving its generalization capability.

Consider a sample sea surface current data point with ‘lat = 12.34‘, ‘lon = 56.78‘, ‘u = 0.5‘, and ‘v = -0.3‘. Applying augmentation techniques:

Suppose the perturbations for spatial coordinates areand. The augmented coordinates are:

If Gaussian noise withandis added, and the noise terms areand, the augmented current components are:

In summary, these augmentation strategies introduce realistic variations to the data, enhancing the model’s ability to generalize across different scenarios and improving its robustness to real-world noise and measurement errors.

SECTION: Model Architecture: Bidirectional GRU with Transformer
The proposed model architecture consists of a Bidirectional Gated Recurrent Unit (BiGRU) layer followed by a Transformer mechanism. This combination is designed to capture both temporal dependencies and spatial interactions in predicting sea surface current vectorsandfrom the input features, which include ‘datetime‘, ‘latitude‘ (‘lat‘), ‘longitude‘ (‘lon‘), and the ‘ENSO index‘.

The Bidirectional GRU layer processes the input sequence in both forward and backward directions, allowing the model to capture temporal dependencies from the entire sequence context. The update and reset gates for the GRU are computed as follows:

where:

is the update gate at time step,

is the reset gate at time step,

denotes the sigmoid activation function,

,,,,, andare the weights and biases for the gates.

The hidden state update is computed as:

where:

is the hidden state at time step,

andare the weights for the hidden state update,

is the bias for the hidden state update,

is the hyperbolic tangent activation function,

denotes element-wise multiplication.

The output of the Bidirectional GRU is fed into a Transformer layer that applies self-attention to capture spatial dependencies among the features. The self-attention mechanism is given by:

where:

(query),(key), and(value) are matrices derived from the input features,

is the dimensionality of the key vectors,

is the softmax activation function applied to the scaled dot-product of queries and keys.

The self-attention mechanism dynamically adjusts the importance of different time steps and spatial locations by computing a weighted sum of the valuesbased on the similarity between queries and keys. This allows the model to focus on relevant features and interactions that impact the prediction of sea surface currents.

The ENSO index is incorporated into the model to account for large-scale climate variations that influence sea surface currents. The ENSO index provides critical context for understanding the long-term patterns associated with El Niño and La Niña events. Mathematically, the ENSO index acts as an external input modulating the predicted current vectorsandthrough the following relation:

where:

represents the predicted sea surface current vector at time,

denotes the ENSO index at time,

is a scaling factor to adjust the impact of the ENSO index on the predictions.

This framework allows the model to integrate temporal and spatial features effectively, enhancing its capability to predict the sea surface currents accurately by leveraging both historical data and climate-induced variations.

SECTION: Loss Function
The model optimizes for the mean squared error (MSE) between the predicted and actual sea surface current vectors. The MSE is given by:

where:

denotes the total number of data points in the dataset.

andare the actual sea surface current components at the-th observation.

andare the predicted sea surface current components at the-th observation.

Sea surface currents are vector quantities described by their eastward () and northward () components. Each observation in the dataset provides a pair, representing the current’s strength and direction at a specific location and time.

The MSE measures the average squared difference between the observed and predicted values. It provides a quantitative metric of the prediction error, focusing on the magnitude of discrepancies between the model’s output and the true data.

This term represents the Euclidean distance squared between the true and predicted vectors in the 2D current space. This distance is indicative of how well the model captures both the magnitude and direction of the current vectors.

Minimizing the MSE encourages the model to reduce both the magnitude of prediction errors and their directional biases. The MSE penalizes larger errors more severely due to the squaring operation, ensuring that the model focuses on correcting substantial discrepancies, leading to more accurate predictions of sea surface currents.

During training, gradient-based optimization algorithms (such as stochastic gradient descent) utilize the derivative of the MSE with respect to the model parameters to update the weights. The gradient of the MSE loss function with respect toandis given by:

These gradients indicate the direction and magnitude of the adjustments needed for the predicted values to minimize the loss function, thereby improving the accuracy of the sea surface current predictions.

By employing the MSE loss function, the model effectively balances the prediction accuracy for both components of the sea surface current vectors, ensuring that the optimization process addresses both the magnitude and directional errors comprehensively.

SECTION: MLOps and Deployment
The entire pipeline is integrated into an MLOps environment, automating training, validation, and inference. For real-time predictions, a UI interface allows users to input parameters (‘datetime‘, ‘lat‘, ‘lon‘, ‘ensoindex‘) to predict the sea surface current vectorsand. The interface is built with Swagger, allowing easy interaction and model inference. Additionally, model monitoring and updates are managed through CI/CD pipelines to ensure accuracy over time.

SECTION: UI Interface
A Swagger UI interface is implemented for the GISTDA system, allowing users to interact with the trained model through a user-friendly interface. Users can upload data or manually enter latitude, longitude, and ENSO index values, and receive real-time predictions of sea surface currents.

SECTION: ENSO Impact on Sea Surface Currents
The El Niño Southern Oscillation (ENSO) plays a pivotal role in shaping the patterns of sea surface currents across different regions. ENSO, primarily characterized by two phases—El Niño and La Niña—affects ocean temperature, wind patterns, and consequently, the movement of ocean currents.

The model we developed integrates this crucial climatic index ensoindex as an input feature, ensuring that the predictions of U (east-west current velocity) and V (north-south current velocity) are aligned with ongoing climatic conditions.

By accounting for ENSO’s direct influence on ocean dynamics, the model gains the ability to anticipate variations in the behavior of sea surface currents.

SECTION: Adjusting the Loss Function for ENSO Related Anomalies
To enhance the model’s ability to capture these ENSO-related anomalies, the loss function was adapted to weigh predictions differently based on the ENSO phase. Specifically, an additional penalty term was introduced in the mean squared error (MSE) calculation to emphasize periods of El Niño and La Niña. The modified loss function becomes:

Here:
-is a scaling factor that controls the weight given to ENSO events.
-is a dynamically computed coefficient based on the strength of the El Niño or La Niña phase (e.g., the absolute value of the ENSO index).

This adaptation ensures that the model pays closer attention to periods of climatic irregularities, where sea surface current velocities may deviate significantly from normal behavior. The introduction of this term allows the model to remain sensitive to these changes, improving the accuracy of the predictions during anomalous events like El Niño and La Niña.

SECTION: Ongoing Work and Future Directions
Our ongoing research highlights the transformative potential of combining Vision Transformer (ViT) with bidirectional GRUs to capture the complex spatio-temporal dynamics ofsurface currents. This study introduces, a significant advancement in leveraging deep learning techniques for predicting current vectors with enhanced accuracy and robustness.

In the immediate future, our efforts will focus on fully integratinginto GISTDA’s AI framework. Over the next three months, we will initiate a comprehensive training phase, systematically refining the model using a rich 30-year dataset. This process will be structured into several key phases:

: We will augment the dataset with additional environmental variables and fine-tune preprocessing techniques to maximize model performance. This includes standardizing and augmenting data, as well as incorporating ENSO indices to better capture climate-driven variations.

: The training phase will involve iterative refinement of. We will implement advanced hyperparameter tuning, model validation, and performance evaluation metrics to ensure robustness and generalization across different scenarios. Special attention will be given to optimizing the loss function, considering the impact of El Niño and La Niña events on current predictions.

: After training, we will deploywithin GISTDA’s AI infrastructure and conduct extensive real-world testing. Continuous monitoring and evaluation of the model’s performance will be essential to ensuring its effectiveness in practical applications.

These efforts are aimed at pushing the boundaries of AI-driven oceanographic research, with the ultimate goal of delivering a cutting-edge tool for predictingsurface currents. By collaborating closely with GISTDA, we aim to enhance our understanding of ocean dynamics and provide valuable insights to support maritime management and environmental monitoring efforts.

SECTION: Acknowledgments
This work is supported by the Geo-Informatics and Space Technology Development Agency (GISTDA), Thailand. We extend our gratitude to GISTDA for their support and resources, which have been instrumental in advancing this research.

SECTION: References
SECTION: Mathematical Summary
This appendix provides an advanced summary of the key mathematical formulations and concepts utilized in this paper for predicting sea surface currents, specifically focusing on the U and V components.

SECTION: Data Normalization
Normalization is a critical preprocessing step that scales data to have a mean of zero and a standard deviation of one, which stabilizes training and improves convergence. For the sea surface current componentsand, normalization is performed as follows:

where:
-andare the normalized components.
-andare the means of theandcomponents, respectively.
-andare the standard deviations of theandcomponents, respectively.

The normalization ensures thatandare on the same scale, allowing the model to process them effectively and mitigating issues related to feature scaling. This approach helps in maintaining numerical stability during training and ensures that gradients are computed consistently.

SECTION: Loss Function
The Mean Squared Error (MSE) loss function is used to evaluate the performance of the model by measuring the average squared difference between predicted and actual sea surface current vectors:

where:
-is the total number of data points.
-andare the actual current components at the-th data point.
-andare the predicted components at the-th data point.

The MSE is particularly useful in regression tasks as it penalizes larger errors more significantly, providing a clear objective for minimizing prediction errors. The squared term emphasizes large deviations from the actual values, guiding the optimization process toward reducing substantial discrepancies.

SECTION: Bidirectional GRU Layer
The Bidirectional Gated Recurrent Unit (GRU) layer is designed to capture temporal dependencies from both past and future contexts. The update and reset gates are computed using:

where:
-is the sigmoid activation function.
-andare weight matrices for the update and reset gates, respectively.
-andare recurrent weight matrices.
-andare bias terms.

The hidden state update is given by:

where:
-is the update gate that controls the extent to which the previous hidden stateis retained.
-is the reset gate that determines how much of the past information to forget.
-is the hyperbolic tangent activation function.
-andare weight matrices for the hidden state update, andis the bias term.

The bidirectional nature of the GRU allows the model to process sequences in both forward and backward directions, enhancing its ability to capture long-range dependencies in temporal data.

SECTION: Transformer Self-Attention Mechanism
The transformer’s self-attention mechanism calculates the attention weights to focus on different parts of the input sequence:

where:
-(query),(key), and(value) are matrices derived from the input features.
-is the dimensionality of the key vectors.

The attention scoremeasures the similarity between queries and keys, and the softmax function normalizes these scores to produce weights that sum to one. The weighted sum of the valuesthen represents the output of the attention mechanism.

Self-attention enables the model to focus on relevant spatial and temporal features by dynamically adjusting the attention weights, which enhances the model’s ability to capture intricate dependencies in sea surface currents.

SECTION: Vision Transformer (ViT) Mathematical Framework
The Vision Transformer (ViT) leverages self-attention mechanisms to model complex dependencies in image data, which is crucial for understanding spatio-temporal dynamics in sea surface currents. The core components of ViT include the embedding process, multi-head self-attention, and feed-forward layers.

Images are divided into fixed-size patches, which are then linearly embedded into a sequence of tokens. For an image of sizewithpatches, each patch is flattened and projected into a-dimensional space:

whereis the embedding of the-th patch, and the Linear function projects the flattened patch to-dimensional embeddings.

Self-attention calculates the attention scores and applies them to the value vectors to capture dependencies across different patches:

where:
-,, andare the query, key, and value matrices obtained from the input tokens.
-is the dimensionality of the key vectors.

The attention weights are computed by scaling the dot product of the query and key matrices and normalizing it with the softmax function. This process enables the model to focus on relevant patches, enhancing the feature representation.

To capture different aspects of the input, ViT uses multiple attention heads:

where each head is computed as:

andis the output weight matrix. The multi-head mechanism allows the model to jointly attend to information from different representation subspaces.

After self-attention, the output is passed through a feed-forward network, which consists of two linear transformations with a ReLU activation in between:

where:
-andare weight matrices,
-andare bias terms.

The feed-forward network provides additional non-linear transformation to the output of the self-attention layer, enhancing the model’s capacity to learn complex patterns.

To incorporate the order of patches in the sequence, positional encodings are added to the token embeddings:

whereis the positional encoding for the-th token. These encodings help the model understand the spatial arrangement of patches, which is critical for capturing spatial dependencies in the image data.

The combination of these components enables ViT to effectively model complex visual patterns, making it suitable for integrating with GRUs into enhance sea surface currents forecasting.

SECTION: Data Augmentation
To increase the robustness of the model, data augmentation introduces variations through perturbations:

where:
-andare small perturbations added to the latitude and longitude coordinates.
-andare Gaussian noise added to theandcomponents.

This augmentation simulates natural variations in sea surface currents and spatial coordinates, helping the model generalize better to unseen data by learning from a more diverse set of training samples.