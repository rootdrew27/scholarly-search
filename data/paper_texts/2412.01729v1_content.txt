SECTION: Classifying pedestrian crossing flows: A data-driven approach using fundamental diagrams and machine learning
SECTION: Introduction
Imagine the chaos of a crowded marketplace, where streams of people cross paths, each navigating their way through the crowd, often without conscious thought. The dynamics of such interactions resemble the labyrinthine choreography depicted inby, where characters move in parallel worlds, occasionally crossing paths, each interaction altering their trajectories in unexpected ways. Similarly, crossing flows in pedestrian dynamics involve individuals navigating their routes, balancing personal space and collision avoidance, much like threads weaving a complex tapestry. This interplay of order and randomness, cooperation and conflict, forms the core of human movement in crowded environments.

Understanding pedestrian dynamicsis critical for designing efficient urban spaces, managing large-scale events, and ensuring safety during emergencies. In densely populated environments such as transport hubs, marketplaces, or festivals, pedestrian movement becomes a complex interplay of individual and collective behaviors. Efficient movement not only prevents bottlenecksand congestion but also mitigates risks associated with overcrowding, such as stampedes. The study of pedestrian dynamics, therefore, plays a pivotal role in addressing global challenges associated with urbanization, as growing populations demand more efficient use of limited public spaces. By investigating how individuals navigate through crowded settings, researchers and planners can develop strategiesto optimize flowand improve safety while maintaining the overall functionality of shared spaces.

One of the most intriguing scenarios in pedestrian movement is the phenomenon of crossing flows, where two or more streams of individuals intersect at various angles. Unlike unidirectional flows, crossing flows present unique challenges: individuals must constantly balance personal goals with the need to avoid collisions. The resulting dynamics are marked by a delicate equilibrium between cooperation and competition, leading to emergent patterns such as lane formation, clustered stripe formation, or even chaotic motion. Modeling and analyzing such interactionsis inherently challenging due to their dependence on multiple factors, including individual preferences, environmental constraints, and interaction geometry. Among these, the crossing angleâthe angle at which the two streams intersectâplays a crucial role, influencing the intensity and frequency of interactions. Despite its importance, the specific effects of crossing angle on pedestrian dynamics remain insufficiently understood, particularly in terms of how they shape collective behavior and movement efficiency.

Prior research in pedestrian dynamics has largely focused on unidirectional flows, counterflows, and bidirectional movement, often emphasizing macroscopic metrics such as velocityand density. Models like the Greenshields linear relationor the Greenberg logarithmic lawhave been instrumental in describing velocity-density relationships under controlled conditions. However, the extension of these models to crossing flows, particularly under varying crossing angles, is still underexplored. Moreover, while macroscopic parameters provide valuable insights into overall flow patterns, they often overlook the microscopic intricacies of individual behavior, such as collision avoidance or personal space preservation. Emerging metrics like the avoidance number, which quantifies collision anticipation, and the intrusion number, representing personal space violations, offer promising avenues to bridge this gap. Yet, their potential for understanding and classifying crossing flows across diverse scenarios remains underutilized.

In this context, the present study seeks to understand the complexities of pedestrian dynamics in crossing flows by integrating both macroscopic and microscopic perspectives. By analyzing velocity, density, and dimensionless metrics likeand, we aim to provide a comprehensive understanding of how crossing angles influence pedestrian interactions. Our study also investigates the efficacy of classification modelsâlogistic regression and random forestâin distinguishing crossing scenarios based on these metrics. Through this approach, we aim to address critical gaps in the existing literature, providing a framework that not only enhances theoretical understanding but also offers practical implications for urban planning, crowd management, and public safety. The computations presented in this work are based on experimental data of crossing flows, collected at seven predefined angles (toinintervals). The dataset, publicly available at, serves as a high-resolution foundation for our analysis.

The remainder of this paper is organized as follows: Sectionpresents the velocity and density analysis in the crossing region, detailing the methodology for estimating these metrics and examining their variations across different crossing angles. Sectiondiscusses the velocity-density fundamental diagrams, exploring their distinct functional forms and their implications for understanding pedestrian flow dynamics. The introduction of dimensionless metrics, namely avoidance and intrusion numbers, and their analysis across crossing angles, is presented in Section. In Section, we describe the use of logistic regression for multi-class classification of crossing angles, while Sectionextends this analysis using random forest models, emphasizing feature importance and classification performance. Sectiondiscusses the implications of our findings for crowd management and pedestrian infrastructure design. Finally, Sectionconcludes the paper by summarizing the key findings and outlining potential directions for future research.

SECTION: Velocity and density analysis
For each of the crossing flows trial we calculated the instantaneous velocityof agents at every time frameas

whereandare the position of the pedestrian with respect to coordinate system used to record the trajectories. We restricted the data only in the crossing region for our estimation. For this we useand, which could be considered as approximate instances of beginning and end of interactions respectively between the two groups of crossing pedestrians. Numerically,andare the instances of the first and last edge-cuts in the course of Edge-cutting algorithm. The part of the trajectories which was taken for our analysis was betweensec andsec. Choosing such a time window ensures that the analysis are performed for the relevant part of the trajectory involved in crossing the other group. However, choosing such a time window was not possible for the trials with, whereanddo not exist. For such cases, we consider a time window which is 4 sec far from the beginning and the end of trajectory of each pedestrian, so that we get rid of any boundary effects.

The probability density functions of velocityfor each crossing anglein our dataset are shown in Figure(a). Examining the effect ofon the velocity distribution reveals distinct patterns across velocity ranges. For lower velocities (-m/sec), the probability densities forandare relatively low compared to other angles, while for higher velocities (m/sec), the situation reverses. For, where there is no crossing interaction, agents can maintain higher velocities as they move in the same direction without collision avoidance or trajectory deviation. Similarly, in the(counterflow) case, lane formation allows agents to identify openings in the opposing flow, minimizing the need for velocity adjustments. A similar effect occurs for, where the groups start at a greater distance, providing more time to locate gaps through which subgroups can pass. By contrast, for smaller crossing angles, agents face more frequent trajectory adjustments, reducing preferred walking speeds and leading to higher probability densities in the lower velocity range. A one-way analysis of variance (ANOVA) performed across the seven velocity distributions indicated thathas a low to medium effect on velocity values.

The density experienced by pedestrians in our data set was calculated using the modified voronoi method, as shown in Figurefor a typical trial. In this method, the voronoi cell of each agent is clipped by the convex hull encompassing the whole set of agents, and then the clipped voronoi cell is restricted to the angular sectorsin which the voronoi cell lies within the convex hull. For cases with multiple angular sectors, requiring multiple angular corrections, we perform a sum over all such angles to define the densityas

whereis the area of the clipped voronoi cell of an agent. By using this definition one can estimate the pedestrian density from an individual level throughout its entire trajectory at at any point of time. Another merit of this definition is not using a spatial or temporal parameter whose universally accepted value does not exist, for e.g., length of the square in an Eulerian approaches, or value of bandwidth in Lagrangian approaches.

In Figure(b) we have shown the probability density ofvalues for each crossing anglein our crossing flows data set. The crossing angle dependence ofvalues as observed in Figure(b) follows a similar pattern as the velocity distribution. We could see a prominently different probability density curve for thecrossing angle. The probability density is much lower for lower density ranges (m), and the reverse for higher density ranges (m). This is because for this case, the agents could sustain a higher density and still maintain their preferred walking speed without any need to slow down. However for other crossing angles, the probability density curves do not vary significantly with. A one-way ANOVA on the 6 groups (allexcept) of density distributions reveals [] that the crossing angle has very-low effect size on density values.

We then wanted to study the interaction dynamics of pedestrians in crossing flows and investigate how the crossing angleaffects the patterns of bothand densityover time. To standardize time across trials of varying durations, we rescaled the time variableintofor each trial to the rangeusing

This rescaling allowed us to compare velocity and density patterns across different configurations on a consistent time scale. So in the rescaled time frame,andcorrespond to the beginning and end of the interaction between the two groups, respectively. For trials withwhere there is no actual crossing interaction, we usedsec andsec as mentioned earlier to avoid boundary effects, whererepresents the total duration of the trial. After rescaling time, we divided the trajectories into bins of width. For each time bin, we grouped the velocity and density values of all agents from all configurations corresponding to that time interval. This binning process provided a set of representative values for each rescaled time interval, enabling us to average across trials with different time durations. The mean velocityand mean densitywere then obtained by averaging the respective binned values across all agents and configurations for each rescaled time point. These time-averaged quantities were then plotted against the rescaled timefor each. Figure(a) shows the variation ofwithand Figure(b) shows that for. The plots reveal how pedestrian dynamics evolve over time under different crossing conditions, providing insights into the collective behavior at various angles which we discuss below.

The mean velocity plot in Figure(a) shows thatplays a critical role in shaping the temporal evolution of pedestrian velocities. For, where pedestrians move in parallel without the need for collision avoidance, velocities remain high, peaking around the middle of the interaction period. In contrast, for(counterflow), the initial high velocities gradually decrease as the interaction intensifies, likely due to crowding effects at the interface of opposing groups. However, the velocity remains relatively high even at its minimum due to the formation of lanes, which provide structured openings for pedestrians to pass through with minimal deviation. At intermediate crossing angles, where interactions are more random and less organized, the mean velocities drop significantly during the peak interaction phase, suggesting that pedestrians must frequently adjust their speed and direction, leading to overall slower movement.

The mean density plot in Figure(b) complements the velocity analysis by illustrating how pedestrian density varies with crossing angle and time. For, density remains low throughout, as the lack of crossing interactions allows pedestrians to maintain consistent spacing. Conversely,produces the highest densities at the peak of interaction, reflecting the crowding that occurs as pedestrians move head-on into opposing flows. Intermediate angles show a more distributed density pattern, with moderate peaks that reflect the spread-out nature of interactions. This variability in density across angles underscores the impact of crossing geometry on the degree of congestion experienced by pedestrians. The observed correlation between higher density and lower velocity, especially in the intermediate crossing angles, suggests that frequent changes in direction and speed result in tighter spacing and higher interaction rates. Thus, while extreme angles (and) allow for more efficient flow management through natural self-organization (either by avoiding crossing or by lane formation), intermediate angles create complex flow patterns that amplify congestion, potentially hindering overall crowd movement efficiency.

SECTION: Velocity-density fundamental diagrams
From the point of view of traffic flow management and crowd safety analysis, fundamental diagrams are a very important tool that helps us to assess the quality of a space where the traffic moves. Here we focus on the velocity-density fundamental diagrams. In general we expect the velocityof a traffic to decrease when the densityincreases, with a cut-off density when the traffic is unable to flow further, giving rise to a traffic jam situation. Estimation of this critical cut-off density from live-human data could be difficult because of controlled conditions used during the experimental trials. For this reason, construction of fundamental diagrams and then by extrapolating the data could be very essential, as then one can attempt to evaluate the critical crowd density beyond which the traffic movement is arrested.

There exists several models of velocity-density fundamental diagrams, that tries to explain the observed dependence of traffic velocity on its density. For example, using a data collected in a lane of a two-way rural road, a linear dependence of velocityon densitywas proposed in. The linear dependence ofonwas given as

whereis supposed to be the free flow velocity when the density is nearly zero andis the maximum critical density beyond which a traffic jam () might occur. A non-linear dependence of velocity on density was proposed in. It was shown thathas a logarithmic dependence on, given by

Later, other variations of velocity-density fundamental diagrams were established, such as exponentialand power law. In, velocitywas shown to decay as a power law with density, as

with exponent.

With our crossing flows data set, we intended to study the dependence of crossing angleon the pedestrian crowd dynamics. So for each value ofwe construct the velocity-density fundamental diagram separately, as shown in Figure(a). Here, the density measurements refer to the individual densities faced by an agent within its neighbourhood. The general dependence ofonis the same for all, viz. the velocitydecreases when densityincreases. The nature of this dependenceclearly has andependence, but the dependence is not monotonic.

For density values within the rangem, highest velocities are observed for, followed byand. The explanation for this is similar to the discussion in section (velocity). Because of lack of a crossing scenario in thecase, i.e., the agents do not face an incoming flow, for higher values of density – highest values of velocity are observed compared to other crossing angles. When the incoming flow arrives ator, the agents get ample time and ‘visual opportunity’ to look for openings through which they should pass, thereby requiring less velocity adjustments in the crossing region. On the contrary for other crossing angles lower values of velocity are seen, as the agents face several deviations in their trajectories in the crossing region. This was also confirmed in, where the mean values of angular deviationof an agent with respect to its original direction of motion showed a similar variation.

For crossing angles,has a linear dependence on. The fundamental diagrams match very well with Equation, as shown by fittings in Figures(c)–(f). On the other hand, for crossing anglesandthe logarithmic variation ofseems to work very well, as shown by excellent data fittings in Figures(g) & (h) using Equation. However, forthe observed fundamental diagram shows a power law behaviour, as shown by data fitting in Figure(b).

The observed velocity-density relationships across varying crossing angles reveal the role of angle-dependent interactions in pedestrian flow dynamics. At acrossing angle, pedestrians move in parallel without incoming flows disrupting their paths. This configuration allows individuals to maintain higher velocities, even at increased densities, and the power-law behavior seen in the data suggests that velocity reduction occurs in a gradual manner. The lack of significant interaction and minimal trajectory deviation at this angle means that pedestrians have an unobstructed path ahead, resulting in smoother movement that aligns with the gradual velocity decay characteristic of power-law relationships. Thus, thecrossing angle reflects a low-interaction scenario, where pedestrians move as a relatively cohesive group rather than being affected by opposing flows.

In contrast, for moderate crossing angles betweenand, the velocity-density relationship is best described by a linear model. Here, pedestrians encounter partial incoming flows that create a steady but manageable level of interaction. This linear relationship suggests a proportional decrease in velocity with increasing density, likely due to the need for minor, continuous adjustments as individuals avoid others moving at slight angles to their paths. Unlike the sharp deviations seen at higher crossing angles, moderate angles produce a more predictable interaction pattern. The resulting gradual deceleration reflects the pedestrians’ ability to navigate through gaps without major directional changes, indicating that while each individual is affected by the crowd, the interactions are not strong enough to cause abrupt velocity shifts.

For crossing angles ofand, where individuals face directly opposing flows, the observed logarithmic velocity-density relationship indicates a different dynamic. At these large crossing angles, pedestrians can anticipate and adjust for incoming flows well in advance, leading to a controlled but gradual deceleration that aligns with logarithmic decay. This behavior suggests that pedestrians employ a strategy of early adaptation, where they actively adjust their speed and trajectory based on the density ahead. The logarithmic dependence reflects how individuals respond to increasing density by slowing down preemptively, rather than reacting abruptly when a gap appears, as may happen at smaller crossing angles. This finding highlights how, at larger angles, pedestrian interactions are characterized by early anticipation, allowing individuals to navigate smoothly through opposing flows and preventing sudden, last-moment speed reductions.

To analyse the interplay between density and velocity with temporal context, we plotted velocity as a function of density, using time as the third dimension, as shown by the 3D scatter plot in Figure. This approach provides a dynamic view of the fundamental diagrams, revealing the temporal evolution of density and velocity, as the system transitions through different states. In Figurewe observe clear temporal evolution in the density-velocity relationship, as indicated by the color gradient. This progression shows the gradual buildup and dissipation of pedestrian interactions over time, with high densities and low velocities occurring mid-way through each crossing (center of the time scale) as interactions peak.

For, where all agents move in the same direction without crossing, we observe the highest velocities and relatively low densities (Figure(a)) throughout the interaction, as expected due to minimal interference. This could also be seen in Figure. The distinct loop pattern for this case in Figure(a) reflects the initial buildup and subsequent drastic decrease of velocity as agents enter and exit the observation area. The sharp drop in velocity results from the natural tendency of agents moving in the same direction to bunch together, creating a compressive effect that reduces overall speed maintaining the same level of density.

At, minor interactions begin to appear. While the agents still primarily move in parallel, slight lateral interference requires occasional adjustments, causing a small drop in velocity as density rises, as seen in Figure(a). However, these effects are minimal, and agents maintain relatively high velocities throughout, but showing a drastic drop in density instead, which could be explained by the relatively low level of interaction between the two groups of pedestrians. The sharp drop in density for thecrossing angle is a result of the minimal interference at this angle, allowing agents to move more freely and avoid the density buildup that would be expected at steeper angles. The cases withandrepresent intermediate crossing scenarios, where interactions are more intense, and agents must frequently adjust their trajectories to avoid collisions. As a result, the velocity tends to drop as density increases, especially during the peak interaction period, as could be seen from Figure(b). The density buildup is more substantial here, leading to a more pronounced decrease in velocity as agents experience more complex navigational challenges.

From Figure(c) we can infer that obtuse crossing angles lead to smoother, less obstructed flows compared to the acute angles. For, where pedestrians move directly in opposite directions, the flow organizes into lanes, allowing agents to maintain relatively higher velocities despite the increase in density. This effect is visible as the velocity does not drop as dramatically as one might expect for such high densities, a direct consequence of self-organized lane formation that mitigates head-on collisions. Thecrossing angle, while slightly less aligned than, also shows a similar trend, as pedestrians have enough time to visually assess and adjust their paths through the opposing group, reducing the need for abrupt velocity changes. At, we start to see more interaction effects, with reduced velocities and increased densities mid-way through the crossing. This is because, at, pedestrians encounter more lateral interference, which requires more frequent adjustments to avoid collisions, thereby slowing down the movement more than in cases withorcrossing angles. To sum up for obtuse crossing angles, the decrease in velocity becomes less pronounced as density increases with larger values of.

SECTION: Dimensionless numbers
The classification of pedestrian crowds has evolved beyond density-based metrics like Fruin’s Level of Service, as similar densities can exhibit diverse behaviors and risk profiles. Inspired by fluid dynamics, a recent researchhas introduced two dimensionless numbers that quantitatively capture personal space preservation and collision anticipation. These two numbers were called avoidance numberand intrusion number, and they help to understand the local mechanisms underlying collision avoidance and crowd cohesion.

The avoidance numberis a measure of the potential collision risk between two agentsand, defined as

whererepresents the anticipated time-to-collision (TTC), ands is a reference timescale beyond which collision risks are considered negligible. As highlighted in, agents primarily focus on the most immediate threat of collision during interactions. Consequently, the avoidance number for an individual agentis given by

wheredenotes the neighboring agent with the shortest TTC relative to agent. This formulation ensures that the most critical collision risk is captured for each individual.

On the other hand, the intrusion numberquantifies the degree to which one agent encroaches upon another’s personal space and is expressed as

whereis the distance between agentsand. Here,m represents the diameter of an agent, andm is the radius of the social zone, assuming isotropic personal spaces. The total intrusion experienced by agentis defined as

where the summation is restricted to neighbourswithin a distance. This ensures that only interactions with significant spatial overlap are considered.

In Figure(c) we have shown the probability density ofvalues for each crossing anglein our crossing flows data set. The crossing angle has a pronounced effect on, reflecting how agents anticipate potential collisions. For smaller crossing angles (to), the probability density is higher for intermediatevalues, indicating that agents frequently adjust their paths to avoid imminent collisions due to more frequent intersecting trajectories. In contrast, for, where all agents move in the same direction, the avoidance number is close to zero, as there is minimal need for collision anticipation or trajectory deviation. At larger crossing angles, such asand,values increase, with peaks at higher ranges, reflecting the greater anticipation required to navigate through opposing or near-counterflow streams. This means that higher crossing angles necessitate increased collision avoidance efforts, which can vary based on the density and proximity of agents. A one-way ANOVA on the 7 groups of avoidance numberdistributions reveals [] that the crossing angle has large effect size onvalues, as is also evident from Figure(c).

The probability density of intrusion numberhas been shown in Figure(d), from which it seems that the crossing angle has almost no effect onvalues. The peaks of the distributions occur within a narrow range for all, indicating that the frequency of moderate intrusion events is not strongly influenced by the crossing angle. A one-way ANOVA on the 7 groups of intrusion numberdistributions reveals [] that the crossing angle indeed has negligible effect size onvalues. This suggests thatis likely influenced by factors such as local density, movement coordination, speed variations among agents, crowd composition, spatial constraints, agent behavior strategies, and flow density at interaction zones, rather than being primarily dictated by the geometric arrangement of crossing flows.

Fundamental diagrams typically use density and velocity to describe the macroscopic relationship between crowd density and movement efficiency. However, dimensionless metrics such as theandoffer an alternative perspective on crowd dynamics, emphasizing the role of interactions and collision avoidance at the microscopic level. These quantities, being directly linked to the anticipation of collisions and the maintenance of personal space, address important aspects of pedestrian behavior that density and velocity alone may not adequately represent. So using our crossing flows data set we then proceed to draw-fundamental diagrams for each, and they are shown in Figure. Overall, there is a clear upward trend betweenandacross all crossing angles, indicating that as the avoidance number increases (higher anticipated collision risks), the intrusion number also increases (greater degree of personal space violations). This trend aligns with the intuition that more imminent collision risks are likely to lead to more spatial intrusions. There also exists a threshold around, above which the slope of-curves change noticeably for each. Below this threshold, thevalues increase more rapidly with, while above, the rate of increase inappears to slow down. This means that atthe impact of collision avoidance reaches a saturation. Beyond this threshold, agents may encounter a limit in their ability to adjust trajectories, leading to a plateau in interaction effects.

Focusing on the effect of crossing angleon the-fundamental diagrams, we note a somewhat monotonic dependence for obtuse crossing angles, but not for. For, the-fundamental diagrams tend to show a more monotonic and smoother dependence, as agents at these angles often have more structured movement patterns and reduced interference, such as in counterflows () or near-parallel flows. However, for, the-relationship is less consistent due to more frequent and complex interactions, including trajectory adjustments and collision avoidance, which disrupt monotonic trends. This distinction shows how the crossing angle influences the dynamics of avoidance and intrusion.

Inspired by the works of, we aimed to investigate whether situations with different crossing angles could be classified usingandvalues. For each trial, we calculated the mean values of these dimensionless numbers, averaged over all agents and time, and plotted them in the-phase space, as shown in Figure(a). The resulting plot suggests that classification based solely onandis not distinctly separable, as the data points for different crossing angles exhibit considerable overlap. This observation aligns with the notion thatis more influenced by local density or coordination of movement than by crossing angle alone.

We then turn to the conventional metrics commonly used in the literature for classifying crowd regimes, viz. pedestrian densityand velocity. From Figure(b), the classification using density and velocity appears to be slightly better than the-classification shown in Figure(a). While there is still some overlap between the points corresponding to different crossing angles, certain crossing angles (e.g.,and) seem to occupy relatively distinct regions of the-space. This distinction is likely due to the direct relationship between density and velocity with crossing angle, as these parameters reflect the physical interactions and flow dynamics more directly. For example,(unidirectional flow) allows agents to maintain higher velocities at higher densities, while for crossing flows, the interaction reduces velocities and spreads the density. However, for intermediate crossing angles (e.g.,or), the overlap suggests these values alone may not provide a clear classification and might need to be combined with additional metrics likeorto improve the separation.

SECTION: Multi-class classification of crossing flow scenarios
As discussed in the previous section, the overlaps observed in both the-and-phase spaces demonstrate the limitations of relying solely on these pairs to differentiate scenarios based on crossing angle. Although some separation is evident for extreme angles such asand, intermediate angles present significant classification challenges due to considerable overlaps. To address this, we propose the use of advanced methods, such as multi-class classification models, which can account for complex patterns and interactions among multiple features. By incorporating metrics like,,, and, along with their interdependencies, these models have the potential to provide a more robust and accurate framework for distinguishing crowd regimes across different crossing angles. In this paper, we employ logistic regression and random forest methods to classify crossing flow trials based on, utilizing,, andas input features.

SECTION: Logistic regression
Logistic regression, traditionally a binary classification technique, is adapted in this study for multi-class classification using the ‘one-vs-rest’ strategy. In this method, a separate binary classifier is trained for each crossing angle, treating it as the positive class while considering all other angles as the negative class. For our study, this requires running the algorithm 7 times, once for each crossing angle. The sizeof the---data for eachis relatively balanced with the same order of magnitude across crossing angles, with values,,,,,, and.

The model estimates the probability of an observation belonging to a class based on a set of feature variables. The method employs the logistic function, or sigmoid function, which maps the inputâa linear combination of feature variables with an added intercept termâto a probability value betweenand. This probabilistic framework allows the model to predict the most likely class based on the highest probability output.

The logistic function, also known as the sigmoid function, is defined as,

whereis the input to the function, and the outputis a value between 0 and 1, representing the probability of the binary outcome (e.g. 0 or 1) given the input. In logistic regression, this function is used to model the probability of a binary outcome(e.g. 0 or 1) given a set offeature variables. The logistic function is applied to a linear combination of the features, known as the logit, which can be written as:

whereis the probability of the positive outcome (e.g.), andare the coefficients or weights assigned to each predictor variable.

The coefficientsare estimated from the training data by maximizing theof observing the training data given the model. The log-likelihood functionfor logistic regression is given by:

whereis the observed binary response variable for the-th observation,is the estimated probability of the response variable for the-th observation given the values of the feature variables and the estimated coefficients, andis the total number of observations in the training data.

Once the coefficients have been estimated, we obtain the estimated probabilityof the positive outcome given a new set of feature values, we plug in these values into the logit equation to obtain:

If the estimated probabilityis greater than a threshold value (usually 0.5), we predict a positive outcome, otherwise, we predict a negative outcome.

All the computations reported here were done using thefunction in. The default optimization algorithm used by this function is the, which is also known as(IRLS). This algorithm iteratively updates the estimated coefficients to maximize the log-likelihood of the data, by using the observed response and predicted probabilities to compute a weighted least squares regression for the linear predictor.

For the multi-class classification of crossing flow scenarios based on the crossing angle, we utilized seven distinct models, each defined as a linear combination of the variables,,, and, as follows:

The choice of variables for each logistic regression model is guided by the need to explore the relative contributions of velocity, density, avoidance number and intrusion number in classifying the crossing angles, while keeping the models interpretable and meaningful. Model A (Eq.) focuses on the conventional macroscopic quantities of pedestrian dynamics, viz.and. These variables are widely studied in crowd modeling and are expected to reflect fundamental relationships governing movement efficiency. Including onlyandhelps isolate the effects of macroscopic flow dynamics. Model B (Eq.) emphasizes microscopic interaction-based metrics. By excludingand, it isolates the influence ofandon classification, focusing on collision avoidance behavior and spatial intrusion effects.

Model C (Eq.) is a hybrid model which combines velocity, reflecting movement efficiency, with avoidance number, a metric directly linked to collision anticipation. It investigates whether the interplay between macroscopic flow properties () and individual collision avoidance () can improve classification. In model D (Eq.), density, a macroscopic variable, is paired with intrusion number, a microscopic metric capturing spatial interactions. This model tests whether spatial intrusion dynamics, in conjunction with crowd density, can provide sufficient classification accuracy.

Model E (Eq.) expands on model C (Eq.) by including density alongside velocity and avoidance number. It explores the combined effects of macroscopic flow properties (,) and collision avoidance (). Model F (Eq.) includes velocity, avoidance number, and intrusion number, excluding density. The aim is to capture the combined effects of movement efficiency and both avoidance and intrusion behaviors, without redundancy introduced by density. Model G (Eq.) is a comprehensive model that includes all four variables, combining macroscopic flow properties with microscopic interaction metrics. It serves as a benchmark to assess whether adding all variables improves classification accuracy or introduces redundancy.

To assess the performance of the logistic regression models, we employed a-fold cross-validation approach. In this method, the dataset was randomly divided intosubsets, withsubsets used for training and the remaining subset reserved for testing. This procedure was repeatedtimes, ensuring each subset served as the test set once. For each model, theparameters were optimized during training, and the area under the curve (AUC) in receiver operating characteristic (ROC) space was calculated for both the training and test set, using the optimized parameters. This random partitioning was repeated overrealizations, resulting in a total ofoutputs. These outputs are summarised in Table, which were subsequently analyzed statistically, as shown in Table. In this study, we utilizedand.

For a perfect classifier one should have, a random classifier would produceand poor classifiers would produce. In Figure(a) we plot the mean AUC values obtained on the test set for each of the models defined and for each crossing angle. We found that the mean AUC values on the training set also have very similar values (Table), which indicates that our models are not overfitting. This is a consequence of using cross-validation, which helps in ensuring that the performance is not dependent on a particular data split.

From Figure(a) we can see that the AUC values vary significantly across the seven models (AâG), indicating that the choice of feature combinations strongly influences the classification performance for different crossing angles. For some crossing angles, such as(black) and(red), the AUC values are consistently higher across most models, suggesting that these scenarios are easier to classify. In contrast, intermediate crossing angles (e.g.,or) tend to exhibit lower and more inconsistent AUC values, reflecting the increased complexity in distinguishing these cases.

The evaluation of the models confirms that Model G generally exhibits the best performance across crossing angles, as its comprehensive inclusion of all four featuresâ,,, andâcaptures diverse aspects of pedestrian dynamics. Model C also demonstrates strong performance, with results comparable to Model G for most crossing angles, suggesting that the combination ofandalone provides significant discriminatory power. However, a series of one-way ANOVAs (Table) confirm that AUC values on test set for model G are statistically significant (except) compared to those for model C. Similar statistical analysis reveals that Models E, F, and G, while performing similarly for certain crossing angles such asand, exhibit reduced discriminatory ability at obtuse angles likeand. In contrast, Models A and B tend to perform worse overall, highlighting the limitations of relying solely on-or-pair. Finally, Model D consistently performs the worst, which meansandalone are insufficient for effective classification across all crossing angles. These findings suggest that while Model G remains the most robust, classification challenges persist at higher crossing angles, and simpler combinations such asandcan still achieve competitive performance.

SECTION: Random forest
Next we used random forest, an ensemble learning method, to classify crossing flow scenarios based on crossing angleusing the four key features at our disposal. Random forest constructs multiple decision trees and outputs the mode of individual decision trees for classification problems. It performs well in handling non-linear boundaries, missing data, outliers, and high-dimensional datasets while mitigating overfitting through the averaging of predictions from multiple trees.

In our study, an 8-fold cross-validation was implemented to evaluate the performance of the random forest model. The data was split into 8 folds. In each iteration, 7 folds were used for training the model, and the remaining fold was used for testing. This process was repeated 8 times, ensuring that each fold served as a test set exactly once. The model was configured to use 500 decision trees and was trained on the training data in each fold. The out-of-bag (OOB) error, an internal validation metric of the random forest algorithm, was recorded for each fold to provide an additional performance measure. Then predictions were made on the test set, and a confusion matrix was generated to calculate the accuracy (ACC) and Cohen’s Kappa.

OOB error is a performance metric unique to ensemble methods like random forest. It is the error rate computed using the out-of-bag samples, i.e., those not included in the bootstrap sample used to train each decision tree. OOB error offers an unbiased estimate of model performance without requiring a separate validation set. It is particularly useful for evaluating random forest models during training, as it provides a built-in cross-validation mechanism. Accuracy (ACC) measures the proportion of correct predictions made by the model over the total number of predictions. ACC provides a simple and intuitive measure of a model’s performance by quantifying its overall success rate.

Cohen’s Kappais a statistical measure of inter-rater agreement that accounts for the agreement occurring by chance. It evaluates the consistency between predicted and actual classifications in a model while considering the possibility of random agreement. Unlike accuracy, which measures only the proportion of correct predictions,adjusts for the fact that some level of agreement can occur randomly. It could be defined as

whereis the observed agreement, or the proportion of correct predictions (similar to accuracy), andis the expected agreement by chance, calculated based on the class distributions in the data. In a confusion matrix for multi-class classification,could be calculated as

where(in our case) is the number of classes,is the total number of true classification in class,is the total number of classification in classandis the size of data set. Interpretations of Cohen’s kappa values are summarised in Table.is a more reliable metric than ACC in multiclass classification problems like in our study, because it adjusts for the agreement expected by chance, offering a more comprehensive assessment of model performance, especially when class distributions are imbalanced.

The results of the random forest classification, including OOB error, ACC, andfor each fold, are summarized in Table, which demonstrates the consistent and robust performance of the random forest model across all 8 folds in the cross-validation process. The OOB error values across the 8 folds are consistently very low, all values, indicating that our random forest model generalizes well to unseen data. The small variability in OOB error across folds reflects stability in the modelâs performance. The accuracy values across folds are uniformly high, all ACC, confirming that the random forest achieves excellent predictive performance in classifying crossing flow situations. This high accuracy demonstrates the model’s capability to correctly predict the crossing angle for most instances. Thevalues are consistently close to. This indicates almost perfect agreement between the modelâs predictions and the true labels. Highvalues further validate the reliability and robustness of the classification model.

Since we were primarily interested in classifying crossing flow situations using the four features at our hand, we studied the average feature importance across all folds to identify the most influential features in our random forest models. For each crossing angle, the random forest was trained using the corresponding subset of the dataset (e.g., data for (e.g. data foror). As mentioned before, during training, the random forest algorithm evaluates the contribution of each feature to improving the modelâs predictive accuracy or reducing impurity at every split in the decision trees. These raw importance values are calculated for each tree in the forest and then averaged across all trees. To ensure statistical robustness, the training process is repeated across multiple folds during cross-validation. The raw importance values from all folds are then averaged to obtain a single importance score for each feature at a given crossing angle. This procedure allows us to observe how feature importance varies across crossing angles, helping us to identify the most relevant variables for distinguishing flow dynamics.

To further analyze the importance of each feature, we employed two commonly used metrics: mean decrease in accuracy (MDA) and mean decrease in Gini impurity (MDG). These metrics quantify the relative contributions of the features to the classification task, offering complementary perspectives on their importance.

MDA measures the decrease in the random forest model’s accuracy when a particular variable is removed (or randomized). It quantifies how much a variable contributes to the predictive performance of the model. During training, the random forest algorithm calculates the accuracy of the model on the out-of-bag (OOB) data. For each variable, its values are randomly permuted (shuffled) in the OOB data, while all other variables remain unchanged. The model is then used to make predictions on the permuted OOB data, and the accuracy is recalculated. MDA is the difference between the original accuracy and the accuracy after permutation, averaged across all trees in the forest. A higher MDA indicates that the variable is crucial for the modelâs predictive performance. Removing or randomizing the variable leads to a significant drop in accuracy. Whereas, a lower value suggests that the variable contributes less to the model.

On the other hand, mean decrease in Gini impurity (MDG) measures the average reduction in the Gini impurity (a measure of data homogeneity) across all splits in all trees of the forest where the variable is used. Each decision tree in the random forest splits the data at different nodes based on variable values to minimize the Gini impurity. The reduction in Gini impurity for each split is calculated. The MDG for a variable is the sum of all Gini impurity reductions it contributes, averaged across all trees in the forest. A higher MDG indicates that the variable contributes significantly to making splits in the decision trees, improving the modelâs ability to separate classes. A lower value implies that the variable is less important for creating useful splits. In Tablewe present the feature importance metrics (MDA and MDG) for velocity, density, avoidance number, and intrusion number across different crossing angles, highlighting their relative contributions to the random forest classification performance.

To facilitate a clearer comparison of feature importance across crossing angles, we converted the average importance values, including Mean Decrease in Accuracy (MDA) and Mean Decrease in Gini (MDG), into percentage contributions. This transformation normalizes the importance values, expressing each featureâs contribution as a proportion of the total importance across all features. By doing so, we eliminate the influence of absolute magnitudes and focus on the relative significance of features, providing a more interpretable framework for assessing their roles in classification. In Figurewe illustrate the percentage contributions of each feature to classification performance across crossing angles and their overall importance based on MDA and MDG metrics.

It is evident thatandconsistently exhibit the highest importance values, as reflected in both MDA and MDG metrics, indicating their strong predictive power across all crossing angles. Conversely,andcontribute relatively less to classification performance, withbeing the least influential feature. Figure(a) shows that the contributions ofanddominate across crossing angles, withbeing particularly critical for obtuse angles (e.g.,and) andcontributing the most for intermediate angles likeand. Figure(b) further confirms thatandare the primary drivers of classification accuracy, as they consistently show the largest percentage contributions for both MDA and MDG. These findings highlight the complementary roles ofandin characterizing crossing flows, whileandprovide supporting but less significant contributions.

SECTION: Implications for crowd management
The findings from this study provide valuable understanding of pedestrian dynamics and crossing flow behavior, which can inform strategies for effective crowd management. By analyzing velocity, density, and dimensionless metrics such as avoidanceand intrusionnumbers, alongside employing machine learning techniques, we have identified critical factors influencing pedestrian flow efficiency and safety under various crossing configurations.

: The analysis of velocity and density distributions reveals that extreme crossing angles (e.g.,and) allow for more organized and efficient pedestrian flows due to either minimal interaction (parallel flows) or lane formation (counterflows). Intermediate angles, however, result in complex interaction patterns, reducing walking speeds and increasing congestion. This knowledge can guide the design of infrastructure to minimize intermediate crossing scenarios, such as implementing barriers or directional signage to align pedestrian flows.

: The variation ofwithacross crossing angles provides critical information about how crowd movement efficiency changes under different configurations. The fitted models for the fundamental diagrams reveal that power-law, logarithmic, and linear dependencies correspond to distinct pedestrian behaviors, such as unidirectional flow, counterflow with lane formation, and intermediate crossing interactions respectively. These findings help identify the density thresholds beyond which crowd movement efficiency deteriorates. This could help in creating practical guidelines for designing spaces to prevent congestion and improve pedestrian flow in areas with varying densities and interaction patterns.

:andprovide a detailed understanding of collision avoidance and personal space dynamics. The observed trends suggest that managing avoidance behaviors, especially at larger crossing angles, can mitigate collision risks. Strategies such as optimizing entry and exit points or deploying crowd marshals to reduce abrupt trajectory changes may enhance flow efficiency.

: The machine learning analysis identifiedandas the most influential features for classifying crossing scenarios. This suggests that monitoring and managing these parameters in real-time can provide an effective approach to control pedestrian dynamics. For example, technologies such as video surveillance with AI-driven velocity and interaction monitoring could assist in identifying bottlenecks or high-risk zones.

: Results presented in this paper show the need for pedestrian crowd management designs that account for crossing angles. For example, infrastructure can be optimized to encourage counterflow () or parallel movement (), where pedestrian dynamics are more organized and efficient. Similarly, intermediate-angle crossings, which are prone to congestion, may benefit from wider crossing zones or staggered entry points to reduce interactions.

Design considerations could also incorporate dynamic signage or real-time flow regulation to guide pedestrians toward less congested pathways, particularly during peak traffic. For scenarios involving high densities, understanding the critical thresholds from velocity-density fundamental diagrams enables targeted interventions, such as rerouting or temporary lane formations. Furthermore, the distinct behavioral patterns observed in velocity and avoidance metrics suggest that spatial configurations promoting better visibility and anticipationâsuch as curved or angled approach pathsâcan mitigate potential bottlenecks or collisions. These design strategies could collectively enhance flow efficiency and minimize risks in both regular pedestrian areas and emergency evacuation scenarios.

By integrating these findings into urban planning, event management, and public transportation design, practitioners can create safer and more efficient pedestrian environments. Future research could expand on these results by incorporating other crowd dynamics factors, such as heterogeneous pedestrian behaviors or the impact of external stimuli (e.g., obstacles or visual cues), to develop more comprehensive crowd management strategies.

SECTION: Conclusion
In this paper, we have presented a comprehensive study of pedestrian dynamics in crossing flows, focusing on velocity, density, and interaction metrics, and their influence on the classification of crossing scenarios. Using logistic regression and random forest models, we analyzed data from seven crossing angles, incorporating both macroscopic (,) and microscopic (,) features. The goal of this research was not merely to build a high-performing classification algorithm but to identify which features are most effective for differentiating crossing scenarios and to understand the underlying dynamics shaping pedestrian movement.

This research also shows the significance of-and-fundamental diagrams in understanding pedestrian behavior. The-diagrams reveal distinct functional formsâlinear, logarithmic, and power-lawâacross different crossing angles, reflecting varying interaction patterns. For instance, the power-law relationship observed athighlights the minimal interference in unidirectional flows, while the logarithmic behavior at obtuse angles such asandunderscores the influence of lane formation in counterflows. These findings provide valuable benchmarks for assessing critical density thresholds where pedestrian flow efficiency begins to deteriorate, offering practical guidance for designing spaces to mitigate congestion and enhance safety. On the other hand, the-fundamental diagrams further illustrate the interplay between collision avoidance and personal space preservation, showing a clear upward trend and a saturation effect at higher avoidance numbers. This could inform strategies for optimizing pedestrian interactions in dense environments.

The choice of logistic regression and random forest models was motivated by their complementary strengths. Logistic regression offers interpretability, and understanding of feature contributions, while random forest excels in capturing non-linear interactions and complex dynamics. Among the tested models, Model G, which included all four features (,,, and), exhibited statistically significant superior performance across most crossing angles. The high accuracy, low out-of-bag (OOB) error, and consistently highvalues achieved by the random forest model underscore its robustness and reliability. The minimal variation in these metrics across folds further validates the stability of the model under cross-validation.

Interestingly, Model C, which combinedand, delivered comparable performance to Model G for certain crossing angles, showing the predictive power of these two features. However, its effectiveness was not uniform across all angles, suggesting that the inclusion ofandin Model G provides additional discriminatory power in more complex scenarios. Theandmetrics, while less impactful individually, offer valuable insights into pedestrian collision dynamics, as their trends reveal critical thresholds and behavioral shifts that can inform crowd management strategies.

To summarise, this study establishes the critical role ofandin characterizing crossing flows, particularly under varying angles. By leveraging these insights, future work can focus on refining classification models and applying these findings to real-world crowd management strategies. The-and-fundamental diagrams provide a robust framework for understanding pedestrian interactions, which can be extended to design safer and more efficient public spaces, transport hubs, and event venues. These findings also pave the way for integrating advanced monitoring technologies, such as AI-driven video analysis, to enhance real-time crowd flow management and ensure pedestrian safety in high-traffic areas.

SECTION: References