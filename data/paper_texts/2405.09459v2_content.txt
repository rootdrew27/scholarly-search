SECTION: Fourier Boundary Features Network with Wider Catchers for Glass Segmentation

Glass largely blurs the boundary between the real world and the reflection. The special transmittance and reflectance quality have confused the semantic tasks related to machine vision. Therefore, how to clear the boundary built by glass, and avoid over-capturing features as false positive information in deep structure, matters for constraining the segmentation of reflection surface and penetrating glass. We proposed the Fourier Boundary Features Network with Wider Catchers (FBWC), which might be the first attempt to utilize sufficiently wide horizontal shallow branches without vertical deepening for guiding the fine granularity segmentation boundary through primary glass semantic information. Specifically, we designed the Wider Coarse-Catchers (WCC) for anchoring large area segmentation and reducing excessive extraction from a structural perspective. We embed fine-grained features by Cross Transpose Attention (CTA), which is introduced to avoid the incomplete area within the boundary caused by reflection noise. For excavating glass features and balancing high-low layers context, a learnable Fourier Convolution Controller (FCC) is proposed to regulate information integration robustly. The proposed method has been validated on three different public glass segmentation datasets. Experimental results reveal that the proposed method yields better segmentation performance compared with the state-of-the-art (SOTA) methods in glass image segmentation.

SECTION: IIntroduction

As a solid, glass has special properties of both light transmission and reflection, hence it is widely used in many scenes, such as streets, buildings, and industrial production workshops. At the same time, due to prior knowledge and the complex visual nervous system, humans can detect the glass, what is behind the glass, and the reflected virtual world, which is a huge task for machines. To reduce the impact of glass on the practical tasks of intelligent systems based on machine vision (e.g., depth estimation and driving obstacle avoidance), machine vision is required to accurately segment the glass region.

Previous exploration of glass semantic segmentation consistently found boundary detection and context information as two effective solutions. In some complex scenes, the glass only provides weak or incomplete boundaries, and the context content is highly confused by the glass transmission and reflection, resulting in reduced segmentation accuracy of networks. Although the advance of current methods to counter

the ambiguous glass boundaries and incoherent contextual information, there are absence of excavating the essential challenges: (1) Overabundant semantic information: the deep complex backbone model can extract fine-grained information to enhance the segmentation object detail. However, over-capturing essentially mismatches the glass segmentation because light transmission causes a strong context consistency between internal and external segmented areas, which is not susceptible to the affinity of highly extracted features; (2) Shaky boundary constraints: current methods utilize various boundary detectors to preserve the outline and locate regions, such as the shallow-low features, which are fragile and easily affected by the subsequent gradual abstraction and fine-granularity of the network.

To alleviate the issues above, we designed the Fourier Boundary Features Network with Wider Catchers (FBWC), which is a shallow-width glass segmentation network with stable boundary constraints. First, we introduce a novel feature extraction backbone to solve the critical problem of semantic information over-capturing. Specifically, Wider Coarse-Catchers (WCC) consist of multiple Capturing Units (CUs) to provide earlier trough points in the encoding process than the traditional backbone. The structure of shallow and wide with connections of continuous CUs benefits glass coarse-grained region information extraction through a series of appropriate horizontal trough points. At the same time, we fully take advantage of decoding to embed strong and steady boundary constraint information, which is concentrated significantly throughout the backbone without dispersiveness and distortion in highly abstracted processes. For another characteristic of glass, we designed Cross Transpose Attention (CTA) specifically to resist the impact of noise reflected by glass on the shallow layers through the focusing object area. Based on large and coarse-grained regions, progressively strengthened boundary constraints, and features complemented with high focusing, the Fourier Convolution Controller (FCC) is pointedly proposed to consolidate shallow boundaries with Fourier transform and flexibly balance that heterogeneous information by self-learning convolution paradigm. To sum up, our contributions are as follows:

To the best knowledge, we might be the first attempt to design a wide and shallow backbone to combat over-capturing in the glass segmentation task. Besides, continuous, stable, and strong boundary constraints are fully leveraged throughout our WCC. For an extra supplement, Cross Transpose Attention is proposed to focus on details for keeping regional integrity and consistency.

A learnable solution for utilizing the heterogeneous features to self-adjust and balance the fusion is innovatively provided, which provide an optimal combination of coarse-grained and fine-grained feature representations by embedding classical convolution theory. Meanwhile, the Fast Fourier Transform (FFT) is embeded to enhance the generated boundary features.

Experimental results on three different public glass segmentation datasets show that the proposed FBWC outperforms previous SOTA methods. We further demonstrate the ability of our network to reveal the nature of segmentation tasks based on glass properties.

SECTION: IIRelated Works

SECTION: II-ABoundary Detection

From the perspective of bionics, one of the important bases for humans to judge glass-like objects is to find their boundary[1], which is a significant clue to help us divide reality and the virtual world transmitted and reflected by glass. Hence, the existing methods[2,3,4]have carried out a lot of work around the glass boundary detection and made great progress. Xieet al.[5]found that due to high contrast in the edge of the glass, boundary detection is prone to observe compared with content for being paired with human visual perception. Therefore, they proposed a novel network named TransLab to utilize the predicted boundary map for improving accuracy. Heet al.[6]enhanced boundary learning for glass segmentation through the refined differential module and further edge-aware point-based graph convolution to establish a complete shape along the boundary. At the same time, Caoet al.[7]argue that boundaries with large smaller amounts, the boundary-related imbalance problem, adversely affect glass semantic performance, which is solved by designed FakeMix. However, the mentioned methods of glass boundary detection heavily rely on the quality or quantity of boundary features extracted and optimized by the network, which is a worrying process due to weakening, distortion, and even dispersion of boundary during progressively abstracting. For this, Liet al.[8]optimized edge pixels by explicitly sampling under decoupled supervision for better consistency. Similarly, indirect boundary supervision through a single pathway is shaky and vulnerable to the erosion of high-dimensional semantic features. Inspired by previous works, we fully utilize boundary constraints directly with multiple supervision, aiming at offering firm and robust constraint features in the decoding process.

SECTION: II-BContext Features of Glass

The instability of boundary constraints and weakly blurred boundaries provided by glass in some complex scenes[9]limit the favorable influence of glass boundary detection methods on the accuracy of segmentation results. Therefore, the methods are gradually biased towards the study of how to efficiently leverage abundant context for glass segmentation from multi-scale features extraction focusing[4][10,11]and effective fusion[12,13]. Yuet al.[14]have considered deep-layer features with more high-level semantics to be better at the location. Shallow layer features own larger spatial sizes with detailed low-level information instead. PGSNet is designed through progressively aggregating to avoid fusing these features naively. Huet al.[15]proposed a VIT-based deep architecture to associate multi-layer receptive field features and optimize fusion results. Besides, due to the large and complete glass regions context, the attention mechanism is in full utilization. CAGNet[16]integrates two kinds of convolutional attention mechanisms with a Transformer head for deep-shallow feature analysis and fusion. Houet al.[17]further introduce the Transformer encoder-decoder architecture to boost the usage of multi-levels of context information. Linet al.[18]embed context correlation into the attention module to bridge contextual links among objects both spatially and semantically.

Although complex and deep network structures can abstract spatial semantic features on multi-scales to facilitate subsequent feature fusion, for the special segmentation target, glass, over-captured segmentation features will destroy the coherence of shallow information, making it difficult for the network to maintain the integrity of large-area segmentation. At the same time, the previous attention mechanism is more inclined to deal with multi-scale features with different depths and shallow features, and it fails to effectively match the width feature extraction framework to complete the shallow feature self-focusing task.

SECTION: II-CArchitecture of networks

In the classical network structure, deeper layers benefit the network’s ability to abstraction, which is conducive to the affinity for high-level object features and captures rich and complex semantic information. In addition to the problem of gradient disappearance or explosion[19]with deepening architecture, depth-based networks often fall into the dilemma of over-capturing for the task of semantic segmentation of glass. Specifically, most of the glass-like objects are a large area with a complete boundary and regular shape, hence over-abstraction of this information is harmful to improving the performance of the segmentation. At the same time, the shallow features learning in the network can also learn the complex functions and information captured by the deep net[20]. Therefore, in order to better pair the object’s characteristics of segmentation, a suitable network architecture with carefully balanced depth and width[21]is proposed to avoid the accuracy decrease caused by over-segmentation. Embracing the advantages of shallow layers, the basic low-level shape and outline of the glass can be relatively intact without distortion. Aiming at the reservation of shallow features, trough points, as turning points in the depth of the network, should occur in advance to avoid the dilution effect[22]of features during deepening. Inspired by the Broad Learning System[23,24,25,26], multiple trough points generated by the recurrent connections structure[27]widen the structure and drive the extracted information gradually permeating the network.

To mitigate the limitations associated with the conventional network framework in glass segmentation, such as overfitting from deep networks and the loss of intricate features from shallow networks, we propose a cyclic shallow backbone network. This network imposes rigorous constraints on layer-by-layer boundaries, enabling the extraction of semantic information tailored to the unique characteristics of the glass region. Thus, we attempt to explore the wider feature extraction to avoid over-capturing caused by a deeper network, which might be not suitable for the special semantic objects with large areas. This approach safeguards feature integrity and enhances segmentation accuracy by ensuring that semantic information is effectively captured within the boundary range.

SECTION: IIIProposed Methodology

The glass can be easily recognized by the human visual system based on prior knowledge, even though eyes suffer from the noise of objects through the glass and what the glass reflects. Humans are prone to utilize the surrounding context to confirm the existence of glass boundaries. With the information about the boundary, humans can accurately distinguish between the real world and the virtual world reflected by glass. This is particularly important for how machine vision circumvented the confusion of information brought by the properties of glass, both transmission and reflection. Inspired by this, we attempted to encode this practical phenomenon to achieve the bionic human visual system’s intention to segment glass regions, then we proposed the FBWC.

SECTION: III-AArchitecture

The overall architecture of the proposed FBWC is introduced in Figure2. Firstly, for the input,we utilize downsampling and convolution operation as pretreatment to preliminarily obtain the same two features:andwheredenotes the number of channels anddownsampled shape hyperparameter.

For, we introduce WCC, which consists ofCUs, to acquire large and shallow information through lateral broadening backbone without longitudinal deepening. Besides, the glass edge information extracted by the canny operator from ground truth is exploited to constrain the boundary in WCC. Then, CTA is forelaborated, which combines effective mechanism of attention between two feature branches to supplement and focus detailed information. Moreover, the core feature fusion regulator module of FBWC is designed as a FCC with a learnable paradigm to flexibly balance deep-shallow heterogeneous feature expression.

Based on the self-learning fusion feature controller, the FBWC derives a lot of adjustment flexibility and self-correction margin. Thus, instead of designing a complex loss function design, we introduce ohem cross-entropy[28]and binary cross-entropy loss to monitor the propagation of semantic information across the proposed network. To be specific, for the-th decoder of CU in WCC, binary cross-entropy loss with boundary-awareness is applied by the Canny operator to gradually strengthen boundary constraints. At the same time,andrefer to supervised learning from ground truth to the controller and Attention Mechanism (AM) results with ohem cross-entropy loss , respectively. Therefore, the final loss for FBWC is:

whererepresents numbers of CUs, anddenotes the loss of Boundary Constraint (BC Loss) to a single CU.

SECTION: III-BWider Coarse-Catchers

The point at both large segmentation and transmittance areas like the object of glass, we hold the opinion that over-capturing with classical deep structure embraces noise instead. Due to deep layers’ highly abstracting semantic information, a backbone with a complex semantic concentration frame generates dispersive fine-grained features which make a barrier for boundary constraints and glass surface segmentation. Therefore, taking advantage of low-level semantic information in shallow layers is conducive to pairing the implicit characteristics of the glass.

As shown in Figure3, we employ CUs as the component of our WCC. We notice that shallow encoded information can provide a large area of segmentation, and the decoding process is conducive to boundary constraints. Hence, the CU consists of three layersencoding-decoding symmetric structure and three important points: start point, trough point, and end point. In particular, the constraint point is named by sharing the both start and end position in WCC.

Specifically, in the encoding process, we use convolution and down-sampling to manage the number of channels and half the size of height and width respectively on each layer, which can be formulated as:

whereanddenote dowm-sampling and convolutional operator, respectively. And theis defined as the continuous operator which executestimes.

For the-th CU,orandare named trough point and start point, respectively. After the continuous operation of convolution and dowmsampling, in the process of decoding, we apply up-sampling operators with bilinear interpolationand the skip connection to bridge result features of up-sampling and. Finally, the decoding process is defined as:

wheredenotes the features of the-th layer on the decoder of-th CU. And the operator of skip connectionis defined as.
To sum up, the CU mapping () can be expressed as:

whererepresents continuously downsampling via convolution. Furthermore,is denoted as upsampling the results of. The process of inputgetting outputs after the first CU is formulated as:

whereis for coarse-grained features acquisition andis for continuous asymptotic boundary constraints. Generally, when, it means that multiple CUs need to be connected in series. As a result, the representation of variables on output layers in CUs are defined as following:

Finally, the constraint points setand trough points setare represented as the outputs of multiple CUs for forming a wider shallow feature capture framework.

SECTION: III-CCross Transpose Attention

Through WCC as backbone, trough point and constraint point gather large glass semantic region and strong constraint boundary information respectively to avoid over-capturing noise caused by the structure of trough point lagging. However, shallow and wide networks with early troughs are prone to suffer from unfocused features, which

results in incomplete semantic regions within the boundary due to glass reflection. To supplement the fine-grained features and keep regional consistency, CTA is designed as an auxiliary branch for accurate segmentation, which is illustrated in Figure4.

For the input,and, we first keep the image size consistent through bilinear interpolation for obtainingand. As forand, mapping the same size tensors separately utilizing convolution:and. Then, we transpose the respective tensors to cross multiply at the same pixel position for calculating the weight of the pixel. By the generated cross attention weights, a joint matrix is established to obtain updated attention results. We formulate the mentioned process:

whererefers to Sigmoid function andis denoted as Cross Transpose Attention operator with tensorsand. The cross similarity coefficients are expressed byand. The final output of CTA isfor effective focusing on fine-grained semantic features.

SECTION: III-DFourier Convolution Controller

Instead of directly fusing information among,, and, the FBWC utilizes FCC as the features learnable regulator to deal with heterogeneous inputs. Figure5illustrates the detailed structure of our FCC, which is designed to provide an optimal combination of coarse-grained and fine-grained feature representations by embedding classical convolution theory. This feature combination is a nonlinear combination of features under different branches:

whererepresent the feature extraction of three different branches under parameter sets, themeans model training and output the feature after fusion, and the parameter setsare learnable. Therepresents the desired feature which determined by ground-truth.

We useto represent the result ofwhich fused the glass frequency domain information obtained through FFT:

where themeans executing operation for each channel ofwhich belongs to, and therepresents the glass frequency domain information extracting process:

whereandrefer to frequency domain variables. In the FFT process, theis the value of the feature point at positionin one channel belongs to.

The two-dimensional FFT can be regarded as a generalization of one-dimensional FFT, then we obtain expression of a single feature point value on a single column:

We replaceandbyandrespectively, then Formula (13) can be reformed as:

Let,,, where,, then we obtain a more unified form:

The process of FFT can be thought of as the solution of the inverse of in the following equation:

where

Then we useto represnet the element in-th row and-th column in, thencan be expressed as:

Let,, whereorandor, and we define operationas follow:

Then we transfer Formula (19) into the following form:

When, we can obatin the inner sum over:

whereis the intercept location, if, and, we can get a more general form:

From Formula (11) and Formula (22), the FFT result is shown as follow:

According to Formula (22) and (23), there exists a recursive subtraction with a window size of 2 and a step size of 1 during the process of conducting FFT, which means that the difference between odd and even components is magnified in the frequency domain. Due to the images having naturally sparse representations[29], we only use the even symmetry components of each channel and the real part is reserved. According to[30], the IFFT is not required while the imaginary part is not used and the regular geometric structure feature in the pixel domain will be reserved. Then the boundary of glass in the pixel domain which is a regular geometric structure can be magnified in the frequency domain. However, using only frequency domain features may result in the loss of some refinement features in the pixel domain. To solve this problem, we fused the two heterogeneous source data in the frequency domain and spatial domain.

Proposition 1.Assumingis an image with regular geometric boundaries. For any continuous piecewise linear function subsetand any, any convolutional neural network ( CNN )with depthand ReLU function exists:

Proof.For convenience, we consider the binary case, for simplicity, which is also suitable to the case in our study to explain how FFT affects CNN learning. Denoteandto be the sets which contained the signals from two classes, and there is a positive gap betweenand. That is, there exists somesuch as:

Assume that there is an ideal functionsuch as:

For example, thecan be expressed as:

whereandrepresent the coefficients, at the same time, theandrepresent the biases. The, which is the operation of the convolutional layer, is composed of multiplication and addition. Then we can apply a CNN consisting of at least one convolution layer to approximate Formula (27). To increase the approximating ability, we usually introduce a nonlinear activation function. Since FFT in our case will produce some unwanted negative values, we use ReLU as the nonlinear function. Further, assuming, therepresents an image with regular geometric boundaries.

We input the imageto a CNN with depth, and providedsamples which are homologous toduring the training. The approximating continuous piecewise linear functionis obtained via solving the empirical minimization:

The approximating accuracy can be calculated as follows:

whereis a probability measure on. Direct estimation of Formula (29) is difficult due to the additional complication of sampling errors, thus most existing approaches estimate Formula (29) by separating it from the approximation error via triangle inequality:

whererepresents the CNN space:

where theandrepresent weight space and bias space, respectively. And therepresents the convolution kernel size of-th convolution layer. Since we consider that the CNN has converged, we no longer consider the value of, which meanscan be regarded as. Then the approximation accuracy only needs to consider.

According to Formula (25), ifapproximates to, it should have the following properties:

We useto represent one convolution layer with ReLU function, then we can obtain:

For a CNN with two convolution layers, we have:

whereandrepresent the output of first layer convolution withandas the original input, respectively. Then, for, the input of the-th layer is the output of the-th layer, we can obtain the general form:

If there existssatisfying, wheremeans a minimum, we will considerapproximates to.

According to[31]and[32], we solved the Formula (28) by updatingandthrough backpropagation errors, and the scope of each update is limited. After a finite number of iterations for Formula (28), the lower bound ofis still determined by, which is as shown in Formula (32). In our case, the positive gap is established by the border of glass. The pixel values within the boundry belong toand the pixel values outside the boundary belong to. Then we replacebyas the input of, the Formula (30) can be reformed as:

In the above, the FFT can amplify the differences of the pixel around the boundary in frequency domain, then we can obtain:

Afterandare utilized as the inputs of the CNN, we usedandto represent the maximum value in, respectively. According to Formula (37), we can obtain:

which means:

Then the Proposition 1 is proved.

According to theas weight branch, theas variable branchand theas bias branch, we formally define learnable Fourier Convolution Controller as:

In the FCC, theleads and magnifies the significance of fine-grained focusing regions based on shallow and large objects inwithout over-capturing, besidesutilizes the boundary constraint feature to flexibly correct and limit the position of semantic regions.

SECTION: IVExperiments

SECTION: IV-AExperiment Setting

Datasets.For the performance evaluation of the proposed method, we carry out detailed experiments on three glass segmentation tasks: GDD[9], HSO[14], and Trans10K-Stuff[5]. To provide further clarity, the GDD comprises a total of 3916 images. Among these, 2980 images are allocated to the train set, while the remaining 936 images constitute the test set. Simultaneously, HSO serves as a comprehensive scene segmentation dataset, primarily focusing on family environments. It is meticulously crafted to unlock a myriad of applications for domestic robots. The dataset divided 3070 of 4852 images into a training set and 1782 as a test set. Aiming at exploring the glass segmentation task, in the selection of the data set, we prefer to choose the segmented transparent glass targets. Thus, on the large-scale transparent object segmentation dataset Trans10K-Stuff, which contains two categories: stuff and things, we utilize the category of stuff in the whole dataset. The filtered result dataset Trans10K-Stuff consists of 2455 train set and 1771 test set. For training, input images are augmented by randomly horizontal flipping and resizing. Throughout the testing process, all datasets of images are resized intowithout any pre-processing.

Evaluation Metrics.The evaluation metrics used in the experiments for comparison of our proposed methods with other SOTA methods including, intersection over union (IoU), mean absolute error (MAE), and balanced error rate (BER), which are defined as follows:

where the value of true-positive is denoted as TP, false-positive as FP, true-negative as TN, and false-negative as FN respectively. Simultaneously,is denoted as the output of models for glass prediction andrepresents the labels of annotation on the pixel.andrepresent pixels in the images that contain and do not contain the segmented objects of glass, respectively.

Implementation Details.The method outlined in our paper is implemented using the PyTorch framework on an NVIDIA RTX 4090 GPU equipped with 24GB memory. We run for 200 epochs with a batch size of 6 for the GPU. Before fine-tuning our models, we utilize pre-training weight as most of previous works, which is trained by ImageNet[33]. The three public glass segmentation datasets are optimized using an SGD optimizer with a weight decay of, an initial learning rate of 0.001, and a momentum of 0.9. Throughout the training process, we utilize the polynomial learning rate policy to gradually adjust the initial learning rate, denoted as.

SECTION: IV-BComparison Results

In this study, to verify the effectiveness and robustness of the proposed method for the task of glass segmentation, the method is compared with a variety of methods in several related fields with few glass segmentation methods at present. We conduct extensive experiments to compare the segmentation performance of our work and state-of-the-art methods including PraNet[34], U-Net[35], and Transfuse[36]on medical image segmentation methods. DSS[37], PiCANet[38], RAS[39], CPD[40], EGNet[41], F3Net[42], MINet-R[43], ITSD[44], LDF[45], U2-Net[46]and Spider[47]on salient object detection methods. ICNet[48], PSPNet[49], DeepLabv3+[50], DenseASPP[51], BiSeNet[52], DANet[53], CCNet[54], GFFNet[55], SFNet[56], FaPN[57], PIDNet[58]and BiRefNet[59]on semantic segmentation methods. DSC[60], DSD[61], and BDRAR[62]on shadow detection methods. SINet[63], PFNet[64], and RankNet[65]on camouflaged object detection methods. MirrorNet[66]and PMD[1]on mirror segmentation methods. TransLab[5]and Trans2Seg[67]on transparent object segmentation methods. GDNet[9], GSD[2], EBLNet[6], PGSNet[14], RFENet[68]and GateNet[69]on glass segmentation methods. To be fair, we retrained either their open codes or the implementations with recommended parameter settings on the three datasets for effective comparison.

Our quantitative results on the glass segmentation task achieve excellent performance compared to other 39 previous works on three benchmark datasets, which is present in TableI. The proposed method achieves the best comprehensive performance and surpasses the SOTA method PGSNet[14]on GDD with a significant improvement of IoU by 5.36%, a decrement of MAE and BER by 0.025 and 1.53 respectively. Besides, the proposed method shows a slight advantage on Trans10K-stuff with MAE and can be consistent with the SOTA methods on other metrics. At the same time, we can also see that FBWC outperforms the previous works on all metrics based on HSO. Specifically, FBWC achieves 87.59% on IoU, 0.059 on MAE, and 6.27 on BER, which are 7.28% higher, 0.023 and 2.54 lower than the performance of the best glass segmentation method. From the test indexes of the three data sets, our FBWC comprehensively embodies excellent segmentation performance and generalization ability.

In addition to quantitative comparisons, from the visual qualitative results in Figure7, we can observe that our FBWC can first fully constrain the boundary information of the segmented target region so that the visual results embrace a clear and complete segmentation boundary to distinguish the background and the glass region. Besides, our work relies on the advantages of shallow space acquisition structures to efficiently avoid the impact of over-capturing as noise on segmentation results. Finally, by establishing a semantic association between fine-grained feature focusing and large-area target region, the proposed method can accurately anchor the segmentation region to eliminate interference information.

SECTION: IV-CAblation Study

To evaluate the ability of horizontal shallow branches in the glass segmentation task to avoid excessive extraction and the influence of various components of our proposed FBWC, we further conduct ablation studies on three datasets, which can verify the effectiveness and generalization ability of designed factors in the model.
Firstly, we design WCC against the phenomenon of over-capturing. With the increase of the depth of the network structure, semantic information will be gradually abstracted, and excessive detail noise will be prone to be introduced in the glass segmentation situation, which is not conducive to the complete acquisition of large-area targets. Due to the disadvantages of vertical structure, we concatenate CUs horizontally to avoid excessive abstraction of glass information. At the same time, the amount of CUs in the transverse connection process will also affect the experimental results. Therefore, we conducted ablation experiments on the numbers of CUs to determine the optimal quantity.

Based on TableII, we can observe a positive increase in all three evaluation metrics with the increment of CU numbers. This trend underscores the significance of the WCC within our FBWC, which comprises four distinct CUs. Within each CU, boundary constraints are introduced to ensure clear partition edges. Therefore, in the process of the gradual increase of the number of CUs, the continuous strengthening of constraints and the effective transfer of accumulated shallow information lead to improved segmentation results. However, this horizontal information transfer will lead to the last CU retaining miscellaneous information without providing more effective semantic information, and lead to lower segmentation accuracy.

It can be seen from the heat map that with the increase in the number of CUs, the boundary constraints continue to strengthen, which is expressed in the Figure8as the segmentation boundary gradually becomes obvious. When the number is from 4 to 5, the boundary constraints will degenerate due to the interference of redundant information. Based on the quantitative results from the numbers 4 to 5, we prudently chose 4 as the optimal number to balance the effects of boundary constraint validity and semantic information redundancy on segmentation results.

Considering the vertical structure, in the CU, we design a trough point on the third layer for properly capturing spatial information without further deepening. To verify the appropriateness of the occurrence of trough points, trough points on different layers are designed into the ablation experiment.

As shown in TableIII, trough points on the second layer under the three datasets perform worse than the other experimental groups based on a small number of convolutions. Therefore, the advanced appearance of the trough point will cause WCC to over-capture shallow semantic information and fail to excavate the intra-class consistency features without further abstraction. By contrast, when extending and deepening trough points into the fourth layer, the segmentation performance of the model is negatively affected by multi-layer convolution to over-abstracting dispersive fine-grained features as noise. In general, faced with the glass segmentation task, an appropriate trough point can capture the commonalities among glass classes through the appropriate convolution quantity while avoiding the difficulty of feature clustering and the decrease of semantic relevance caused by excessive extraction. Similarly, the proposed CTA and FCC are also considered in the ablation experiment to verify the validity of the designed attention mechanism and Fourier enhancement for glass features.

From TableIV, we can observe the supervisory effects of BC Loss and AM Loss on the model. Specifically, when FBWC has no boundary constraints, the model’s ability to learn boundary features of the segmentation target weakens, resulting in a significant decrease in model performance. In addition, AM Loss can effectively improve the semantic feature consistency of large-scale segmentation regions in the model, thereby enhancing the coherence and naturalness of the segmentation results.

Based on TableV, we observe that the segmentation performance on all three datasets decreased without CTA to supplement the focused semantic features and maintain the integrity of semantic information in the edge constraint region. From Figure9, it can be vividly seen that CTA can effectively filter the reflected strong light noise, fully focus the semantic information in the target region and reduce the dispersion of segmentation results. In order to verify the effectiveness of transposition operation in CTA, we removed the transposition process in the Cross Transpose Attention (CTA) module and made it a Cross Attention (CA) module. From TableV, it can be seen that the comprehensive performance of the CTA module on the three datasets is better than that of CA, indicating that transposition operation can establish effective global correlations among glass semantic features and boost segmentation performance.

At the same time, we introduce the Fourier Transform on a variable branch to FCC, which is conducive to further strengthening the boundary information, increasing the boundary sensitivity of the model, and improving the segmentation accuracy. Visual results in Figure10show the importance of the FCC, which observes a sharp gradient decline of edge pixels in the conversion process of the frequency domain and spatial domain. Finally, the boundary information is integrated and strengthened to effectively divide the boundary between glass and reality. Moreover, We designed relevant ablation experiments for this, specifically replacing FFT with a standard convolution operation to obtain Standard Convolution Controller (SCC). From Table V, it can be seen that SCC performs worse than FCC in the datasets HSO, Trans10K-stuff and GDD.

In addition, in order to further verify the effectiveness of the proposed module, we conducted more in-depth ablation experiments on CTA and FCC. Specifically, on three datasets, we conducted three sets of ablation experiments with different CU numbers: FBWC without CTA, FBWC without FCC, and without both CTA and FCC. The experiment aims to further explore the effects of CTA and FCC on the segmentation accuracy of the network under different CU numbers.

It can be observed from the data shown in TableVI, under GDD dataset, the network segmentation performance of the FBWC without CTA experimental group becomes better with the increase of the number of CUs, and the best advantage occurs when the number of CUs is 4. When the number of CUs is 5, the network segmentation performance decreases to 86.39% IoU and 0.073 MAE. By horizontal contrast among TableVI, TableVII, and TableVIII, when the number of CUs is constant, the experimental group without both CTA and FCC in FBWC performs the most poorly compared with the other two groups. To be more specific, we observed that when the number of CUs was 3 in the HSO dataset, the network segmentation results without CTA and FCC are 70.69% IoU and 0.121 MAE, which are worse than the others with the same number of CUs. At the same time, under the experimental settings above mentioned, the segmentation performance results shown in TableVIand TableVIIIare lower than those shown in TableVII. This reflects the importance and effectiveness of the FCC in the FBWC.

The experimental phenomena mentioned above is also reflected among three datasets with different numbers of CUs. When the number of CUs is 4, the overall network can have better segmentation performance.

SECTION: IV-DDiscussion and Analysis

In night scenes, due to poor lighting conditions, the boundary information in the image becomes blurry, and the semantic features of large glass areas are not significant. To address this issue, the proposed FBWC could effectively segment glass regions as shown in Figure11.

For the problem of boundary blurring under low light conditions, the WCC and continuous strong boundary constraints can effectively capture boundary features while preventing the dispersion of fine-grained boundary semantic information. Meanwhile, CTA enhances the consistency of glass regions through attention mechanisms. Finally, the boundary information and coarse-grained semantic features are further highlighted and effectively integrated through FCC. Based on the above content, FBWC can effectively cope with semantic segmentation tasks of glass images in night scenes. In addition, the datasets utilized in this work contain real-world glass images under low light conditions, providing sample diversity and further enhancing the model’s generalization ability.

Similarly, when dealing with non-ideal conditions such as noise and occlusion in the glass semantic segmentation task, boundary and glass region features are easily affected by noise interference and are difficult to extract. The segmentation results of the proposed FBWC under Gaussian noise, Salt&Pepper noise, Poisson noise, ColorJitter, and Foggy noise are shown in Figure12, and the segmentation results under occlusion conditions are shown in Figure13.

In order to effectively address noise and occlusion issues, FBWC applies WCC to avoid the over-capturing of large glass areas, which is beneficial for maintaining the integrity of glass areas under occlusion, light spots, and noise interference. CTA is further designed to achieve effective segmentation of non-occluded areas. Simultaneously, through multi-level boundary loss constraints and effective boundary enhancement of FFT, the boundary information in shallow structures has been significantly optimized, further improving the anti-interference ability and robustness of FBWC.

We have indicated the parameter count for each module in Figure2. It is worth mentioning that the parameters of the whole FBWC are 48.7M and the backbone WCC we designed is 38.38M. Regarding the backbone, WCC reduces the parameters of 47.62M, 99.62M and 5.62M compared to ViT-Base[70], VGG16[71]and ResNeXt101[72], whose are used in the popular methods of glass segmentation. In addition, the parameters of the proposed FCC and SegHead are 2.37M, which does not significantly increase the parameters of the FBWC. This optimization not only reduces the computational complexity of the model but also improves the training and inference efficiency of the model. By reducing the number of parameters, WCC reduces the storage and computational burden of the model while maintaining high performance.

SECTION: VConclusion and Future Work

In this paper, high-precision glass segmentation is realized by strengthening the glass boundary and avoiding over-capturing semantic information in deep structure caused by the glass property of reflectivity and light transmission. We connect the designed CUs horizontally to appropriately capture large area semantic features with strong boundary constraints. Besides, CTA is embedded to keep the feature region consistent. The FCC is then utilized for the different features, which can be flexibly adjusted in a learnable way and integrated effectively. Extensive experimental results show that our proposed FBWC produces comprehensive SOTA performance on the three different public glass segmentation datasets. In the future, we will explore the application of shallow network architecture in more scenarios.

At the same time, we also objectively noted that the proposed method still has some limitations. When segmenting specific objects, as shown in Figure14, for buildings covered by large glass groups, the network cannot effectively explore such boundaries to achieve fine and complete segmentation. When the stained glass with decorative function is segmented, the results of the method are not ideal.

After analysis, we believe that the possible reasons are as follows: Different from conventional glass, colorful decorative glass to improve the decoration, the color fullness of the glass itself and the complexity of the pattern will be greatly increased, which leads to an increase in the difficulty of retaining the general characteristics of glass, such as transparency, reflective performance, and so on. From the perspective of semantic information, the semantic features of such glass are more difficult to distinguish from context. Furthermore, decorative colored glass with high texture and color richness poses challenges for extracting boundary information. And the proposed boundary constraint method requires the support of real data, thus placing higher demands on the quality of data annotation, and is affected by the subjectivity and accuracy of manual annotation.

Therefore, in future work, it is necessary to introduce more image data containing complex boundaries or colored glass, so that the model can better complete diverse glass image segmentation tasks. Meanwhile, we will explore semi-supervised or unsupervised learning methods to reduce reliance on high-quality annotated data.

SECTION: Acknowledgment

This research was partly supported by the Sichuan Science and Technology Program (2024NSFJQ0035), the Talents by Sichuan provincial Party Committee Organization Department, and Chengdu - Chinese Academy of Sciences Science and Technology Cooperation Fund Project (Major Scientific and Technological Innovation Projects).

SECTION: References