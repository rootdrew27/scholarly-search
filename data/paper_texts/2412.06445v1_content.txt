SECTION: Echocardiography to Cardiac MRI View Transformation for Real-Time Blind Restoration
Echocardiography is the most widely used imaging to monitor cardiac functions, serving as the first line in early detection of myocardial ischemia and infarction. However, echocardiography often suffers from several artifacts including sensor noise, lack of contrast, severe saturation, and missing myocardial segments which severely limit its usage in clinical diagnosis. In recent years, several machine learning methods have been proposed to improve echocardiography views. Yet, these methods usually address only a specific problem (e.g. denoising) and thus cannot provide a robust and reliable restoration in general. On the other hand, cardiac MRI provides a clean view of the heart without suffering such severe issues. However, due to its significantly higher cost, it is often only afforded by a few major hospitals, hence hindering its use and accessibility.
In this pilot study, we propose a novel approach to transform echocardiography into the cardiac MRI view. For this purpose,dataset, consisting of echocardiography and real cardiac MRI image pairs, is composed and will be shared publicly. A dedicated Cycle-consistent Generative Adversarial Network (Cycle-GAN) is trained to learn the transformation from echocardiography frames to cardiac MRI views.
An extensive set of qualitative evaluations shows that the proposed transformer can synthesize high-quality artifact-free synthetic cardiac MRI views from a given sequence of echocardiography frames. Medical evaluations performed by a group of cardiologists further demonstrate that synthetic MRI views are indistinguishable from their original counterparts and are preferred over their initial sequence of echocardiography frames for diagnosis inof the cases.

SECTION: 
Cardiovascular diseases are responsible for 32% of global mortality. Hence, identifying cardiovascular health issues at early stages is crucial in reducing mortality and morbidity by offering early treatment and ultimately improving the patient outcome. As an essential tool, cardiac imaging visualizes cardiac structure and its function, playing a crucial role in the early detection of cardiac disorders such as coronary artery disease (CAD).

Echocardiography is the most accessible cardiac imaging modality due to its low cost and portability. Therefore, it has been widely used even in resource-limited environments. Cost efficiency and mobility of echocardiography devices are substantially important since over three-quarters of CAD-related fatalities occur in low and middle-income countries.
However, due to its acoustic nature, echocardiography suffers from echogenicity artifacts, where undesired echoes and distortions degrade image quality. This blend of artifacts includes speckle noise, a granular pattern caused by scattering of the echoes, which results in a loss of clarity, and discontinuation of structure boundaries hindering the overall visibility. Other compound artifacts in the sensory acquisition may result in images lacking contrast and saturation within the limited acoustic window, causing certain regions of the heart to be unrecognizable as illustrated in Fig.. Since the movement of the left ventricular (LV) walls provides crucial diagnostic information such as the identification of the regional wall motion abnormalities (RWMA), it becomes challenging and even impossible for cardiologists to perform a reliable diagnosis when such compound artifacts distort the movement of the LV wall. Worst of all, some parts of the LV wall may often fall outside the captured view, making any RWMA analysis entirely infeasible.

Many approaches have been developedfor removing speckle noise in echocardiography. However, these methods are often ineffective because speckle noise is only one of many artifacts corrupting the frames while other artifacts including broader issues of obscured regions, lack of contrast, and severe saturation caused by the echoed noise still survive any denoising operation. As a result, such traditional denoising methods can provide no or minimal restoration performance for such a random blend of artifacts in a typical echocardiography. A robust and reliable restoration solution should, therefore, be “blind” and restore the input without any prior knowledge about the type and severity of the artifacts.
To effectively perform a blind restoration, we focus on innovative approaches beyond denoising by incorporating methods to reconstruct out-of-view regions and obscured parts due to, e.g., low contrast and high saturation.

Cardiovascular magnetic resonance imaging (cardiac MRI) is the gold standard for the assessment of myocardial structure and its function. Thanks to the recent advancements in acquisition speed, and temporal and spatial resolution, cardiac MRI imaging enables highly accurate diagnostic capabilities, solidifying its role as a critical tool in cardiology. However, due to the high cost of equipment and maintenance, a cardiac MRI acquisition is approximately 5.5 times more expensive for patients than echocardiography, making cardiac MRI affordable by only a few major hospitals. Accordingly, the estimated accessibility of cardiac MRI is only about 34% globally, preventing its widespread use. This disparity highlights the immediate challenge of providing equitable access to high-quality cardiac MRI and improved accessible imaging modality even in remote places, especially in developing countries.

As a remedy to the aforementioned drawbacks and limitations of current echocardiography restoration methods, this study proposes a pioneer blind restoration approach that can remove the aforementioned artifacts in typical echocardiography by synthesizing its corresponding cardiac MRI view. Therefore, the proposed approach aims to learn a one-to-one transformation from the 4-chamber echocardiography to the corresponding cardiac MRI view. Such a transformation approach naturally removes the blend of artifacts by performing a modality transformation where the source domain echocardiography is mapped to the target domain cardiac MRI, resulting in a synthetic cardiac MRI view with enhanced contrast and clarity, thus improving the quality and accuracy of diagnostic capabilities.

Fig.highlights the potential of this study illustrating the reconstructed LV wall in the transformed synthetic cardiac MRI view along with the enhanced visualization of the apex fully restored from the saturation and noise by keeping information consistent. To learn such a blind domain transformation, the proposed approach leverages Cycle-Consistent Generative Adversarial Networks (Cycle-GANs)which can perform image translation on unpaired data, while preserving the existing patterns in the source domain.

To accomplish this objective, we collected the dataset Echo2MRI consisting of apicalchamber echocardiography and cardiac MRI views of patients from Hayatabad Medical Complex in Pakistan. The multi-view dataset haspatients, of whichhave paired views.

To learn the transformation most effectively, both source (echocardiography) and target (cardiac MRI views) input data are first preprocessed and augmented to incorporate temporal information in modality transformation.

The novel contributions of this study can be summarized as follows:

This study proposes a pioneer modality transformation approach from the source domain echocardiography to the target domain cardiac MRI view.

The transformation enables a blind restoration against any random blend of artifacts typically corrupting the echocardiography.

We compose the first dataset, Echo2MRI, encapsulating paired echocardiogram and cardiac MRI views from the same patients and will make it publicly available for the research community.

An extensive set of experimental evaluations demonstrates that the proposed
transformed synthetic cardiac MRI view improves diagnosis by the cardiologist due to the superior quality and clarity achieved.

Overall, this pilot study paves the way to create the first virtual cardiac MRI machine, thus presenting a great potential for improving cardiac healthcare with significantly reduced costs.

The rest of the paper is organized as follows: Sectionpresents the proposed methodology for echocardiography restoration using modality transformation. Next, the composed Echo2MRI dataset and experimental results are detailed in Section. Finally, Sectionconcludes this study with a discussion of possible future research directions.

SECTION: 
In this section, we will first explain pre- and post-processing steps over the echocardiography frames to boost the learning performance for an accurate and reliable transformation. Then, we will detail the proposed echocardiography to cardiac MRI transformation using the Cycle-GANs.

Initially, we started by transforming each echocardiography frame independently to achieve domain translation frame sequence. However, this method is prone to process-induced artifacts, resulting in undesirable flickering effects. To mitigate these issues and enhance the output quality, we augment the input with temporal information across frames before the translation to reduce flickering and improve the reliability of the output.
Both input and output data are 3-channel images, where the channels represent consecutive time frames:,, and, represented as red, green, and blue respectively, as shown in Fig.. After the transformation, the post-processing step consists of averaging timestamps from consecutive frames. The first and last frames are used without averaging, while the second frame from the beginning and the end are formed by averaging only the two consecutive frames available. It is worth mentioning that incorporating temporal information from distinct transformation instances significantly reduces flickering, especially at the boundaries of the LV wall, and thus, ensures coherent motion across frames, leading to smoother transitions.

Cycle-GANs have two generator and discriminator networks as illustrated in Fig.. The first generator learns the forward mapping from the source domain, consisting of echo recordings, to the target domainrepresenting the corresponding cardiac MRI sequences. Specifically, given sets of preprocessed echoand MRI samples, where, and, the generator mappings are defined asand. We use the same network architectures forandgenerators as depicted in Fig.. The discriminators corresponding to the generator outputs ofandare expressed asand, respectively. These networks learn to distinguish the generated and real image samples from their corresponding target domain. The discriminator architecture used in this study is illustrated in Fig..

Given an echocardiography frame, each cycle starts with the following forward mapping:, whereis the generated cardiac MRI frame which is then fed to the discriminator,, to obtain a mask ofwhereexpresses the pixel-wise decision of the discriminator as real or synthetic. While the generated images have the same size as the source domain samples, the mask dimensions are determined by the number of down-sampling operations in the discriminators. Accordingly, both generators have 18 convolutional layers equipped with residual connections, followed by the ReLu activation function and instance normalization. On the other hand, the discriminators have 5 convolutional layers followed by the leaky ReLu. The inverse transformation completes the one-cycle by obtaining the reconstructed given input echo frame. Then, the next cycle is computed with the generatorwhere the source domain is now selected as, and an echocardiography frame is generated from the source cardiac MRI frame. The discriminatordecides whether the generated frame is real or fake. These two cycles,and, form one iteration of the back-propagation during training.

The overall loss function of the Cycle-GAN model generator consists of three components, namely, two adversarial and one cycle-consistency loss which are expressed as,, respectively:

Generator and discriminator networks are trained in such a way that they compete with each other, for example, the weights ofandare updated byandobjectives, respectively. Such adversarial training enables generating realistic MRI images that appear similar to the real MRI samples making it a challenging task for the discriminator to separate the synthesized images from the target domain samples (MRI views).

For a given set ofandsamples, the generators separately calculate the mappings for their corresponding target domain imagesand, then the following combined adversarial lossin () is computed as follows:

Next, the inverse transformations are applied to the generated images:and, and the cycle-consistency loss is expressed as,

Given,, and the sample set of, the discriminator losses are expressed forandas follows,

and the total loss. Consequently, in the training of the Cylce-GANs, the minimization ofis equivalent to maximizingȩq:gen-cost1 for the discriminators.

SECTION: 
This section first introduces the Echo2MRI dataset, encapsulating paired echocardiography and cardiac MRI data. Then, we will outline the experimental setup used to evaluate the proposed method. Following this, we will present both qualitative assessment as well as and three sets of quality evaluations performed independently by a group of expert cardiologists. These expert evaluations shall demonstrate that the proposed MRI transformation can maintain clinical relevance, reliability, and accuracy, ensuring its potential for real cardiac diagnostics. Lastly, we will present the computational complexity analysis of the proposed method.

SECTION: 
The Echo2MRI dataset was created in collaboration with Hayatabad Medical Complex in Pakistan. The data was collected anonymously with the approval of the local ethics board of Hayatabad Medical Complex, which granted authorization in February 2019.
The dataset comprises apical 4-chamber views of paired echocardiography and cardiac MRI views from 36 patients. In addition, 4 patients have only cardiac MRI data, and 12 patients have only echocardiography data.

To compose the Echo2MRI dataset, we first extracted the regions containing the apical 4-chamber view from both echocardiogram and cardiac MRI videos. To simplify the learning, we aligned the cardiac MRI videos by rotating the cropped regions to roughly match the orientation of the echocardiograms, ensuring the left ventricle (LV) is positioned towards the top-right corner. Then, we extracted the frames containing 4-chamber cardiac views from these videos.
Fig.illustrates the pre-processing steps over the cardiac MRI frames.

To ensure the best transformation quality in the cardiac MRI domain, which will naturally provide the best echocardiography restoration, we conducted a visual assessment. We selected the 16 best-quality cardiac MRI videos for the training process. Among these 16 best-quality videos, 12 have paired echocardiography and 4 have only MRI.
Pairs of selected MRI videos and an additional 12 unpaired echocardiography videos are used for training.
Overall, the training data covers echocardiography from 24 patients and cardiac MRI from 16 patients.
From these videos, training data includes 1138 high-quality cardiac MRI frames and 1193 echocardiography frames, with additional data augmentations, such as rotation.
Furthermore, we randomly flipped half of the frames to enhance diversity and achieve a more robust model.
The rest of the paired data, 24 patients, are spared for testing. Cardiac MRI and echocardiography videos have different frame rates; therefore, we spatially registered and matched the temporal movement across echocardiography and cardiac MRI frames.
In total, we used 855 echocardiography frames and 855 corresponding cardiac MRI frames for testing.
The data preparation and evaluation format will be detailed in the following subsections.

SECTION: 
We used a batch size of 1 and a learning rate 0.0002 to train the Cycle-GAN model. The model was trained for 200 epochs, with a linearly decaying learning rate to zero starting at epoch 100. We employed Adam optimizer with. The cycle-consistency loss weight,in (), was set to 10.
We used Python with the TensorFlow library.

SECTION: 
To assess the visual quality of the generated cardiac MRI views, we conducted a qualitative evaluation based on several key criteria. Using the test set, we performed echocardiography frame transformation, and compared it with its original echocardiography and time-registered cardiac MRI views as shown in Fig..

First, we check whether the generated views exhibit clear boundaries delineating the cardiac walls. Well-defined boundaries are crucial for the accurate assessment of RWMA and cardiac anatomical features by both cardiologists and machines. Especially when certain LV wall segments are out of view in the source domain echocardiography, the transformed cardiac MRI view should be able to synthesize the complete LV wall in its structural integrity.

Secondly, we check whether the generated views represent the actual cardiac motion throughout the cardiac cycle. This includes ensuring the smooth and consistent transition between systole and diastolic phases and the corresponding movement of the muscles. The consistent transformation of muscle movement’s pace indicates the models can incorporate dynamic information through temporal space. This is especially crucial for RWMA detection to diagnose any onset of myocardial ischemia and infarction (MI).

Finally, we consider the overall visual consistency and quality of the generated cardiac MRI views. This involved checking for artifacts, smoothness, and consistency of the visible arteries and other cardiac features. This is particularly important to validate that the model is not hallucinating while generating the view, but incorporating the information from the source view.

Some typical transformation results over the test set are shown in Fig.along with the source and target views. An extensive set of additional results from the test set are provided in Appendix Aand also in video format online.

Results indicate that the quality of the transformed cardiac MRI views can mostly satisfy the aforementioned criteria and usually present a similar or sometimes even better visual quality than the corresponding actual (target) cardiac MRI views. To validate this claim, we further performed a “Confusion Test” as part of the domain expert evaluation, which will be presented next.

SECTION: 
Four cardiologists perform each of the three evaluations independently, and the evaluation scores are averaged and reported in this section. The first two tests reveal crucial expert assessments of the quality and importance of the proposed echocardiography restoration by cardiac MRI view transformation. The last test demonstrates a one-to-one comparison between the transformed and actual cardiac MRI time sequences. The rest of the section details each evaluation and presents their results with important remarks.

The first question we asked cardiologists was to identify which of the shown views are synthetic. We call this first evaluation test the ”Confusion Test”. As its name implies, we aimed to assess how well a trained expert’s eye can distinguish the transformed (synthetic) cardiac MRI frame from the original counterpart. Each cardiologist were shown 200 cardiac MRI views, consisting of 100 synthetic and 100 original cardiac MRI images, and were tasked with identifying the synthetic ones. Frames are shown to the expert randomly, ensuring that each frame has a probability of 0,5 to be an original or generated view. Therefore, if the quality of the transformed cardiac MRI views matches their actual counterparts, one can expect an average accuracy ofor lower, otherwise, the accuracy can be expected to be higher than. Other standard evaluation metrics such as Precision, Recall, Specificity, F1 score, false positive rate (FPR), and Matthews correlation coefficient (MCC) are also computed for an overall quantitative evaluation. Figureshows a sample from the Confusion Test. We retrieved each assessment from the four cardiologists and presented results in a confusion matrix (CM).

True positives, (TP) are correctly classified synthetics; false positives (FP) are originals, incorrectly classified as synthetic; false negatives (FN) are synthetics, incorrectly classified as original; and finally true negatives (TN) are correctly classified originals.
From the CM, we calculate, the ratio of correctly identified samples;, the rate of correctly identified synthetics amongst all classified as synthetic;, the proportion of correctly detected synthetics, amongst all synthetics;(FPR) is the rate of false alarm in classifying synthetics.score represents the harmonic mean of precision and recall as in Eq.; and finally Matthews Correlation Coefficient (MCC) is the quality of the dependence, as expressed in Eq..

The evaluation results presented in Table II indicate that cardiologists could not accurately discriminate between synthetic and real cardiac MRI images. In particular, the accuracy ofand MCC ofdemonstrate that the cardiologists’ performance in identifying synthetic images is almost random, as accuracy close tois as trustworthy as flipping a coin and MCC close toshows no correlation in their identification. A precision of 0.45 suggests that only less than half of the synthetic images were identified as actually synthetic. A recall of 0.33 reveals that only one-third of the actual synthetic cardiac MRIs were correctly identified as synthetic, and cardiologists frequently confused synthetic images as real. Overall, such high confusion shows that the proposed approach can synthesize such synthetic cardiac MRI frames that are quite similar to the actual ones.

The second evaluation test is the ”Regional Wall Motion Abnormality (RWMA) Test”. This test aims to determine whether the transformed cardiac MRI views can capture the important temporal and structural information of the echocardiography and in particular, the LV wall motion for detecting the RWMA. Cardiologists were presented with echocardiography and corresponding synthetic cardiac MRI videos and asked to indicate which one they would prefer for RWMA diagnosis: echocardiography, synthetic cardiac MRI, or both; meaning they carry the same or similar diagnostic information. If they chose echocardiography, they were also asked if they would prefer to see its synthetic cardiac MRI alongside, for additional information.

We collected 96 evaluations from the four cardiologists over 24 test patients. One evaluation was omitted because the cardiologist omitted both views due to their low diagnostic quality.

Results in Tablereveal that the transformed cardiac MRI views can present a similar or better RWMA analysis on the majority of the cases (). Only incases, echocardiography was found superior to synthetic cardiac MRI in diagnostic quality. However, when asked if the synthetic cardiac MRI should be seen alongside the echocardiography for additional information, cardiologists responded positively inof the cases. This suggests that while cardiologists may rely on echocardiography for their primary diagnosis, a significant portion also wanted to see synthetic cardiac MRI alongside for additional information.

Cardiologists noted that three echocardiography videos exhibit missing movements, which were also unclear in their corresponding synthetic cardiac MRI translations. In particular, missing key features such as the septal wall, or displaying dyskinetic movements hinder accurate diagnosis. It is important to recognize that very low-quality echocardiography can still be challenging to restore. In such cases, synthetic cardiac MRI may carry the same diagnostic limitations as the source echocardiography.
However, it is also important to note that, echocardiography can be successfully restored through the transformation to synthetic Cardiac MRI, resulting in improved diagnostic quality, as inof the cases.

Overall, synthetic cardiac MRI is assessed to be effective and provide additional information inof the cases. This highlights the significance synthetic cardiac MRI may bring to the diagnostic process and demonstrates its potential to enhance accuracy in cardiac diagnosis, especially in detecting RWMA.

The third evaluation test is called the “Quality Test”, which aims to evaluate the video quality and relevance of synthetic cardiac MRI compared to the actual cardiac MRI. In other words, this test aims to assess the model’s ability to accurately learn the transformation domain to generate synthetic cardiac MRIs of comparable quality. In this test, cardiologists were presented with synthetic and original cardiac MRI videos and asked to evaluate the quality of the synthetic cardiac MRI compared to the original by selecting one of the following answers: Similar, Better, or Worse.

Tableindicates that cardiologists rated synthetic cardiac MRIs better than the original inof the cases. In this case, the model was able to transform the input echocardiography to its cardiac MRI domain representation, with diagnostic quality and clarity exceeding that of the original cardiac MRI. Also, inof the cases, synthetic cardiac MRI was found to be of similar quality to the original cardiac MRI. Overall, inof the total cases, synthetic cardiac MRI were found to be equal to or better than the original cardiac MRI. On the other hand,of the cases were rated worse than the original cardiac MRI.

Creating superior cardiac MRI views than their original counterparts was not the main objective of this study.
Due to the discordant movements between echocardiography and MRI, the synthetic counterpart also exhibits a lack of harmony after translation. The difference in the movements highlights the room for improvement. Further refinement is needed to address the quality gap that causes dyskinetic movements occurring in low-quality echocardiography inputs.

SECTION: 
The generatorthat translates echocardiography to cardiac MRI consists of approximatelymillion trainable parameters. The model’s inference was evaluated under two different setups. On Intel(R) Xeon(R) Gold 6230 CPU @ 2.10GHz, the average inference time per frame isseconds. However, a Tesla V100-SXM2-32GB GPU significantly reduces the average inference time toseconds. This setup enables real-time translation, exceeding the original frame rate of echocardiography at 58.82, hence, achieving cardiac MRI domain videos, with a frame rate even higher than the original cardiac MRI.

SECTION: 
This pilot study proposes a transformation-based restoration approach to restore echocardiography by transforming into a synthetic cardiac MRI view, as MRIs are considered the gold standard in cardiac imaging. The proposed method blindly restores the noisy echo without any prior knowledge about the type or severity of the corrupting artifacts. To accomplish this aim, we created the first multi-view public dataset of echocardiography and cardiac MRI with carefully designed pre- and post-processing steps.

Although RWMA is the first abnormality to set in with the onset of myocardial ischemia, preceding metabolic and electrocardiographic abnormalities, currently it is usually used as the secondary diagnostic tool in patients with non-diagnostic ECG or when the diagnosis is not evident by “standard” means. This is despite the fact that echocardiography, particularly myocardial strain imaging, provides a highly sensitive and specific, earliest diagnosis of MI by detecting an ongoing RWMA. A major reason for not using echocardiography as a first action line diagnostic tool, for suspected MI patients is the blend of artifacts which often makes it infeasible to make a reliable diagnosis by both cardiologists and prior machine learning paradigms proposed to date.

Three evaluation tests demonstrate that the transformed cardiac MRI views effectively suppressed the artifacts present in the source echocardiography in general. Even when the echocardiography has some obscured LV wall segments, the transformed cardiac MRI view was able to generate the entire LV wall, which is crucial for RWMA analysis. In brief, the delineation of the cardiac movement and anatomy is satisfactory and consistent, providing sufficient quality for an accurate diagnosis of cardiac disorders. In particular, visualizing LV wall accurately helps cardiologists and opens up space for machine learning research to improve early MI detection using echocardiography.

The confusion test revealed that the transformed cardiac MRI view is indistinguishable from the actual counterpart. RWMA test further shows that inof the cases, cardiologists prefer the transformed MRI view for RWMA detection. Finally, in the quality test, the transformed cardiac MRI quality can be equal to or even higher than the actual counterpart inof the cases.

Despite the model’s success in restoring corrupted echocardiography via transformation, it is important to note that high levels of corruption in echocardiography can still hinder the generation of realistic cardiac patterns and motion in synthetic cardiac MRI images. Future studies will focus on enhancing the model’s ability to maintain temporal coherency, further improving synthetic cardiac MRI images’ diagnostic value and reliability to converge to their actual counterparts.

SECTION: Acknowledgment
We want to thank Hayatabad Medical Complex for their contribution to collecting the dataset. Additionally, we extend our gratitude to Majid Khan, Hayatabad Medical Complex, Pakistan; Dr. Kamran Majeed (MBBS, PhD, FRACP, FCSANZ), Waikato Hospital, New Zealand; Dr. Sabir Abdul Karim (MBBS, MRCP, FRCP[Edin], FEACVI, FSCMR), Rotherham General Hospital, UK; Dr. Awad Al-Qahtani, Hamad Medical Corporation Heart Hospital, Qatar, for their valuable contribution to the qualitative evaluation.

We want to acknowledge CSC; IT Center for Science, Finland, for the computational resources.

SECTION: References
SECTION: 
SECTION: