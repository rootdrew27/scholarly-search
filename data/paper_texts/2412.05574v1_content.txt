SECTION: Rate-Distortion Optimized Skip Coding of Region Adaptive Hierarchical Transform Coefficients for MPEG G-PCC
Three-dimensional (3D) point clouds are becoming more and more popular for representing 3D objects and scenes. Due to limited network bandwidth, efficient compression of 3D point clouds is crucial. To tackle this challenge, the Moving Picture Experts Group (MPEG) is actively developing the Geometry-based Point Cloud Compression (G-PCC) standard, incorporating innovative methods to optimize compression, such as the Region-Adaptive Hierarchical Transform (RAHT) nestled within a layer-by-layer octree-tree structure. Nevertheless, a notable problem still exists in RAHT,, the proportion of zero residuals in the last few RAHT layers leads to unnecessary bitrate consumption. To address this problem, we propose an adaptive skip coding method for RAHT, which adaptively determines whether to encode the residuals of the last several layers or not, thereby improving the coding efficiency. In addition, we propose a rate-distortion cost calculation method associated with an adaptive Lagrange multiplier.
Experimental results demonstrate that the proposed method achieves average Bjøntegaard rate improvements of -3.50%, -5.56%, and -4.18% for the Luma, Cb, and Cr components, respectively, on dynamic point clouds, when compared with the state-of-the-art G-PCC reference software under the common test conditions recommended by MPEG.

SECTION: 
Athree-dimensional (3D) point cloud is composed of a large number of unordered points with 3D coordinates and their associated attributes (color, reflectance, etc.). It can be used to represent 3D shape and structure of objects and scenes, and can be extensively used in immersive communication, cultural heritage preservation, and autonomous driving, etc. However, the data volume of 3D point cloud is extremely large, leading to a great challenge of efficient storage and transmission. Therefore, 3D point cloud compression was put on the agenda.

Point cloud coding methods developed significantly in recent years, including transformation-based methods, 3D-to-2D projection methods, and deep learning-based approaches. To promote the application of 3D point clouds, the Moving Picture Experts Group (MPEG) started to establish coding standards for 3D point cloud in 2017, and proposed three test models, i.e., test model category 1 (TMC1)for static point clouds, test model category 2 (TMC2)for dynamic point clouds, and test model category 3 (TMC3)for radar point clouds. Later, as both TMC1 and TMC3 directly encode point clouds in 3D space, they are merged together and renamed as geometry-based point cloud compression (G-PCC) (the corresponding test model is named as TMC13), while TMC2 compresses 3D point clouds by converting them into 2D geometry and attribute videos and is named as video-based point cloud compression (V-PCC). Based on the requirement of immersive communication, to further improve the compression efficiency of solid (denser) and dynamic point clouds, MPEG proposed a new branch of G-PCC, namely, geometry-based solid content test model (GeS-TM), in 2023. This paper focuses on this new branch of G-PCC.

The encoding and decoding frameworks of G-PCC are illustrated in Fig.. In the encoding stage, the encoder first converts the coordinates of the input 3D point cloud to normalized coordinates that can be uniformly processed by the encoder. Subsequently, after geometry quantization and removal of redundant points, the point cloud is voxelized, and then encoded by using methods such as trisoup, octree, or predictive tree, to generate the corresponding geometry bitstream. Next, the reconstructed geometry information is used for attribute encoding in which three methods, i.e., region-adaptive hierarchical transform (RAHT), levels of detail (LoD)-based predictive transform (PT), and lifting transform (LT), can be selected. Arithmetic entropy coding is then applied to the transformed coefficients to generate the corresponding attribute bitstream. In the decoding stage, the geometry bitstream is first subjected to arithmetic decoding to obtain the reconstructed geometry. The reconstructed geometry is then transformed back through inverse coordinate conversion. Simultaneously, the reconstructed geometry and attribute bitstreams are jointly fed into the decoder for arithmetic decoding and inverse quantization. Furthermore, based on the attribute encoding methods (i.e, RAHT, PT, and LT), the decoder performs corresponding inverse transformations to reconstruct the attribute information. In this paper, we focus on RAHT which is the unique transform method in GeS-TM.

RAHT is based on 3D Haar wavelet transform with an octree structure and proceeds from the root node (the upmost layer) to the leaf nodes (the bottommost layer) of the octree. The transform generates alternating-current (AC) coefficients and direct-current (DC) coefficients. The encoder encodes AC coefficients layer by layer. To reduce temporal and spatial redundancy of AC coefficients, G-PCC introduces intra-frame and inter-frame prediction for the transformed coefficients, therefore the encoder only needs to encode the residuals between the coefficients and its predicted counterpart. However, there are a large number of near-zero AC residuals in the lower layers of the octree, leading to significant redundancy in the bitstream. To further improve encoding efficiency, we propose a skip coding method for the residuals of RAHT by using Rate-Distortion (RD) Optimization (RDO) to adaptively determine whether to encode the residuals of each layer or not. Additionally, we also introduce a new rate-distortion cost calculation method associated with an adaptive Lagrange multiplier.

The rest of the paper is organized as follows. In Section II, we briefly review related work. In Section III, we describe the technical details of the proposed method. Experimental results and conclusions are given in Sections IV and V, respectively.

SECTION: 
Research on point cloud compression has made notable progress in recent years, accompanied by ongoing enhancements and optimizations in G-PCC standard. Queirozproposed region-adaptive hierarchical transform inwhich was adopted by G-PCC as a transform coding method for dense point clouds. RAHT relies on a pre-partitioned octree structure, where each non-empty voxel block (namely a transform block hereafter) contains 2×2×2 sub-blocks (namely sub-blocks hereafter). Within each transform block, RAHT uses a Haar wavelet transform in the X, Y, and Z directions, respectively. The specific transformation formulas for the Haar transform of 2 sub-blocks are as follows:

where,,represent the sum of attributes within the two transform sub-blocks,represent the number of points within the two transform sub-blocks. For each transform block with 8 sub-blocks, we can obtain one DC coefficient and seven AC coefficients. The process of RAHT is illustrated in Fig..

In the current G-PCC, the transform starts from the root node and proceeds from top to bottom. Except for the bottommost leaf nodes, the nodes in a layer can be regarded as a transform block, which contains 2×2×2 sub-blocks. Each sub-block in the current layer corresponds to the transform block of the next layer. Blocks within the same layer are transformed according to the ascending order of their block coordinates in Morton code until all 8 sub-blocks are traversed, as shown in Fig.(a) and (b). The overall transform procedure within a transform block contains 2×2×2 sub-blocks can be simplified to a matrix operation

whererepresent the sum of attributes within each sub-block,represent the number of points within each sub-block, andrepresents the simplified transform matrix of the transform block,represent the transformed coefficients, as shown in Fig.(c). During the encoding procedure, only the DC coefficient of the root node is encoded, while the DC coefficients of the other transform blocks are ignored as they can be derived from the upper layer. Therefore, only-1 transformed AC coefficients are encoded for the transform block.

Beyond that, recent research on RAHT has achieved significant progress. By exploring the spatial correlation of RAHT coefficients, Lasserreproposed an up-sampling-based RAHT predictive encoding method, i.e., using the attributes of the parent node and the parent neighboring node to predict the attribute of the current node. However, when there is a significant attribute variation between neighbor nodes and the current node, up-sampling-based prediction may result in significant prediction residuals. To address this problem, Zhangproposed a threshold-based up-sampling prediction improvement in. Wangproposed to use co-plane or co-line peer neighbor attributes from sub-blocks at the same layer during the up-sampling prediction process instead of directly using the attributes of the parent neighboring nodes, to further improve prediction accuracy. To further reduce temporal redundancy of dynamic multi-frame point clouds, Xuproposed an inter-frame predictive method for RAHT transform coefficients. In this method, the corresponding node of the current node is found in the reference frame, and the attribute of this corresponding node are used to predict the attribute of the current node. When intra-frame prediction and inter-frame prediction are introduced in the RAHT algorithm, the predicted attributes are first subjected to RAHT transform to obtain the corresponding, the original transform coefficientsare subtracted from the predicted transform coefficients, resulting in coefficient residuals. These residuals are then quantized and subjected to RD optimized quantization (RDOQ)followed by entropy coding.

In lossy compression, RDO plays a pivotal role to improve the compression efficiency. It is also commonly used as an indispensable technique in V-PCCand G-PCCreference softwares. In RAHT, to better compare the performance of intra-frame prediction and inter-frame prediction, Zhangproposed an RDO-based prediction mode selection method to encode the transformed coefficients of a RAHT layer, which further improves the accuracy of RAHT coefficient prediction. To enhance the accuracy of inter-frame prediction, Ma. proposed a multi-reference frame prediction scheme based on RDO selection. They adaptively select K reference frames for the current frame. These reference frames are then used to perform weighted inter-frame prediction of the RAHT coefficients for the current frame. Xuintroduced a weighted average prediction between intra-frame and inter-frame predictions, and employed RDO to adaptively select the optimal prediction mode from inter-frame prediction, intra-frame prediction, and average prediction.

SECTION: 
SECTION: 
When conducting RAHT from top to bottom, the number of transform blocks gradually increases with the depth of layers, leading to an increasing number of AC coefficients that need to be encoded. Taking the point cloud “” as an example, Tablesummarizes the total number of AC coefficients that need to be encoded for each layer. Herein, layer 0 represents the root node. From the table, it is evident that, for all bitrate configurations (r01, r02, r03, r04, r05, r06, from low bitrate to high bitrate), the number of coefficients in deep layers occupy the majority of the total coefficients. Additionally, as the layers deepen, a large transform block is progressively divided into several small blocks by the octree structure, and the attributes in a large block are allocated to the small blocks, resulting in a gradual decrease of attributes within the small blocks. This, in turn, leads to a decrease of AC coefficients after RAHT of the small blocks. After the prediction and quantization, in the last few layers near the leaf nodes, the proportion of zero residuals exceeds 95%. Fig.illustrates the variations of zero values in each layer of the dense point cloud “” and the sparse point cloud “”. We can see that both dense and sparse point clouds exhibit the aforementioned trend. Particularly, for bitrates, i.e., r01 and r02, the proportion of zero values in the last two layers of Luma components and the last four layers of Chroma components exceeds 99%. This suggests that the proportion of zero values within a layer at low bitrates is larger than that at high bitrates, and the proportion of zero values in the last few layers of Chroma components is also higher than that in Luma component. Therefore, encoding a significant amount of residuals of so many zero values in the last few layers leads to unnecessary waste of bitrate.

SECTION: 
To reduce the bit rate waste of the last few layers in RAHT, we propose an adaptive skip coding method for the transformed coefficients by using RDO. As the proportion of zero residuals in the last several layers is large, we first estimate the attribute bitrates of skipping all AC residuals of the last one, the last two, the last three, and the last four layers, and calculate the corresponding distortion, thus calculate the RD cost of the four cases, respectively. Then, we estimate the attribute bitrate for encoding all the AC residuals and also calculate the corresponding distortion to obtain the corresponding RD cost. Subsequently, the RD costs of the five cases are compared, and the case which gives the minimum RD cost is selected and indicated in the bit stream for the decoder. Besides, the skip coding method is independently applied to Luma, Cb, and Cr color components.

From Parseval’s theorem, the distortion in the transform domain is equal to that in the attribute domain. Therefore, to save computational complexity, distortion is calculated directly in the transform domain to avoid the additional computational complexity induced by inverse RAHT transform. For the reconstructed point cloud obtained by encoding all residuals, the distortion can be calculated as

whererepresents the-th AC coefficient,represents the reconstructed-th AC coefficient,is the-th predicted AC coefficient,is the-th quantized AC residual,denotes the quantization step size, andis the total number of AC coefficients. When all residuals of the last,, layers are skipped, all residuals of the AC coefficients in the lastlayers are ignored during encoding, they are reconstructed as zero in the decoder. Therefore, these reconstructed AC coefficients are replaced by their predicted values, and their distortion can be calculated by. Therefore, the distortion in this case, denoted ascan be represented as

whererepresents the number of AC coefficients in the lastlayers of RAHT.

Due to the fact that most of the residuals after RAHT are zero, zero-run length codingis employed in G-PCC to encode non-zero residuals and run lengths of consecutive zeros. In practical implementation, three flags, i.e.,,, andare used for non-zero residuals to distinguish negative values, 1, or 2. The remaining values are encoded using an exponential golomb encoder. For run length of consecutive zeros, truncated unary coding combined with exponential golomb encoder is used. The bitrate can be estimated by the cumulative number of bits required for encoding. For truncated unary coding, the bitrate can be estimated by the length of the codeword. For exponential golomb coding, the number of bits can be estimated by the probability of the remaining values, which is updated in real time. The procedure of encoding and bitrate estimation of quantized coefficient’ residuals are illustrated in Fig.. In the proposed method, we useto denote the attribute bits when all residuals are encoded andto represent the attribute bits (including the flags) when all AC residuals of the last,layers are skipped. Therefore, the RD cost can be calculated by

whererepresents the distortion (resp.),represents the bits (resp.), andis the Lagrange multiplier which follows the basic style of H.266/VVC, i.e.,

whereis a content dependent constant andis the quantization parameter.

In our study, we did extensive statistical experiments to obtain. First, we implemented the proposed method onto the latest software platform GeS-TM v4.0and encoded some typical test point clouds “”, “” in the dynamic point cloud category Cat2-A, “” in the dynamic point cloud category Cat2-B, and “” in the dynamic point cloud category Cat2-C provided by MPEG to evaluate the coding performance with respect to. During the experiment,ranges from 0.05 to 0.5 with an incremental step size of 0.01. To find the optimal, we use the End-to-End BD‑Attribute Rate (BDBR)to quantitatively represents the attribute bitrate savings at the same distortion when comparing the proposed method with GeS-TM v4.0. A negative BDBR indicates a positive gain compared to G-PCC, whereas a positive BDBR indicates a negative gain. We tested all the bitrates (from the lowest bitrate to the highest bitrate) by following the common test condition (CTC)of Ges-TM, and presented the average performance. By taking all the color components into account, we also defineto represent the sum of BDBRs for Luma and Chroma components,

where,andrepresent the BDBR of Luma, Cb, and Cr components, respectively, compared to GeS-TM v4.0. The parameterequals to 7 because the importance of Luma is roughly 7 times greater than that of Chroma. The statistical results are given in Table, and the variation of averagewith respect tois shown in Fig.. Finally, we can conclude from Tableand Fig.that the optimalcan be set as 0.26.

SECTION: 
By using the optimal, we can compare theof skipping the residuals of the last,, layers with theof normally encoding all the coefficients by using () and (), and pre-set a flag to indicate the best case for the decoder. Ifis smaller than all, we set the flag to be. In this case, the encoder will encode all RAHT residuals as their original values. Ifis smaller than, we find the smallest,, and set the flag asto skip the residuals of the lastlayers of RAHT.

The decoder first extracts the flag from the attribute bitstream. If the flag is, the residuals are decoded normally. If the flag is not zero, the decoder will deem all the residuals of the lastlayers of RAHT as zero. Subsequently, following the original G-PCC decoding process, the decoded residuals are inversely quantized to obtain. If intra-frame or inter-frame prediction was performed at the encoder side, the obtainedis added to the predicted coefficientsto obtain the reconstructed coefficients. Finally, inverse RAHT is applied to obtain the reconstructed attributes. The encoding and decoding framework for the proposed method can be illustrated in Fig.. Moreover, as there are three color components, we perform the proposed method for the three color components independently and use three flags, namely,, and, to indicate how to decode the residuals, respectively.

SECTION: 
To verify the effectiveness of the proposed method, we implemented the proposed method in the latest test model of G-PCC reference software GeS-TMv4.0. This test model is especially for dynamic object point clouds (categorized as Category 2, i.e., Cat2 in MPEG) which are further divided into Cat2-A, Cat2-B, and Cat2-C based on their content complexity.

The experiments were conducted according to the CTCof the testing model. Octree encoding is used for geometry, while RAHT is used for attribute encoding. We tested two conditions: lossless geometry lossy attributes (defined as C1 condition) and lossy geometry lossy attributes (defined as C2 condition), by following the CTC. When using GeS-TM for dynamic point cloud compression, inter-frame prediction was also enabled, namely “”. We also conducted the experiment when inter-frame prediction was disabled under the C1 and C2 condition, namely “” for extensive comparison and analyses. The hardware platform was an Intel I7-8700K CPU with 16GB of memory, and the software platform was the Windows 10 operating system.

SECTION: 
In the field of 3D point cloud compression standardization, Bits Per Output Point (BPOP) is usually adopted to measure the average bitrate required for each point. For the same reconstruction quality, a lower BPOP indicates higher encoding efficiency. The reconstruction quality of a point cloud is usually measured by Peak Signal-to-Noise Ratio (PSNR), where a higher PSNR indicates higher reconstruction quality. In the CTC, each point cloud is first encoded at 6 different quantization parameters, resulting in 6 bitrates (i.e., r01, r02, r03, r04, r05, and r06) and PSNRs. Then, Bjøntegaard rate (BD-rate, in percentage) can be calculated to quantitatively evaluate the RD performance. A negative BD-rate denotes a decrease in BPOP at the same reconstruction quality, indicating better encoding efficiency.

Tableshows the performance of dynamic point clouds of the proposed method compared to GeS-TMv4.0 under the C1 and C2 conditions, where End-to-End BD-AttrRate (%) denotes the change in attribute BPOP at the same reconstruction quality. Tablegives the results when attribute inter-frame prediction is disabled and only intra-frame prediction is used under the C1 and C2 conditions.

From Table, we can see that the RD performance gain of C2 condition is larger than that of C1 condition. This is because the number of points under the lossless geometry compression of C1 condition leads to larger total coding bits, and therefore, the ratio of saved bits by the proposed method is not so significant. Besides, in C1 condition, the values of AC residuals in the last few RAHT layers are also large, leading to more reconstructed distortion and PSNR loss if they are skipped. Specifically, at C1 condition, the average BD-rates for Luma, Cb, and Cr components achieves -0.46%, -1.49%, and -0.68%, respectively, while at C2 condition, the corresponding average BD-rates are -3.50%, -5.56%, and -4.18%, respectively. It is noteworthy that the average BD-rates of the three color components achieve -14.35%, -20.68%, and -18.15%, respectively, for “”. This is because “” is a computer-generated imagery (CGI) sequence, which has stronger inter-frame correlation compared to regular sequences, making the color attributes much easier to be predicted within the RAHT. Therefore, when inter-frame prediction is enabled, a larger proportion of the quantized AC coefficient’ residuals are zero values. Accordingly, using the proposed method achieves for significant bitrate savings. From Table, we can also get the conclusion that the RD performance gain of C2 condition is larger than that of C1 condition.

By comparing Tablewith Table, we can observe that the proposed method achieves better performance when inter-frame prediction is enabled. This is because, when we skipped the residuals in the last few layers,is directly used to representon the decoder side. The accuracy of inter-prediction is typically better than intra-prediction, resulting in higher PSNR and RD performance.

SECTION: 
To analyze the reconstruction quality of point clouds at different bitrates, we conducted an analysis on the dynamic point cloud “”, “”, “” in Cat2-A category, “” in Cat2-B category, and “” in Cat2-C category under the “” condition. Fig.depicts the RD curves of the proposed method and G-PCC, in which the weighted average (7:1:1) of PSNR for Luma, Cb, and Cr components is used. We can see that the proposed method exhibits better performance at lower bitrates. This is because lower bitrates entail a larger quantization step, leading to a substantial number of zero values in the last few layers of AC residuals in RAHT. Therefore, significant bit rate saving and minimal PSNR loss can be achieved by the proposed method. At high bit rates, as the significant distortion leads to a high RD cost, the proposed method is hard to be selected by RDO.

SECTION: 
Due to the difficulty of visualizing dynamic point cloud sequences, we randomly selected certain snapshots from the dynamic point cloud sequences. By comparing the subjective quality of these snapshots, we aim to approximately evaluate the performance of our method. Fig.shows some snapshots of the point clouds reconstructed by the proposed method and GesTMv4.0. Specifically, we selected the point cloud “”, “”, “” and “” for illustration, as shown in Fig.(a), (b), (c), and (d). We can see that the proposed method can achieve similar subject quality by consuming much smaller bit rates. For instance, under the C2, r02 condition, the point cloud “” was reconstructed by GPCC (GeS-TMv4.0) with a color BPOP of 27.6, whereas our method only required 4.7color BPOP. We saved 82% of the bitrate while achieving almost the same subjective visual quality. Besides, the proposed method can also eliminates block artifacts effectively and thus producing smoother visual appearance compared with GeS-TMv4.0. This is because the residuals in the last few layers are skipped and the AC prediction is directly used as the reconstruction, resulting in more smooth reconstruction quality.

cells = c,
cell11 = c=2,
cell13 = c=2,
cell15 = c=2,
cell17 = c=2,
cell19 = c=2,
cell21 = c=2,
cell31 = r=4,
cell81 = r=2,
cell101 = c=2,
vline3,5,7,9 = 1-13,
hline1,3,11 = -,&cat2-A  8ivfbv2_loot_vox10  136.10%  101.38%  165.43%  100.43%  112.57%  100.33%  119.25%  100.73%8ivfbv2_redandblack_vox10  134.04%  100.02%  165.05%  100.92%  112.53%  100.81%  119.08%  99.66%8ivfbv2_soldier_vox10  140.66%  99.73%  165.55%  100.57%  114.62%  100.37%  119.36%  100.26%queen  142.51%  100.10%  165.68%  101.19%  113.86%  100.78%  118.50%  100.94%cat2-B  8ivfbv2_longdress_vox10  133.13%  99.56%  165.76%  100.47%  112.20%  100.42%  119.60%  100.84%cat2-C  basketball_player_vox11  127.36%  99.93%  165.51%  100.25%  108.39%  100.28%  115.02%  101.52%dancer_player_vox11  129.62%  99.57%  166.33%  100.32%  109.68%  101.56%  115.31%  100.43%Overall average   134.87%  100.04%  165.62%  100.59%  112.34%  100.59%  113.17%  100.10%

SECTION: 
For multi-frame dynamic point clouds, the average encoding and decoding complexityis formulated according to:

whereandrepresent the average encoding/decoding time of the proposed method and anchor (i.e., G-PCC), respectively. Tableshows the compares time complexity of the proposed method with GeS-TMv4.0 under the C1 and C2 conditions, respectively. Compared to the GeS-TMv4.0, there is a certain increase in encoding time for the proposed method, however, the decoding time remains more or less the same. We can also see that the encoding time increase of the proposed method under C1 condition is greater than that under C2 condition. This is because, during RDO, distortion and bitrate are calculated block by block. As the number of blocks is quite large in lossless geometry conditions (C1 condition), leading to higher time complexity. Additionally, the increase of encoding time under inter-frame coding configuration is less than that under intra-frame coding configuration, as inter-frame prediction results in smaller AC coefficients’ residuals (i.e., more zero residuals), making faster distortion and bitrate estimation. Furthermore, when inter-frame prediction is enabled, the proposed method is used more frequently, reducing more time complexity of attribute reconstruction at the encoder side. We also observe a slight decrease in decoding complexity for certain point clouds. This is because the proposed method does not need to decode the residuals in the lastlayers.

SECTION: 
We proposed a skip coding method for RAHT coefficients by adaptively determining whether to encode the residuals in the last() layers. Specifically, we proposed a comprehensive RD framework including bitrate calculation, distortion estimation, and skip coding condition for the coefficients’ residuals to guarantee the RD performance. Additionally, we present an experimental method for determining the Lagrange multiplier. Experimental results demonstrate that the proposed method achieves significant improvements in encoding efficiency compared with the CTC (recommended by MPEG) of state-of-the-art G-PCC reference software (GeS-TMv4.0), especially at low bitrates. Specifically, the average BD-rates for the Luma, Cb, and Cr channels achieve -3.50%, -5.56%, and -4.18%, respectively, under the configuration of lossy geometry and lossy attribute compression for inter-frame compression of dynamic point clouds. Moreover, the proposed method does not induce additional decoding complexity, which is friendly for practical applications. In the future, we will keep developing optimization technologies for MPEG G-PCC to further improve its coding efficiency at affordable complexity consumption.

SECTION: References