SECTION: Deep Learning-Enabled ISAC-OTFS Pre-equalization Design for Aerial-Terrestrial Networks

Orthogonal time frequency space (OTFS) modulation has been viewed as a promising technique for integrated sensing and communication (ISAC) systems and aerial-terrestrial networks, due to its delay-Doppler domain transmission property and strong Doppler-resistance capability. However, it also suffers from high processing complexity at the receiver. In this work, we propose a novel pre-equalization based ISAC-OTFS transmission framework, where the terrestrial base station (BS) executes pre-equalization based on its estimated channel state information (CSI). In particular, the mean square error of OTFS symbol demodulation and Cramér-Rao lower bound of sensing parameter estimation are derived, and their weighted sum is utilized as the metric for optimizing the pre-equalization matrix. To address the formulated problem while taking the time-varying CSI into consideration, a deep learning enabled channel prediction-based pre-equalization framework is proposed, where a parameter-level channel prediction module is utilized to decouple OTFS channel parameters, and a low-dimensional prediction network is leveraged to correct outdated CSI. A CSI processing module is then used to initialize the input of the pre-equalization module. Finally, a residual-structured deep neural network is cascaded to execute pre-equalization. Simulation results show that under the proposed framework, the demodulation complexity at the receiver as well as the pilot overhead for channel estimation, are significantly reduced, while the symbol detection performance approaches those of conventional minimum mean square error equalization and perfect CSI.

SECTION: IIntroduction

As the key technology extending coverage and promoting ubiquitous connectivity, the aerial-terrestrial network has garnered widespread attention in recent years[1,2,3]. The operation of the aerial-terrestrial network depends on exceptional wireless communication and sensing capabilities, which enable data transmission, trajectory tracking, and intrusion detection[4], etc. However, the limited spectrum resources make achieving great connections and sensing in the aerial-terrestrial network challenging, necessitating higher spectral efficiency techniques to meet this demand. The integrated sensing and communications (ISAC)
technology is regarded as a promising candidate[5,6,7]. ISAC technology utilizes a unified waveform to simultaneously achieve communication and sensing functions. That is to say, the waveform transmitted by the transmitter can be used for deliver data symbols to the communication receiver, while also being used for sensing parameter estimation at the sensing receiver. This unified approach shares hardware resources, spectrum resources, and signal processing algorithms, leading to benefits such as improved spectrum and energy efficiency, and reduced hardware costs. It should be noted that the contradiction between the communication signal and the sensing signal poses challenges in the ISAC waveform design[8]. Therefore, the ISAC waveform needs to achieve a balance between communication and sensing performance.

Note that the aerial-terrestrial integrated network can involve the high-mobility scenarios. In such cases, the wireless channels may transition from stable to highly dynamic, or from time-invariant channel to fast time-variant channel, degrading communication and sensing performance[9]. For example, the performance of ISAC systems using multi-carrier waveforms (e.g., orthogonal frequency division multiplexing) can be severely degraded by inter-carrier interference[10]. Hence, how to achieve efficient communication and precise sensing under high mobility has emerged as a critical challenge for aerial-terrestrial ISAC networks.

Among the possible candidates, orthogonal time frequency space (OTFS) exhibits high reliability compared to other commonly used waveforms[11]. Specifically, in OTFS modulation, the communication channel parameters and sensing parameters are of the same form, making it more suitable as an ISAC waveform. Hence, it received attention from researchers in recent years[12,13,14]. For example, in[15], an OTFS-based ISAC system was proposed, allowing for highly accurate range-velocity profiles without requiring large bandwidth transmissions or long-duration frames. The authors in[16]addressed the challenge of precisely estimating of user state information alongside reliable data transmission in high-mobility environments. The authors in[17]presented a deep learning-based algorithm for target detection using ISAC-OTFS waveforms, where this approach eliminates the need for pre-computing any statistical parameters. Given that ISAC systems typically has to sense of environmental parameters to perform specific tasks, some studies are shifting their focus from mere target detection to parameter estimation. For example, in[18], the authors minimized the bit error rate (BER) of the OTFS-based ISAC system while ensuring accurate sensing parameter estimation. The authors in[19]proposed a generalized likelihood ratio test (GLRT) based multi-target detection and delay-Doppler-angle estimation algorithm for multiple-input-multiple-output OTFS radar sensing. Based on this, the trade-off between sensing SNR and communication rate was achieved by jointly optimizing the spatial and delay-Doppler (DD)-domain waveforms. Note that the aforementioned works all assumed channel state information (CSI) is perfect; however, in practical applications, due to the high mobility of the aerial node, the AP may only be able to obtain outdated CSI, which will definitely degrade the communication performance.

To address the above issue, some works have been done to refine CSI for OTFS communication systems. Specifically, the authors in[20]used the sensing echoes to assist in beam alignment and beam tracking, where Kalman filtering was employed to predict the angle-domain information for updating beamforming strategies. A convolutional long-short term memory recurrent neural network (CLRNet) was then proposed in[21]by introducing convolutional neural network modules for spatial feature extraction and long short-term memory (LSTM) modules for capturing temporal dependencies. In[22], based on deep learning, the roadside unit utilized vehicle angular parameters obtained from sensing echoes to predict beam directions for the next time instant, thereby achieving precise beam pairing with minimal latency. These works focused on channel prediction in the spatial domain, while there have been little works studying methods to obtain the delay and Doppler shift information of OTFS. The authors in[23]reconstructed the topology between communication nodes using the estimated sensing parameters of communication targets. Based on kinematic formulas, the reconstructed topology was then adopted to assist in predicting the complete channel, including delay and Doppler shift, without requiring channel estimation. In addition to leveraging topology relationships, the work in[24]capitalized on past channel information across multiple time slots to forecast the future communication precoding matrix, thereby minimizing the frame error rate and achieving ultra-reliable low latency communications. Note that the literature discussed above[20,21,22,23,24]primarily concentrates on enhancing communication performance, but the sensing aspect was not addressed. Additionally, these works focused on the beamforming or precoding design and such algorithms may not be suitable for the aerial receivers (e.g., unmanned aerial vehicle (UAV)) with limited signal processing capabilities. This is because the complex OTFS channel estimation and equalization algorithms still need to be designed at the aerial receiver, which leads to increased signal processing delays at the aerial receiver. In sum, under the outdated CSI scenario, the investigation of the OTFS waveforms to balance the performance between communication and sensing while ensuring low processing complexity at the UAV side still needs to be addressed.

In this work, we explore the ISAC transmission framework for an OTFS-based aerial-terrestrial ISAC network. By taking into account the impact of channel outdatedness caused by high mobility and the limitations of communication signal processing capabilities at the UAV, a channel prediction-based pre-equalization (CPBPE) framework for ISAC waveforms is proposed to achieve a trade-off between communication and sensing performance. The main contributions of this paper are as follows:

For the aerial-terrestrial network with one terrestrial access point (AP), one UAV UE, and multiple scatters, an ISAC transmission framework based on OTFS waveform is developed, which includes a pre-equalization module to reduce the complexity at the UE side. Under this transmission framework, the mean square error (MSE) of OTFS data symbols and the Cramér-Rao lower bound (CRLB) of sensing parameter estimation are analyzed. Based on this, we formulate a weighted MSE and CRLB optimization problem under the transmission power constraint to balance the communication and sensing performance.

Since the original optimization problem is difficult to solve directly, and it also faces the issue of outdated CSI, by leveraging deep learning, we come up with a CPBPE framework. Specifically, the CPBPE framework includes a parameter-level channel prediction module with a low-dimensional input space, which directly corrects outdated CSI by utilizing the decoupled OTFS channel parameters, a CSI processing module used for the post-processing of the parameter-level channel data, and a residual-structured deep neural network (DNN)-based module for the pre-equalization design that considers both communication and sensing performance.

Simulation results show that the proposed framework effectively enhances communication and sensing performance compared to pre-equalization design using outdated CSI and can approximate the performance achieved with true CSI. This indicates the robustness of the proposed framework for pre-equalization in high-mobility scenarios. Furthermore, we examine the processing complexity at the UAV, which has been greatly reduced.

The remainder of this paper is organized as follows. SectionIIpresents the system model, including the pre-equalization framework for ISAC signals. SectionIIIanalyzes the performance metrics of the proposed transmission framework and then formulates the optimization problem, considering the weighted communication and sensing performance. The CPBPE framework, including the channel prediction module, CSI processing module, and pre-equalization design module, is elaborated in SectionIV. In SectionV, numerical results are discussed to evaluate the communication and sensing performance of the proposed algorithms under different parameter settings. Finally, the paper is concluded in SectionVI.

This paper adopts the following notations. A boldface capital letter, a boldface lowercase letter, and a calligraphy letter are used to denote a vector, a matrix, and a set, respectively.denotes theidentity matrix. The transpose and Hermitian transpose are denoted byand, respectively.denotes the Kronecker product.represents converting a matrixto a vector column by column.represents taking the average ofwithas the variable.denotes a diagonal matrix.represents the discrete Fourier transformation matrix of size.denotes the 2-norm of its argument.

SECTION: IISystem Model

We consider an ISAC-enabled aerial-terrestrial network under the high-mobility communication scenario, which consists of one AP, one UAV UE, and several scatters, as shown in Fig.1. Therein, the AP communicates with the UE while sensing it. In this work, the OTFS waveform is employed for communication and sensing. Similar to[25,26,27], both the AP and UEs are assumed to be equipped with a single antenna.

SECTION: II-AISAC Pre-equalization Framework

To reduce spectrum resource occupancy and signal processing complexity of UE, we come up with an OTFS-based ISAC pre-equalization framework. As the name suggests, pre-equalization is a scheme that mitigates the impact of the channel at the AP in advance, thereby avoiding the complex channel estimation and equalization at the UE. Specifically, the comparison between the block diagrams of our ISAC pre-equalization framework and conventional OTFS system is illustrated in Fig.2. Different from the conventional scheme, the OTFS modulated signalis firstly pre-equalized by the pre-equalization matrixat AP and then transmitted to UE, which directly performs symbol detection without channel estimation and channel equalization. In the meantime, the AP senses the UE based on the received echo signals. This means a a unified waveform is required to simultaneously fulfill both communication and sensing functions. In this work, we primarily focus on pre-equalization design at AP to accommodate both communication and sensing. The following design principles are taken into account during pre-equalization design:

There is a contradiction between the randomness of the communication signal and the determinism of the sensing signal. Therefore, pre-equalization design needs to achieve a trade-off between communication and sensing performance under a specific requirement, thus improving the spectrum resource utilization.

Note that waveform design generally requires the instantaneous CSI and sensing parameters, but in practical applications, often only outdated CSI and sensing parameters are available. Therefore, it is essential to design an algorithm that accounts for outdated CSI and sensing parameters to minimize the impact of pre-equalization design inaccuracies on communication and sensing performance.

SECTION: II-BSensing Model

Letdenote the original OTFS modulated symbol in the DD domain. Therein, the modulated information symbols inare assumed to be independent and identically distributed (i.i.d.) with unit power. Then, multiplywith the pre-equalization matrixmentioned inII-A, the vector form of ISAC signal symbol in DD domaincan be obtained, i.e.,

Based on the principle of OTFS modulation, the signal vector at the-th time slot in time-delay (TD) domaincan be obtained by performing the inverse symplectic finite Fourier transform (ISFFT) and inverse discrete Fourier transform (IDFT) to. Mathematically,can be expressed as

The received sensing signal vectorat the AP in the TD domain is written as

whereis the additive white Gaussian noise (AWGN) vector at the AP,denotes the TD domain equivalent sensing channel in time slot, respectively. According to[28,29], the sensing channel is given by

whereis the total number of sensing paths,is the channel attenuation at the-th path.andare the delay tap and Doppler tap of the-th path, respectively. Their relationship with the real delayand Doppler shiftcan be expressed as, respectively,
whereis the distance between the AP and the target,is the carrier frequency,is the radial velocity of the target relative to the AP,is the number of delay grids, andis the number of Doppler shift grids,,,is the subcarrier spacing, andis the time slot duration. In (4),characterizes as the Doppler influence, where.

where, and

wheredenotes the length of the cyclic prefix. The-th element ofis

By performing Fourier transformation and symplectic finite Fourier transformation to the TD-domain received sensing signal, we have the DD-domain received sensing signalat the-th time slot as

whereis the DD-domain AWGN vector with powerat the AP, andis the DD-domain equivalent sensing channel in the-th time slot, which can be expressed as

SECTION: II-CCommunication Model

The TD-domain received communication signal at UE is

whereis the i.i.d AWGN vector at the UE,denotes the communication channel in TD domain, expressed as

whereis the total number of communication paths.,, andare the channel attenuation, delay tap, and Doppler tap of the-th path at the-th time slot, respectively. Similarly, by performing Fourier transformation and symplectic finite Fourier transformation to the TD-domain received signal, we have the DD-domain received communication signalat the-th time slot expressed as

whereis the communication channel in the DD domain, which can be expressed as

andis the i.i.d AWGN vector with powerin DD domain at UE.

SECTION: IIIProblem Formulation

In this section, we first analyze the performance metrics of interest, i.e., the CRLB of the sensing parameters (the real part and imaginary part of the channel attenuation, Doppler shift, and delay) and the MSE of the demodulated symbols. Based on the analysis, a multi-objective optimization problem is formulated to investigate the trade-off between sensing and communication performance via pre-equalization design.

SECTION: III-APerformance Metrics

CRLB is defined as the MSE lower bound of the unbiased estimate for the sensing parameters, i.e.,

whereis the sensing parameter set to be estimated, andis the estimated value of. In this work, the sensing parameters of interest include,, Doppler shift, and delay; hence,is expressed as

According to[30], the CRLB can be derived as the inverse of the Fisher Information Matrix (FIM), i.e.,

whereis expressed as

The elementof (21) is

whereandrepresent the-th and-th element of, respectively,is the covariance matrix of, andrepresents the channel matrix of the-th sensing path. For natation simplicity,will be denoted asby omitting the superscriptand subscriptsand, i.e.,

whose-th element is denoted as

The derivation ofin (22) w.r.t,,, andcan be then calculated as (26), (27), (28), and (III-A1), where.

To further simplify the expression of the CRLB, we rewritein (22) as

where the step (a) leverages the i.i.d. property of AWGN, with its covariance matrix represented as. The derivation of step (b) makes use of the circular nature of matrix trace. The derivation of step (c) is based on the assumption that the modulated information symbols inare i.i.d. with unit power.

Combing (25) with (21) and then substituting back to (20), we can obtain the CRLB of.

Most of the previous works on ISAC waveform optimization adopted SINR-based metrics for evaluating communication performance, such as the sum rate. However, these metrics are unsuitable for the proposed pre-equalization framework. This is because, although such metrics can achieve optimal reception from the power perspective, they do not account for the constellation angle distortion under the direct symbol demodulation scheme employed at the UE. Therefore, in this paper, a more suitable metric, namely, MSE of communication symbols, is adopted to evaluate communication performance.

MSE of communication symbols is defined as the mean squared error between the DD-domain received communication signaland the modulated information symbol vector. Mathematically, it is expressed by

whereis the power normalization factor used to normalize the power of the received communication signalto the power of the modulated information symbol vector.

SECTION: III-BOptimization Problem Formulation

To achieve a trade-off between communication and sensing performance, we consider using the weighted sum of the two metrics as the optimization objective. By properly setting the weights of communication and sensing performance, pre-equalization design can be tailored to meet various communication and sensing requirements. Specifically, the pre-equalization design problem can be formulated as

whereis the weighting factor of communication performance,is the weighting factor of sensing communication, andis the maximum transmission power, which is limited by the hardware of the AP.

The complicated objective makes the formulated problem (31) challenging to solve. First, since the optimization variable is continuous, the optimal solution cannot be obtained via exhaustive searching. In addition, this work considers high-mobility scenarios where instantaneous perfect CSI and sensing parameters are unavailable, leading to the following problems: On one hand, the pre-equalization design based on the outdated CSI results in suboptimal results. On the other hand, the computation of the CRLB relies on true sensing parameters, which are unavailable before sensing parameter estimation. Note that such a critical issue has been largely overlooked in existing optimization works.

SECTION: IVProposed Algorithms

In this section, we present our developed algorithm for solving the optimization problem in (31). We first describe the overall CPBPE framework, which is then followed by a detailed description of the channel prediction module, CSI processing module, and pre-equalization module.

SECTION: IV-AOverall Framework

Recently, deep learning has demonstrated significant capabilities in solving complicated problems. It can leverage the offline training mechanism to improve the generalization ability of the network; in the online deployment phase, only one low-latency forward propagation is required to obtain the pre-equalization matrix solution, effectively addressing rapidly changing channel conditions. Therefore, the deep learning approach is adopted in this work to solve the original optimization problem.

The overall framework is illustrated in Fig.3. Specifically, to address the outdated CSI and sensing parameters in high-mobility scenarios, we first develop a communication and sensing channel parameter prediction network to forecast the channel coefficients in the delay-Doppler domain. By leveraging the temporal dependence of OTFS channel parameters, the channel parameters in the next time slot can be predicted. This not only ensures that the pre-equalization design is based on almost real-time CSI and sensing parameters but also reduces the overhead for obtaining CSI. Based on the predicted CSI and sensing parameters, the AP facilitates pre-equalization design with DNN, which enables direct demodulation of signals at the UAV.

Note that instead of merging channel parameter prediction with pre-equalization, we decompose the above process into three modules, i.e., channel prediction module, CSI reconstruction module, and pre-equalization design module. This comes from the fact that the three modules of the network can be trained independently, thereby reducing the overall training complexity of the network. In the channel prediction module, based on the sparsity of the OTFS channel and the strong correlation between the OTFS channel and mobility, only a few channel parameters, such as channel attenuation values, delays, and Doppler shifts, are required. After inputting the above parameters in the past few slots into the prediction network, the channel and sensing parameters for the next time slot can be predicted. These predicted parameters are then fed into the CSI processing module to be processed and then provide an initial value for the pre-equalization design module, thereby reducing the complexity of the pre-equalization network training process.

SECTION: IV-BChannel Prediction Module

To design the pre-equalization matrix in problem (31), we first need to obtain the CSI and the sensing parameters of the-th time slot. To effectively reduce the overhead of channel estimation and reduce the impact of outdated CSI, we come up with a channel prediction module based on the neural basis expansion analysis for interpretable time series forecasting (NBEATS) network[31], which relies on the channel information of the past few time slots.

The core idea of the module is as follows. First, the prediction module leverages the sparsity of OTFS channels to decouple the channel into a series of parameters. This enables a parameter-level channel prediction using a low-dimensional input space, thereby reducing complexity. Furthermore, it decomposes time series through multiple fully connected layers, with each layer fitting partial features of the channel sequence. This approach allows the network to extract, separate, and integrate channel variations from multiple scales. Consequently, the prediction does not rely on period characteristics, which are difficult to maintain for channel parameters strongly associated with mobility. This enables the effective fitting of rapidly changing channel features with fewer time steps, even in the absence of clear periodicity. The details of the module are described below.

Leveraging the sparsity of OTFS channels, the channel parameters, i.e., delays, Doppler shiftsand channel attenuation parameters, are adopted as the input of the prediction network instead of the whole channel matrix as considered in[24]. This greatly reduces the dimensionality of the network input, effectively lowering the network overhead. In this way, the communication or sensing channel parameter set at the-th time slot is denoted as

To predict the channel parameter set at the-th time slot, the channel parameter setsof the pasttime slots are fed into the prediction network, whereis expressed as

The adopted prediction network structure is illustrated in Fig.3①.

The channel prediction network consists of several stacks, which are connected as shown in Fig.3①. Each stack extracts one type of feature from the channel parameter variations and passes the unlearned feature variations to the next stack for processing, ultimately achieving the learning and prediction of channel parameter features at different scales. The channel parameter prediction results of each stack are summed up to form the predicted channel parameter set, i.e.,

Each stack is composed ofblocks. For each block, the input is a channel parameter sequenceof length, containing a portion of the channel features. The output consists of two parts, i.e., one part is a fitted channel parameter sequence of length, representing the features of the channel parameter sequence that the block can fit, and the other part is the predicted channel parameter valuefor the next slot. Note for the first block in the entire model, its input is the original channel parameter sequence.

Different blocks are connected based on the doubly residual stacking principle[31]. In other words, each blockcontains two residual branches, i.e., one branch computes the difference between the fitted channel parameter sequence and the block’s input, outputting the channel parameter sequence that the block failed to fit, which is then passed to the next block for fitting. The other branch sums the predicted channel parameter valueof the blockwith those from other blocks, serving as the channel parameter prediction output for the stack. This process is represented as

Inside each block, the network is composed of two parts. The first part is a 4-layer fully connected network with a channel parameter sequenceas input. The output of this fully connected network is input into two other fully connected networks. One of these fully connected networks is responsible for fitting the input channel parameter sequenceof length. The output result is linearly mapped to output the fitted channel parameter sequence. The other fully connected network’s output is linearly mapped to predict the channel parametersfor the next time slot. The linear mapping process is expressed as follows:

whereandare the learnable weight matrices for channel parameter fitting and prediction.andrepresent the output of the fully connected layers for channel parameter fitting and prediction.andare the learnable bias vectors for channel parameter fitting and prediction, respectively.

For the channel prediction module, the network implementation process is divided into two stages, i.e., offline training and online prediction. In the offline training stage, a large set of channel time series data is used to train the network. Notably, the channel parameter dataset is generated using ray-tracing based on the UE’s trajectory, with periodic sampling over a continuous period. In this way, more realistic channel parameters are collected, thereby ensuring the practical applicability of the developed network.

The loss function of the offline training process is designed based on the MSE between predicted channel parameters and real channel parameters, denoted as

Subsequently, we consider using six stacks, each containing three blocks in our channel prediction module. We utilized the Adam optimizer to iteratively train the channel prediction network with a learning rate of 0.001 until convergence.

During the online prediction phase, simply input the channel parametersestimated from the previous time step into the channel prediction module. Then, a single forward computation is done to predict the channel parametersfor the current time slot.

SECTION: IV-CCSI Processing Module

The CSI processing module is mainly designed to post-process the output of the channel prediction module and provide an initial value for the pre-equalization design module, thereby reducing the complexity of learning and training. First, the predicted channel parameters from the channel prediction module, including channel attenuation, delay, and Doppler shift, are used to reconstruct the communication channelaccording to (17). Subsequently, the inverse of the communication channel matrixis computed.

SECTION: IV-DPre-equalization Design Module

The output of the CSI processing module and sensing parameters can then be used to aid the pre-equalization matrix design. Therein, we leverage a neural network to design the pre-equalization matrix as shown in Fig.3③. The details of the module are described below.

The inverse matrix of the predicted communication channel is concatenated with the transmitted data symbols with the following processing process: Firstly, the real and imaginary parts of the inverse matrix of the predicted communication channel are separated and reconnected along dimension 1 to form a tensor of size. Subsequently, this tensor is flattened into a one-dimensional tensorof size. Additionally, the real and imaginary parts of the DD-domain modulation symbolsare separated and reconnected along dimension 1 to form a one-dimensional tensorof size. Next,andare concatenated via a concatenate layer to form a one-dimensional tensorof size.

The network consists of multiple dense layers and a residual connection structure. First,is input into the first dense layer through the Tanh activation function. The advantage of using the Tanh activation function lies in its ability to handle negative numbers and maintain a mean value of zero, which is suitable for a pre-equalization matrix that has centralized characteristics. Next, the output of this dense layer is fed into three consecutive dense layers, each with a Tanh activation function. To expedite convergence, we additionally adopt a residual connection method, linking the inverse matrix of the predicted communication channel with the output of the dense layers. More specifically, the output of several consecutive dense layers is connected to the input of the first layer via the residual connection, and the inverse matrix of the predicted communication channel is modified for both communication and sensing performance by directly adding the outputs. Finally, the output is reshaped to sizeby the reshaping layer. The detailed parameter of the proposed DNN-based pre-equalization design network is listed in TABLEI.

The output of the last reshape layer is a matrix with a size of, which is denoted as. The firstrows of the matrixcorrespond to the real part of the pre-equalization matrix before power normalization, and the subsequentrowscorrespond to the imaginary part of the pre-equalization matrix before power normalization.

Due to constraints on transmission power in (32), power normalization on the output of the neural network is performed as follows

Then, the real-value outputs are reconnected to the complex-valued pre-equalization matrix as

Similar to the channel prediction module, the implementation process involves two phases, i.e., offline training and online deployment. During the offline training phase, to minimize the objective problem in (31), we design the following loss function

whereis the L2 regularization term, which is used to prevent the model from overfitting.is the parameter of the DNN-based pre-equalization design network.is the weighting factor of the L2 regularization term.

The channel information processed by the CSI processing module is used as input for the network, and the sensing parameters are used as labels in the loss function. Based on them, the neural network is then trained offline using the Adamax optimizer with the loss functionand a learning rate of 0.001 until the network converges.

Due to the well-established offline training, during the online deployment phase, only one forward propagation is required to complete the prediction of the pre-equalization matrix for the next time slot considering both communication and sensing performance. Therefore, the pre-equalization matrix can be rapidly obtained by inputting the inverse of the channel matrix and the modulated information symbols. After usingto pre-equalize the transmitted symbols, the sensing performance of the transmitted waveform can be improved, and at the same time, the UE can also directly demodulate the signal without equalization, thus significantly reducing the complexity of the UE.

SECTION: VSimulation Results

In this section, the numerical results are presented to demonstrate the effectiveness of the proposed scheme. We consider one AP, one UE, which also serves as a sensing target, andscatters. The AP is fixed at coordinates, while the UE and scatterers move around the AP at speeds of up to. These positions and motion patterns are incorporated into the Wireless Insite[32]software to generate corresponding channels as the dataset, including delays, Doppler shifts, and channel attenuation parameters. The dataset consists of 640 trajectory groups, which are divided into training and testing sets in a ratio of 4:1. Moreover, the size of one OTFS symbol is set asand[33,34], respectively.

To verify the performance of the proposed CPBPE algorithm, we compare our algorithm with the following schemes, i.e.,

Minimum mean square error (MMSE) equalization[35]:Under this scheme, the MMSE equalization, which is calculated using the communication channel matrix of perfect CSI, is performed at the UE side. In this work, MMSE is used as an upper-bound algorithm for communication performance.

Pre-equalization with perfect CSI:This is the ideal case, where only the pre-equalization design network proposed by this paper is utilized to design the pre-equalization matrix. The network takes the communication channel matrix with perfect CSI as input.

Pre-equalization with outdated CSI:Under this scheme, channel prediction is not performed, and the CSI from the previous time slot is used as input to the pre-equalization network.

SECTION: V-APerformance of Channel Prediction

We first examine the performance of channel prediction. Fig.4compares the accuracy of the NBEATS-based OTFS channel prediction module with the common time-series prediction algorithm, including long short-term memory recurrent neural network (LSTM)[36], patch time series Transformer (PatchTST)[37], and Autoformer[38]. Due to the varying magnitudes of OTFS channel parameters, the mean absolute percentage error (MAPE) is employed as the accuracy evaluation metric, expressed as

whereandare the true and predicted values of the parameters, respectively, andis the number of samples.

As shown in the figure, for the prediction of,,, and, the NBEATS algorithm always demonstrates the best MAPE performance. The worst prediction performance for the NBESTS algorithm is observed for the delay, but its MAPE is still below 5 %. In addition, for the predictions ofand, the MAPE is significantly less than 1 %. Overall, this demonstrates that selecting the NBEATS algorithm for OTFS channel parameter prediction is feasible.

SECTION: V-BEffect of Iteration Number

This subsection explores the relationship between the number of iterations during the offline training phase of the pre-equalization design network and the ISAC performance. From Fig.5, it can be observed that for communication MSE performance, convergence is achieved at approximately 20 iterations. However, for sensing CRLB performance, it takes about 60 iterations to reach convergence. Furthermore, communication MSE initially decreases and then slightly increases during training. This is because, in the early iterations of training, the network primarily focuses on optimizing communication MSE performance. As communication MSE performance stabilizes, the network begins to prioritize optimization of sensing CRLB performance. This indicates that when communication performance is more important in the OTFS-based ISAC system, it may not be necessary to perform a large number of iterations to meet performance requirements. However, if a strict trade-off between communication and sensing performance is desired, more iterations are required. Although the offline training phase takes some iterations, during online deployment, the designed CPBPE network does not require as many iterations and only a single forward propagation is required to complete the design of the pre-equalization matrix considering both communication and sensing performance. The ability of this network to provide rapid outputs helps overcome outdated pre-equalization matrix designs in high-mobility scenarios.

SECTION: V-CEffect of Transmit Power

We then investigate the effect of transmit power on the optimized performance of communication and sensing. Fig.6presents the optimized communication MSE versus the transmit power under different schemes, where only the communication performance is considered (i.e.,). As illustrated in Fig.6, with increasing transmit power, the MSE of all algorithms shows a decreasing trend. This is because higher transmission power results in a higher SNR for communication symbol demodulation at the UE. Additionally, it can be observed that our proposed algorithm, utilizing the predicted channel for pre-equalization design, not only approaches the communication MSE performance under perfect channel information, indicating the accuracy of our channel prediction algorithm, but also approaches the performance of MMSE equalization based on perfect CSI. This shows the excellent performance of our proposed pre-equalization design scheme in significantly reducing complexity while maintaining significant symbol detection performance. Additionally, the performance curve of pre-equalization designed with outdated CSI shows a significant gap compared to the other three curves. This indicates that pre-equalization designs based on outdated CSI can degrade communication performance, making accurate CSI prediction essential for pre-equalization.

Fig.7presents the optimized CRLB versus the transmit power under different schemes, where only the sensing performance is considered (i.e.,). From this figure, as transmit power increases, the sensing CRLB of all schemes decreases. This is because higher transmit power indicates a higher signal-to-noise ratio for echoes, leading to improved sensing accuracy. Additionally, we can see from the figure that the performance based on our CPBPE algorithm almost overlaps with the best CRLB performance achieved by the scheme under perfect sensing parameters. When compared to the scheme based on outdated CSI for pre-equalization design, there is an improvement of aroundin CRLB performance. This demonstrates that prediction is necessary for achieving higher accuracy in CRLB for sensing. It is worth noting that even with the scheme based on outdated sensing parameters, significant sensing performance gains compared to the scheme without pre-equalization can still be obtained. This validates the ability of the proposed pre-equalization design module to achieve sensing performance gains even under less accurate estimation.

SECTION: V-DTrade-off Between Communication and Sensing Performance

Fig.8illustrates the trade-off between communication and sensing performance achieved by different algorithms. As seen in the figure, when the communication weighting factoris large, the proposed algorithm achieves an MSE of the order of. As the communication weighting factordecreases, the sensing CRLB of the CPBPE algorithm is reduced by more than 65 %, indicating a significant improvement in sensing accuracy. This demonstrates that the designed weighting factor allows different pre-equalization designs to adapt to varying communication and sensing requirements.
Moreover, the trade-off curve of the proposed CPBPE algorithm nearly overlaps with that of the design based on perfect CSI and sensing parameters, while the trade-off curve of the pre-equalization design based on outdated CSI always lies outside the trade-off curve of the proposed CPBPE algorithm. This means that, under any communication and sensing requirements, the proposed method can overcome the impact of outdated CSI, achieving a good balance between communication and sensing performance. Note that the CRLB performance of the pre-equalization design based on outdated CSI improves overall with the increase in communication symbol demodulation MSE. However, when the communication weighting factoris very small, the CRLB increases. This is because when the gap between outdated and perfect CSI and sensing parameters is larger, the better the optimization result based on the outdated CSI, the poorer communication and sensing performance when applied with real CSI. This again underscores the necessity of obtaining accurate CSI.

SECTION: V-EEvaluation of Signal Processing Complexity at the UE

In traditional communication frameworks as shown in Fig.2, the UAV UE needs to perform channel equalization before symbol detection, which requires matrix inversion operations. This results in high computational complexity, i.e.,, whereis the modulation order. In contrast, the proposed CPBPE scheme only requires a complexity ofat the UE. The comparison of the signal processing complexity of the proposed framework with the traditional framework (i.e., performing channel equalization at the UE side) is plotted in Fig.9. As shown in the figure, the processing complexity increases with the increase in symbol length. Moreover, the complexity gap between the traditional communication scheme and the proposed CPBPE scheme widens significantly. It is worth noting that given that energy consumption is proportional to complexity, the proposed method greatly reduces energy consumption at the UE, thereby enhancing the battery life of the UAV.

SECTION: VIConclusions

In this work, we have proposed a pre-equalization design based on the OTFS waveform for an ISAC-enabled aerial-terrestrial network. To overcome the influence of outdated CSI and sensing parameters, relying on deep learning, a CPBPE framework was developed to effectively design a more precise pre-equalization matrix. The pre-equalization design enabled the receiver to require only simple power normalization for symbol detection, significantly reducing the overhead and complexity associated with channel estimation and equalization at the UE. Simulation results showed that the CPBPE framework enhances both communication and sensing performance compared to pre-equalization based on outdated CSI. Moreover, it closely approximated the performance achieved with perfect CSI and sensing parameters, demonstrating its robustness and suitability for high-mobility scenarios.

SECTION: References