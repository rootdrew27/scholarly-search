SECTION: BTS: Bifold Teacher-Student in Semi-Supervised Learning for Indoor Two-Room Presence Detection Under Time-Varying CSI

In recent years, indoor human presence detection based on supervised learning (SL) and channel state information (CSI) has attracted much attention. However, existing studies that rely on spatial information of CSI are susceptible to environmental changes which degrade prediction accuracy. Moreover, SL-based methods require time-consuming data labeling for retraining models. Therefore, it is imperative to design a continuously monitored model using a semi-supervised learning (SSL) based scheme. In this paper, we conceive a bifold teacher-student (BTS) learning approach for indoor human presence detection in an adjoining two-room scenario. The proposed SSL-based primal-dual teacher-student network intelligently learns spatial and temporal features from labeled and unlabeled CSI datasets. Additionally, the enhanced penalized loss function leverages entropy and distance measures to distinguish drifted data, i.e., features of new datasets affected by time-varying effects and altered from the original distribution. Experimental results demonstrate that the proposed BTS system accomplishes an averaged accuracy of around 98% after retraining the model with unlabeled data. BTS can sustain an accuracy of 93% under the changed layout and environments. Furthermore, BTS outperforms existing SSL-based models in terms of the highest detection accuracy of around 98% while achieving the asymptotic performance of SL-based methods.

SECTION: IIntroduction

Wireless networking devices have gained popularity, especially Wi-Fi, offering convenience in daily lives. However, many Internet-of-Thing (IoT) devices lack security and safety features, emphasizing the need for wireless devices with intrusion protection as one of the applied scenarios of human presence. Additionally, in-home wireless sensing devices can assist other indoor applications, such as elderly healthcare, room vacancy, and remote monitoring[1]. In practical applications, device-based wireless gadgets such as smart phones[2,3]and smart watches[4,5]are commonly used for home security and safety sensing. Nevertheless, these devices may not always be carried around in indoor scenarios, rendering them less effective. On the contrary, device-free solutions, such as cameras[6,7,8], are also utilized for home security and safety sensing applications. However, privacy concerns arise when these methods rely on image analysis for indoor detection. Alternatively, some applications focus on the utilization of radar-based sensing owing to its asymptotic resolution to imaging[9]. However, both images and radar sensors may lead to a difficulty of detecting blind spots due to potential obstacles in the indoor environments. Therefore, there has been a surge of interest among researchers in exploring the utilization of commercial Wi-Fi devices to detect people indoors, as radio frequency (RF) wireless signals have unique characteristics that can penetrate walls[10]. With the aid of wireless signals, channel state information (CSI) has become increasingly popular due to its versatile and informative features in both spatial, temporal, and spectral domains[11,12,13,14]. In[15], conventional optimization-based signal preprocessing of WiFi CSI is performed for sensing applications. The work of[16]has discussed the subtle changes in CSI observed under stationary human presence through a wall, compared to the more pronounced changes caused by a moving person. Moreover, with the advancements of deep learning, researchers have attempted to design deep learning-based Wi-Fi detection systems by using Wi-Fi CSI signals[17,18,19,20,21,22,23,24,25,26]. The authors in[27]have also investigated the future advances, challenges, and opportunities for WiFi-based human sensing using deep learning.

Various approaches have been proposed for indoor human detection based on CSI. The fine-grained fingerprinting method in[11]compares real-time streaming CSI data with an offline radio map in a database. Learning-based methods, such as support vector machines (SVM) classification[12]and autoencoder (AE) approaches[17,28], have also been employed to improve detection performance based on CSI data. Alternatively, some approaches focus on capturing the temporal correlation of sequential CSI data by applying recurrent neural networks (RNNs)[29,30]such as long short-term memory (LSTM)[19,31]and GRU[20,21]. Other related architectures combine AE, CNN, and LSTM for device-free human activity recognition, such as autoencoder long-term recurrent convolutional network (AE-LRCN) in DeepSence[22]. More advanced architecture of WiSMLF adopts module fusion and scoring on attention is proposed in[26]. Additionally, some methods attempt to overcome the lack of CSI data using generative adversarial networks (GANs) during training[23]. However, CSI is susceptible to time-varying effects induced by environmental changes[32]. When severe time-varying effects occur, the CSI pattern can be completely different from the original one, which requires model retraining in order to adapt to the new data distribution. Unfortunately, most of the aforementioned approaches for indoor human detection are supervised learning (SL) methods, which require time-consuming and laborious labeling of new data when encountering time-varying effects.

To address the above issue, semi-supervised learning (SSL)[33]is beneficial to adopt a portion of the labeled CSI dataset to train a new and unlabeled data. This scheme can eliminate the need to manually label new data, which can be further reused for subsequent retraining, improving efficiency and reducing costs. Several existing SSL approaches have been proposed for human activity recognition based on CSI data. MCBAR[34]and CsiGAN[35]utilize GAN to distinguish between real and fake data, whereas DADA-AD[36]leverages transfer learning and domain adaptation. SemiC-HAR[37]employs a temporal classifier to label the unlabeled data before training an encoder on both labeled and unlabeled datasets. However, these methods often require ground truth for some unlabeled data. Most of existing works do not consider significant differences in the distributions of labeled and unlabeled datasets. Additionally, they only conduct experiments in a single room, simplifying the training difficulty. Note that only CsiGAN has demonstrated multi-room scenarios without limiting the labeled and unlabeled data to similar distributions. However, CsiGAN is with high computational complexity, which requires a long training time due to the adoption of CycleGAN[38]in their algorithm.

Therefore, it becomes compellingly imperative to address the challenges of time-varying effects and achieve high-precision for human presence detection in adjoining room scenarios. Inspired by the concept of knowledge discillation[39], we propose a novel bifold teacher-student (BTS) network. Our approach is motivated by the meta pseudo labels (MPL)[40]and communicative teacher-student model[41], which frames the teacher-student training process as a bi-level optimization problem. To further improve performance and address a more challenging time-varying scenario, we extend MPL to a two teacher-student network design that incorporates both temporal and spatial perspectives using transformer encoder[42]and ResNet[43]architectures. Our previous work[44]has demonstrated the feasibility of using a transformer encoder based teacher-student network for this problem, but this paper aims to further enhance accuracy through leveraging the response of data in different cases. Our proposed system is conducted under a more complicated problem with adjacent room scenario and with fewer number of equipped antennas. A table for acronyms is established in TableI. The main contributions of this paper are summarized as follows.

We have conceived a semi-supervised CSI-based bifold teacher-student presence detection system in an adjoining two-room scenario to resolve the problems of indoor human presence detection, especially the laborious labeling and drifted datasets issue due to time-varying channel. We consider four cases including empty room, human presence in either one of two rooms, and people presence in both rooms.

BTS overcomes the time-varying problem by leveraging the characteristics of fluctuating channels in different human presence cases. We measure a time-invariant indicator for each case by computing subcarrier-wise entropy within a time period, which generates confidence distribution of cases viewed as the prior knowledge to CSI data.

A series of loss functions are designed to enhance performance and resolve various problems, including (1) self-supervised learning between two teacher-student networks by minimizing their distance in latent space, (2) data drift evaluation by constraining the dataset in hypersphere, and (3) regulating inconsistent distribution of drifted data by adding confidence distribution.

We have collected and observed different responses of CSI in the adjoining room scenario in different fluctuation levels of time-varying problem. Experiments are conducted to demonstrate that the proposed BTS system can achieve the highest accuracy compared to different semi-supervised based methods. Moreover, the accuracy of BTS can asymptotically approach the performance of supervised learning and even surpasses them in some scenarios.

SECTION: IISystem Architecture and Preliminary Observations

SECTION: II-ASystem Architecture

We consider two Wi-Fi access points (APs) in each room, as illustrated in Fig.1. A single pair of APs, serving as a transmitter (TX) and a receiver (RX), is considered in an adjoining room, with or without human presence. For example, the TX in room A periodically sends an RF signal (dotted line) to the RX in room B, where human presence only takes place in room B. The RX estimates the CSI and delivers it to the database in the edge computer for further data training. Both labeled and unlabeled data will be fed into the computing edge for model training of BTS system. After deploying the well-trained model on the edge, human existence can be predicted in the two-room scenario. However, CSI is not always stable due to external factors. Our proposed system can detect the severedata driftin CSI and retrain the deep neural networks (DNN) model from the obtained drifted and recollected data. Hence, the unlabeled database will be updated every time the drift occurs, whilst the labeled database will remain unchanged. We considercases of presence detectionII-A11footnotetext:Localization can be another potential application for detecting an empty room and human presence. However, it requires a more complex system and deep learning design. Furthermore, data collection and labeling for a large number of reference points for localization are potential challenges., includingCase 1(): Empty in both rooms,Case 2(): A person in room A and empty in room B,Case 3(): Empty in room A and a person in room B, as well asCase 4(): people in both rooms. Note that we consider the most challenging task that at most one people being present in each room, which leads to subtle changes in CSI compared to lots of people in rooms.

SECTION: II-BCSI Modeling

CSI is considered essential information for estimating the wireless channel, as it represents the combination of fading and propagation effects. This information can be acquired based on orthogonal frequency-division multiplexing (OFDM) and multiple-input multiple-output (MIMO) compatible with existing up-to-date IEEE 802.11 protocols. In the OFDM system, all subcarriers are orthogonal to each other within a channel, which diversifies channel utilization. On the other hand, the MIMO technique provides channel diversity to enrich spatial information by propagating the RF signal from TX to RX, supporting multiple antenna pairs for CSI. We considersubcarriers,antenna pairs andpackets. Employing these two techniques, we can establish a channel model by the combined MIMO-OFDM system in an indoor environment, which can be formulated as

whereandrepresent the received and transmitted signals with thesubcarrier of theantenna pair at thepacket, respectively. Notationis the channel response, whilstis additive white Gaussian noise (AWGN). To estimate the channel model, the CSI of thesubcarrier and theantenna pair at thepacket can be acquired as[45]

whereindicates the CSI amplitude response, andcorresponds to the CSI phase response. Note that only the amplitude response of CSI is considered in this work since the phase information has been studied to be indescribable[46].
Hence, the estimated CSI matrix at the receiver at timecan be obtained as

Moreover, the normalization over antenna pairs is conducted to the amplitude response of CSI. The normalized CSI withsubcarrier andantenna pair atpacket can be expressed as

where, andrepresents the amplitude response of raw CSI. In order to perform pair-wise normalization in, the minimum and maximum values of the amplitude response of raw CSI from allsubcarriers at theantenna pair are selected. Fig.2highlights the difference between the amplitude response of raw CSI and that of normalized CSI. Observed from Figs.2(a)and2(b), normalization is necessary to remove undesirable on-device mechanisms that are unrelated to CSI, such as automatic gain control, in order to obtain appropriate CSI features.

SECTION: II-CPreliminary CSI Observation

In an adjoining room scenario, the amplitude response of normalized CSI is fluctuating and follows different patterns among cases. In Fig.3, we consider 4 transmission pairs with 56 subcarriers. The amplitude response of normalized CSI when human presence in Figs.3(b)to3(d)exhibits significant fluctuations than that of empty case in Fig.3(a). To elaborate a little further, from Figs.3(b)and3(c)with moderate fluctuations, we can infer that human present on either side of adjoining room reacts in a similar shape of curves. However, there exist subtle differences between them. Although they are both affected by multipath effects, the human presence in different rooms can cause divergent fading and variation. For example, some large-scale patterns can be distinguishable when considering subcarriers as representative features, e.g., CSI amplitude at pairwith subcarriers indexed from 40 in cases 2 and 3 respectively in Figs.3(b)and3(c)reveals different shapes of curves. Based on the multipath fading effect, we can leverage these small-scale variations to establish a relationship between the CSI and spatial features.

We observe the amplitude response of normalized CSI when the time-varying effect takes place in Fig.4. We consider Case 1 of empty room. These datasets are collected over six rounds at different times with details described in TableIII. Note that the collection interval between each round is an hour. There was heavy rain in the outdoor environment during the fourth round, which can be viewed as an example when the time-varying effect occurred. Additionally, during the sixth round, we manually change the angle of the equipped antennas of APs to emulate the scenario where individuals inadvertently touch the AP causing the displacement. Figs.4(a),4(b), and4(c)represent the first three rounds of data with a relatively stable scenario, whereas Fig.4(d)reveals drifted signals caused by changes in the environment. Moreover, the channel after the environment in the fourth round is displayed in Fig.4(e). Finally, Fig.4(f)demonstrates the severe situation where CSI is no longer similar to all previous rounds due to different deployment, changing the spatial feature caused by multipath. However, it is impractical to label all potential situations in the indoor environment over different timestamps, which is time-consuming and laborious. Therefore, we propose a BTS scheme to flexibly and dynamically learn for presence detection, which is demonstrated in the following section.

SECTION: IIIProposed Bifold Teacher-Student (BTS) Learning for Presence Detection

In practical scenarios, the process of labeling CSI data can be laborious and time-consuming. To address this issue, we propose a semi-supervised learning approach that leverages both labeled and unlabeled data to learn common characteristics and reduce the need for labeled data. Furthermore, in SectionII, we have observed the impact of human presence on CSI in an adjoining room scenario, as well as the influence of time-varying effects caused by external factors. To achieve accurate human presence detection under these conditions, we propose a deep learning-based algorithm that exploits these physical phenomena. Fig.5shows the block diagram of the proposed BTS system, which uses two teacher-student (TS) networks, each trained using a similar approach to MPL[40]but with different feedback mechanisms. In the training process, labeled and unlabeled CSI data are provided to the teacher network, while only unlabeled data is given to the student network for neural network model updating. The teacher network guides the student network by providing pseudo-labels to the unlabeled data as it learns from the labeled data.

SECTION: III-AData Preprocessing

As depicted in Fig.5, the data preprocess function block manages the preprocessing pipeline, which comprises of pair-wise normalization and time-domain windowing. The pair-wise normalization normalizes raw CSI data based on the subcarriers in each antenna pair to enhance the spatial feature. The time-domain windowing, on the other hand, conducts sliding window mechanism with a fixed window size to store varying features over a period of time.

Due to the non-line-of-sight (NLoS) propagation paths from TX to RX, CSI experiences severe multipath effects. Therefore, pair-wise normalization is required as it provides informative spatial feature for each antenna pair. The normalization is initialized at first step in data preprocessing, which takes the CSI amplitude responseas input. We define, where labeled data is denoted asand unlabeled data is indicated by. Then, we adopt the normalization scheme inas. Therefore, the normalized CSI data based on this equation, including both labeled and unlabeled data, provides more spatial information about human presence and the environment in each antenna pair than the raw data, which are illustrated in Fig.2.

After conducting pair-wise normalization, we utilize time-domain windowing to capture temporal variations in CSI. Specifically, we treat the CSI data atpacket as a frame with a window size of, where each frame stores the varying features in each subcarrier within the windowing period. It is capable of capturing temporal changes in the environment and human presence. The windowing process for the amplitude response of normalized CSI can be formulated as

where the labeled and unlabeled training data will be in the form ofand, respectively. By having these normalized frames, we can leverage different types of training strategies to learn both spatial and time-domain features.

According to CSI observations in SectionII, we have found that each round of CSI dataset has specific common characteristics that remain stable despite time-varying effects. Discovering these common features is essential as there may be a large difference between labeled and unlabeled data due to time-varying effects, making it difficult to adopt SSL-based methods for training. We define thedisarraytermas

where

The parameter ofindicates fine-step anddenotes fine-order aiming for weighting and rescaling the distance between the values of sampled data and the average data. In,represents the level of data variance within a packet frame. We calculate the average ofover subcarriers to obtain a representative value of each antenna pair, and then multiply the values of each pair fromtoto amplify the influence of each pair. Furthermore, in,is composed of subcarrier-wise entropy over time and the averagediscrepancyfrom the data pointover a time window. By measuring the subcarrier-wise entropy, we can analyze the instability of CSI frame. It is anticipated that when computing the subcarrier-wise entropy in time, it will have a larger range of values for empty case, and vice versa for people present in rooms. This is because in the empty room, the variation is comparatively smaller, provoking asymptotic trends to that of the averaged value. By contrast, in human presence case, CSI fluctuates over time with larger variance in each subcarrier resulting in smaller entropy.

After calculating the disarray of the labeled dataand unlabeled data, we proceed to compute the average disarray. Note thatandare total data amount of labeled and unlabeled data, respectively. We then subtract the average disarray of the unlabeled dataset from the average disarray of the labeled dataset to obtain thedisparityas

which reflects the differences between the labeled and unlabeled datasets. Note thathas smaller impact on the empty room case. Therefore, we can obtain theindicatoras prior knowledge in each caseas

whereandrepresent the CSI data and the total amount of data for case, respectively. Note that. Since the empty room case involves human absence affecting CSI less,is not calculated for this case. After obtaining the indicator, we use them as reference values for batch data during the training phase.

SECTION: III-BDeep Neural Network of Primal/Dual Teacher-Students

In this subsection, we introduce the architecture of the primal TS network as well as the dual TS network. We utilize different network architectures in primal and dual networks to learn different features from the CSI data.

Fig.6(a)depicts the structure of the primal teacher networkat iteration, which serves as the final classifier for human presence prediction. First, the primal teacher utilizes the labeled data batchand unlabeled data batchalong with the indicatorto conduct training. In the subcarriers embedding function block, the concatenated data is defined as, which conducts reshaping in the subcarrier dimension of the original CSI from 3D with a dimension ofto 2D with that of, whereand. Additionally, we consider additional sinusoidal diversity information to each timeofto diversify the features, which can be obtained as

whereis a diversity constant, whilstis the modulo operation. After completing the diversity information, we inputinto transformer network. We aim to extract the large-scale correlation among the time sequences through the transformer encoder due to variation in time of all the subcarriers within a frame. We notice that we consider the last feature vector outputfor classification since we pay more attention to the latest timestamp than the expired time sequences.

Furthermore, a function block of confidence distribution can be calculated based onandas

which measures the euclidean distance between the disarray of batch dataat iteration. If the disarray of a batch datais closer to its corresponding indicator, the data is more likely to belong to that case and will be given higher confidence. Conversely, if it is far away from its indicator, the data will be given lower confidence. Note that we normalizeto a range ofas the final confidence distribution. Finally, we calculate the loss functionsand, which will be elaborated in the latter subsection. Moreover, as shown in Fig.6(b), the primal student network considers unlabeled dataand pseudo labelsprovided by the primal teacher for training. The labeled data is only adopted to evaluate the two pseudo labels from the primal student networks ofandat different iterations, which is not involved in the network training. Note that the primal student network only calculate loss ofduring training. Moreover, as shown in Fig.5, the resultingandgenerated from consecutive iterations will be fed back to the primal teacher’s network. The values ofandwill be explained and obtained in the latter subsection.

In Fig.7, the dual TS network ofat iterationis presented, which is designed to assist the training of the primal TS network. The dual teacher network shown in Fig.7(a)includes a confidence distribution, small-scale feature extractor and classifier. Similar to the primal teacher, the dual teacher network also considers labeled and unlabeled batches of data with indicators for training. Alternatively, ResNetIII-B222footnotetext:Compared to other visual feature extractors, such as VGG16 or VGG19, ResNet provides a deeper neural network architecture as well as residual mechanism benefited from batch normalization. The VGG16 model was based on the ImageNet dataset which includes several object categories. Therefore, the existence of a domain gap between ImageNet and the CSI dataset employed in this study may severely occur.is adopted as a simpler feature extractor to capture small-scale temporal and spectral information within each antenna pair. After extracting features ofandthrough ResNet, we perform prediction outputs ofandvia the classifier. To calculate the loss functionsand, we use the confidence distribution variablesandobtained byalong with the model predictions and ground truth labeled data. To elaborate a little further, the dual student network in Fig.7(b)is similar to the dual teacher network. The dual student network only utilizes the unlabeled data with the pseudo labelfrom dual teacher during training. The labeled data is considered as an evaluation of the two pseudo labels output from the dual student networks ofandat different iterations, to provide a feedback valuesandto the dual teacher as show in Fig.5.

SECTION: III-CLoss Functions for Training

We have designed several loss functions to be optimized for primal/dual TS networks, including transformative cross entropy (TCE), unlabeled indication cross entropy loss, cross-teacher quadratic loss and CSI time-varying Euclidean loss, which are respectively elaborated below. We firstly define a set of teacher networkand that of student network, where,,, andstand for ”Primal”, ”Dual”, ”Teacher”, and ”Student”, respectively.

As shown in Figs.6(a)and7(a), the transformative cross entropy loss is formulated as

whereis the ground truth of batch labeled datain caseatiteration,is the confidence distribution of batch labeled data, andpredicts the batch labeled data in iterationfrom teacher network. The design concept is described as follows. We incorporate the ground truth of the labeled batch into its corresponding confidence distribution, converting it into a probability distribution with afunction. This process increases the probability of the label with the highest confidence when the distributions of the labeled and time-varying unlabeled datasets become similar. However, when the distribution is highly dissimilar due to severe time-varying effects, the lowest confidence value will then confuse the ground truth, leading to inaccurate estimation. Note that the summation ofandaims for improving the similarity between the distributions of the labeled and unlabeled datasets. Moreover, as mentioned previously, the teacher networks employ the labeled dataset to guide the student networks in learning the unlabeled dataset. While, the knowledge of the unlabeled dataset is acquired through the feedback signals from student networks. The confidence distribution is capable of compromising the difference between the labeled and unlabeled datasets by leveraging the prior knowledge of the CSI data.

Inspired by MPL, we have conceived two types of unlabeled indication cross entropy (UICE) losses that belong to either teacher or student networks as shown in both Figs.6and7, which are respectively expressed asinandinas follows.

The loss functioninis adopted in the two teacher networks with unlabeled dataset and its corresponding pseudo label as well as confidence distribution. The cross entropy loss is multiplied by the feedback signalin. Moreover, since both student networks are trained with the unlabeled dataset and its pseudo labels without, we mainly calculate their cross entropy loss, as expressed inin. Note that,, andrepresent the neural network output of prediction distribution of pseudo labels from the unlabeled data through teacher networks, labeled as well as unlabeled one through the student networks, respectively. The benefit leveraging confidence distribution is the same as that inin. To elaborate a little further, a rectified linear unit (ReLU) function is used inin order to constrain the feedback and stabilize the training of the TS network. A negative value of the feedback indicates that the loss of iterationis lower than that of iteration, suggesting that training on unlabeled data is not necessary for the teacher network. However, it is not desirable for the teacher network to train in the opposite direction with a negative feedback. Accordingly, the ReLU function helps to avoid this issue and ensure the stability of the training process.

Inspired by contrastive learning[47]and the bootstrap mechanism in[48], we propose a self-supervised learning loss function that utilizes the same input data for generating different representations in different neural network. Therefore, as shown in Fig.5, a cross-teacher quadratic (CTQ) loss is designed between the primal and dual teachers, which can be expressed as

whererefers to the multilayer perceptron (MLP), whilstanddenote the latent features obtained after performing transformer of the primal and dual teacher, respectively. Note that the loss function is denoted bydue to the final human presence prediction in the primal teacher. We consider transformer encoder of primal teacher to discover temporal correlations, whereas ResNet of dual teacher is employed to extract spatial features. Subsequently, the mean square error between the two representation vectors inis computed to establish communication between the two networks and generate an enhanced representation vector.

The CSI time-varying Euclidean loss (CTVE) as shown in Fig.5is leveraged to detect whenever data drift and variation occurs, which is attained as

where the center point of the unlabeled dataset is expressed as

Note that initial weight ofis given by the MLP head coming from primal teacher.

As a result, we can constrain all unlabeled data to a certain range by minimizing the distance between the representation vector and the center point. As illustrated at the bottom part of Fig.5, this mechanism allows us to evaluate real-time streaming data in the online phase through the outlier distance as

whererepresents the latent feature of real-time CSI, andindicates model of MLP at the last iteration. When deploying our model in real-time scenarios, we need to consider the time-varying nature of CSI caused by environmental changes. Serious time-varying effects can lead to data drift, resulting in further model drift with degraded performances. Therefore, we continuously monitor the outlier distance of real-time CSI data by comparing it with the outlier distance of the training data. If the distance between them exceeds a certain threshold, i.e.,, we conclude it as data drift and collect new data to retrain the network. This process ensures that our model remains robust and performs well in real-time scenarios.

In our proposed BTS system, we have designed five loss functions for optimizing the models in primal/dual TS networks, includingin,in,in,in, andin. Therefore, the total loss of primal and dual teacher networks are respectively designed as

where’s are respective parameters for striking a balance between losses. Furthermore, the total loss of primal and dual student networks can be acquired asand, respectively. The overall training pipeline can be demonstrated in Algorithm1, which follows the procedures in Fig.5.

SECTION: IVPerformance Evaluation

SECTION: IV-AExperimental Settings

Our experiments are conducted in an adjoining room setup, as illustrated in Fig.8(a). The configuration consists of two neighboring restrooms, specifically room A in Fig.8(b)and room B in Fig.8(c), with each of a dimension of. Note that astorage space with walls are separating the two restrooms. We deploy two TP-Link TL-WDR4300 wireless routers, which support IEEE 802.11n Wi-Fi protocol providing CSI information based on[49]. The routers are configured in AP mode, with TX located in room A and RX in room B. The APs transmit at a center frequency of 2.447 GHz with a bandwidth of 20 MHz. The RX is operated under a dual-band mode, which is additionally connected to an edge server at a center frequency of 5.3 GHz. The edge server performing training and prediction receives 10 estimated CSI packets per second from the RX. As previously mentioned, data collection takes place for six rounds, with an one-hour interval between each round. We also record the environmental conditions during collection. The system parameters are presented in TableII, while the details of each round can be found in TableIII. We collect the data with a size of 2000 for each case in each round. Note that round 4 is conducted in a rainy weather, while round 6 is conducted with a different antenna orientation. The information of the involved participants is listed as follows: 3 women with heights (cm)/weights (kg) as 158/50, 155/46, 162/55, and 7 men with heights (cm)/weights (kg) as 174/67, 178/62, 171/62, 184/73, 185/71, 176/70, 172/56. The first two women and two men participate the two-room scenarios, whereas the remaining people involve the three-/four-room cases in SubsectionIV-D. Note that all participants provide around a data volume of 500 for each case in all rounds. At most one person can randomly walk in either one of the two detection areas, which is regarded as a more difficult task than that more than two people. This is because more people will fluctuate the signal more significantly, making it more distinguishable than that with a single person in the room[45].

SECTION: IV-BSelection of Different Hyperparameters

In our system, there are several adjustable parameters that are crucial in stabilizing the training process and achieving feasible performance, including the fine-stepand fine-orderin, as well as the value of’s adopted in the total loss functionsand.

Note that the adjoining room CSI indicator and confidence distribution that we have designed can be performed as a training-free classifier. Accordingly, we apply this classifier to evaluate parameters ofandas illustrated in Fig.9. We consider round 1 as the labeled dataset and round 6 as the unlabeled one. Thereafter, the unlabeled dataset is sampled in a size of 256 for calculating confidence distribution, which aims for emulating the batches of training data. We can observe from Fig.9(a)thatleads to the lowest accuracy ofsince it considers only subcarrier-wise entropy, which did not take time-varying factors into account. However, larger values ofwill lead to over-estimation according to only time-varying effect. By adjusting fine-order, smallerleads to insignificance of second term in, whilst larger one lead to pure cross entropy classification result. The asymptotic result can also be observed in Fig.9(b). Although the loss ofis lower than that ofdue to the second term in, it dominates the result inducing a lower accuracy as explained previously. Therefore, we selectandas the parameters in the following simulations.

As shown in Fig.10, we visualize the trend of disarrayinand indicatorin, whereindicate 4 cases of presence detection. Note thatpresents the variance of labeled/unlabeled data among subcarriers, whilstadditionally considers disparity of average disarray. As explained previously, a larger range of values for empty case is observed due to the comparatively smaller variation than human presence. On the contrary, for human presence case, CSI fluctuates over time with larger variance in each subcarrier resulting in a smaller value of. We can infer that empty case has the widest disarray range and largest indicator of, whereas the case of both room with human presence has the lowest indicator of. A moderate performance is inferred in cases of presence in either room A or B. Moreover, we can observe different trends between labeled and unlabeled datasets in the case of empty and human presence in room B, which potentially improves the prediction accuracy.

In our system, we design by combining different loss functions for optimizing primal/dual teacher networks inand, respectively. In Figs.11(a)and11(b), we evaluate accuracy with different values of’s. Owning to compellingly high computational complexity, we only provide 2D comparison forand for, whereindicates primal/dual teacher networks, respectively. Note that we use the samefor teacher networks in each case, i.e.,. We notice thathas the highest weight because of the significance of feedbacks obtained from the student networks. While, fundamental cross entropy is considered less required with the smallestsince the labeled data is deemed to be simpler to be trained compared to that with unlabeled dataset. In this context, we select,,, andas the hyperparameters for the loss functions in the remaining simulations, which is summarized in TableIV.

SECTION: IV-CEffects of Loss Functions

In this subsection, we will discuss the cases with and without, whilst the case withoutis evaluated based on two different networks. We train these cases with round 1 as labeled data and round 2 as unlabeled data, and evaluated the model from rounds 2 to 5. Fig.12shows the model performance in three mechanisms, i.e., ResNet, transformer and BTS. The blue slashed bars represent the ResNet-based single TS network, and the orange dotted bars represent the transformer-based single TS network. Furthermore, the bars with olive green crossed lines represent our proposed BTS system that leveragesand combination of both ResNet and Transformer. As shown in Fig.12, transformer achieves a performance of,, andin round 2, round 3, and round 5 respectively, but onlyin round 4. We can infer from SectionIIthat some subcarriers perform abnormal behavior in round 4 due to changes in the outdoor environment. However, subcarriers possess significant information for transformer. When subcarriers have different patterns such as those in round 4, the results of embedding in transformer will be degraded. Alternatively, we consider spatial information to improve additional performance of the model. It can be noticed that ResNet outperforms transformer in round 4 due to feature extraction of spatial information. ResNet prefers to focus on common features learned from small regions, rather than directly referencing the entire subcarriers like transformer. Leveraging both advantages in ResNet and transformer architectures, the proposed BTS system is capable of employing different latent features in primal/dual networks. Accordingly, the design of loss inachieves the highest accuracy in all testing rounds, i.e., the evaluation of BTS in round 4 performshigher accuracy than ResNet and abouthigher than transformer.

We recognize that the UICE and TCE loss functions are closely related to TS in SSL. The proposed BTS system is designed to reduce the effort required to label collected CSI data and address the time-varying effect caused by environmental changes. However, there is often concern about whether the unlabeled dataset is effectively learned, which is validated through the evaluations in this experiment in Fig.13. Firstly, we train on round 1 as a labeled dataset using a transformer-based network, which is considered a benchmark, as indicated by the blue slashed bars. Secondly, we adopt both rounds 1 and 2 as labeled datasets for supervised-based training, which employs the same neural network as that in the first evaluation, as shown in orange dotted bars. Finally, we evaluate BTS by treating round 1 as labeled and round 2 as unlabeled dataset, as depicted in olive green crossed bars. We can observe from Fig.13that utilizing a single round potentially leads to ineffective detection with time-varying CSI, i.e., it has an accuracy lower thanfrom rounds 2 to 5. On the other hand, overaccuracy is accomplished thanks to multi-timestamp data applied in supervised learning. While existing supervised learning methods require labeled data from both rounds 1 and 2, the proposed BTS system is able to leverage unlabeled data from round 2, which still achieves asymptotic accuracy to supervised learning using both labeled datasets.

In Fig.14, we compare five cases, including the case without utilization of confidence distribution (CD), usage of CD but with only either,, or, and the proposed BTS system, which are shown in blue slashes, orange dots, green horizontal lines, red vertical lines, and olive green crossed lines, respectively. Note that CD is a non-training-based weak classifier that assists the neural network to learn from prior knowledge. As shown in Fig.14, we can observe that in the case of rounds 2, 3, and 5, the participation of CD has little impact on the accuracy performance due to similar data features. However, larger differences can be found in the case of environmental changes in round 4 due to the attained prior knowledge relevant to environmental change. Notice that the case of BTS with CD and only the loss function ofhas the lowest accuracy in all testing rounds. This is mainly because when the student network is the only one that knows the prior knowledge, there will be a biased answer towards itself, which further misleads the teachers with confusing feedback. Such a circumstance also impinges the teacher network with no faith to provide correct pseudo-labels for the students to learn. By considering all loss functions, the proposed BTS can achieve the highest accuracy among other baselines.

Here, we demonstrate that by utilizingduring the training stage, we can limit the similarity of data within a specific range, thereby distinguishing drifted data from outlier distances. In Fig.15, we present the dataset distribution before and after training with blue, orange and red dots indicating the representation vectors of rounds 2, 4, and 6, respectively. We utilize dataset of round 1 as the labeled dataset, whereas rounds 2, 4, 6 are unlabeled ones. Note that we visualize their relationships by employing dimension reduction from high-dimension to 2D plots. In15(a), we can observe almost identical distributions even with changes of outdoor environments, whereas little difference can seen in Fig.15(b)owing to different deployment of antennas. It is challenging to predict and detect the difference under these distributions even with occurrence of data drift. Leveraging the benefits of the designed loss functionscan alleviate the mentioned problem. As can be readily inferred from Figs.15(c)and15(d)that the proposed BTS scheme can generate different distributions based on the designed loss functions. To elaborate a little further, due to severe time-varying effects, rounds 2 and 6 have substantially distinct distributions of representations.

Subsequently, in TableV, we have appliedto calculate the outlier distance of every data point in each round, which shows the maximum and minimum distances of the representation vectors from rounds 2 to 6. Note that round 6 possesses the severe data drift owing to distinct deployment. From the mechanism training without, i.e., not considering time-varying effects, we can observe that the data varies substantially from the distance oftofrom rounds 2 to 5. Moreover, the data with the smallest distance in round 6 overlaps with the range observed in round 5, and is also very close to that in round 4, which leading to a difficulty to select a threshold of detecing data drift occurrence. On the contrary, the proposed BTS system considering CSI time-varying effect withcan readily determine the threshold of drift detection. We can observe that the data with the same device deployment has a smaller range of data distribution, whilst data in round 6 is significantly separated from those in rounds 2 to 5, potentially improving detection accuracy.

After detecting data drift as demonstrated in TableV, we further investigate the scenarios before and after retraining, as depicted in Fig.16. In the case of severe CSI time-varying effects, significant data drift leads to a random guess with onlyaccuracy. However, with the proposed BTS system, retraining with CD and only loss function ofcan achieve an accuracy of. This is because the teacher network can provide prior knowledge directly for the unlabeled data during training. Additionally, with the aid of the detection and retraining mechanism, the proposed BTS system can achieve the highest accuracy ofwith the adoption of all loss functions as well as CD.

SECTION: IV-DMulti-Room Presence and Activity Detection

In TableVI, we have listed the experimental cases for multi-person presence and activity detection. For presence detection, we experiment on a total combination of 16 labels for human presence and absence across a four-room scenario with a conference room, office, storage room and corridor, as shown in Fig.17. Three TX-RX pairs are required for covering all four rooms based on[30]. Note that case 1 in presence detection indicates the scenario where all rooms empty. While, 10 cases are given for activity detection, including a person walking, running and jumping in a three-room scenario with a conference room, office, and storage room. Note that few cases are considered here due to excessive combinations with a total ofpossible cases, leading to difficulties of data collection and training.

The confusion matrices in Figs.18(a)–18(c)show the performance of DNN, convolutional neural network (CNN), and transformer models for detecting human presence in four-room settings, where the x-axis indicates the ground-truth labels and the y-axis means the predicted outcome labels. Each case represents a unique configuration where only one or multiple rooms are occupied, while others remain empty. It can be inferred that more misclassifications take place for cases 7–15 in both DNN and CNN owing to the similar features when multi-room presence. We can observe that the transformer model achieves the highest accuracy of, which is followed by the CNN with an accuracy ofand the DNN with an accuracy of, demonstrating the effectiveness of the transformer’s attention mechanism in capturing spatial relationships across rooms. Moreover, Figs.18(d)–18(f)illustrate confusion matrices for human activity detection in a three-room scenario, with labels indicating specific actions of walking, running, and jumping occurring in a particular room while the other rooms remain empty. This setup focuses the models on recognizing specific activities in isolated spaces, presenting a different challenge compared to presence detection. Confusion arises when classifying cases 8 and 9 in the storage room due to the similar features of the environmental items in the room, which create indistinguishable signal reflections. We can observe that the transformer model outperforms both CNN and DNN methods, achieving an accuracy ofcompared toand, respectively. The attention mechanism in transformer enables feature capturing for subtle differences in human activity patterns, leading to more accurate activity classification. The above performance improvement underscores the suitability of the transformer architecture for the tasks requiring temporal and spatial understanding in the more complex environments.

SECTION: IV-EBenchmark Comparison

We have compared the performance of proposed BTS scheme with existing SL as well as SSL-based mechanisms. For SL comparison, we adopt both rounds 1 and 2 as labeled data and evaluate with round 3. For SSL comparison, we consider round 1 as the labeled dataset, and either round 2 or 6 as the unlabeled dataset. We consider four different cases of presence detection, including an empty room, human presence in either room A or B, and human presence in both rooms.

In Fig.19, we compare two different SL methods, i.e., parallel CNN[18]and AE-LRCN[22]. Note that both comparison benchmarks require both rounds 1 and 2 as labeled data, whereas BTS uses round 2 as the unlabeled one. We can observe that parallel CNN has the lowest accuracy in room B. This is because parallel CNN utilizes both the amplitude and phase of CSI, whereas the spatial information in room B is very similar to that in the case of human presence in both rooms, which makes this CNN-based model fail to predict the room B case accurately. On the other hand, AE-LRCN has lower accuracy than BTS in cases of human presence since spatial and spectral information of CSI is not appropriately extracted. In a nutshell, the proposed BTS system achieves the highest accuracy of,,, andin the respective presence detection cases, which has the benefit of only requiring half number of labels for training.

As presented in Fig.20(a), we compare BTS with two SSL, i.e., CsiGAN[35]and MPL[40]. We consider round 1 as the labeled dataset and either round 2 in Fig.20(a)or round 6 in Fig.20(b)as the unlabeled one, while evaluate data in round 3. We can observe that the highest accuracy can be reached in both plots in the empty case due to simple distinguishment from features. In Fig.20(a), both CsiGAN and BTS both achieve a performance greater thanin the case of human presence in room B. It can be seen that CsiGAN and MPL fail to distinguish the cases of presence in room A and both rooms effectively. This is because these benchmarks potentially overfit the features of room B, which results in lower accuracy in the other cases. In contrast, BTS improves upon the original MPL architecture by detecting data drift and considering time-varying effects, which results in a better accuracy. As illustrated in Fig.20(b), it reveals a more severe case that considers unlabeled drifted data in round 6. Since MPL does not consider time-varying effects, it can only distinguish the differences between the cases of empty room and human presence in both rooms. Although CsiGAN is capable of generically augmenting adversarial data with similar features, confusing data features in the cases of presence in either room A or B still lead to a lower accuracy than proposed BTS scheme.

We summarize the results of our experiments in TableVII. In the SL block, ”Teacher (round 1)” indicates that we use a teacher model to conduct supervised learning only with round 1 as the labeled dataset, while ”Teacher (rounds 1 and 2)” means that we adopt both rounds 1 and 2 as labeled datasets. Our proposed BTS system outperforms the other SL methods in rounds 3 and 5 and is comparable to other rounds utilizing supervised learning with an accuracy difference lower than. Furthermore, in SSL block, ”Single ResNet/Transformer TS” indicates that we utilize a single teacher-student network based on either ResNet or Transformer, respectively. Overall, our proposed BTS system, which leverages all designed loss functions and a joint architecture of transformer and ResNet, outperforms other existing SSL benchmarks in all testing rounds by extracting temporal, spatial, and spectral features.

SECTION: IV-FComputational Complexity

Here, we present the analysis of computational complexity of the proposed BTS compared to the benchmarks in terms of the required total number of deep learning model parameters, required memory size per epoch, and training/inference time. Note that training time is calculated per epoch, whilst testing time is averaged over each batch. We evaluate the system with the 12th Gen Intel(R) Core(TM) i9-12900 central processing unit (CPU) and NVIDIA GeForce RTX 4060 graphics processing Unit (GPU). As shown in TableVIII, our BTS system requires a total of 24.49 M parameters to be trained owing to the complex TS models reckoning with the respective issues in human presence detection. An acceptable memory size of 93.42 MB is required for BTS compared to benchmark of CsiGAN. The training process of BTS takes the moderate time of 7.45 seconds per epoch, whereas it takes around 181.23 ms of inference time for each batch owing to the data preprocessing and four sub-architectures of BTS. We further notice that the proposed BTS system possesses the same input dimension under the varying numbers of human presence in the room. Since we only detect the human presence and room vacancy, different numbers of people indoor will not affect the computational complexity. To conclude, the proposed BTS system is feasible and implementable in practical applications, which outperforms the other existing solutions in the open literature.

SECTION: VConclusion

SECTION: V-AConclusion Remarks

We have addressed the challenges in indoor adjoining room human presence detection by developing a semi-supervised CSI-based BTS system. The primal/dual TS networks are designed to learn temporal, spatial and spectral features based on transformer and ResNet using SSL learning mechanism. Several loss functions are conceived to deal with time-varying CSI and data drift according to confidence distribution and outlier distance. In experimental trails, we deploy two commercial APs acting as TX/RX respectively in two adjoining room as well as an edge server for human presence detection training and testing. We have evaluated different hyperparameters and network settings as well as all the designed loss functions. In conclusion, our proposed BTS system shows superior performance with an averaged accuracy of around 98% in the human presence detection task when compared to existing SSL methods. Notably, our system reaches the asymptotic 98% accuracy of supervised learning, proving its effectiveness in reducing the labeling cost while maintaining high accuracy.

SECTION: V-BFuture Potentials

The proposed BTS system can be extended to more rooms, with each pair conducting the identical algorithm. Owing to multiple overlapped results, additional voting mechanism or fusion technique can be conducted to predict the most possible outcome. However, the increment of number of rooms indicates the higher AP deployment cost and higher overhead of data collection. Also, training of multi-BTS systems will lead to a higher computational complexity order.
We further notice that current model may face limitations in real-time or large-scale deployments, especially in resource-constrained environments. Such issues can be solved by designing techniques, including (1) model compression and pruning significantly reducing the parameter count and memory footprint while retaining performance, (2) knowledge distillation transferring the learned knowledge of the larger model into a smaller and more efficient one, and (3) optimizations specific to edge hardware such as advanced GPUs and tensor processing units (TPUs) to accelerate both training and inference processes.

Moreover, indoor layout may be complex and nearby corridors or aisles, where undesired people will be detected and regarded as interference. Such case requires further design by removing those undesirable data features. Once the data drift is much severe for the edge to recognize, it will be regarded as a new environment according to the predefined threshold. Therefore, reinforcement learning based technique can be further incorporated into BTS to dynamically measure and adjust the threshold of data drift detection and retraining period. Moreover, with larger room space, AP requires better deployment policy or more equipped antennas for optimally covering the whole space. Higher transmit power is also required for detecting the CSI signals. Under the fixed network architecture, deploying the cost-effective metasufaces having comparably higher channel diversities become a promising auxiliary[50]. Higher resolution of CSI data can be obtained with the aid of metasufaces. With higher dimension of data, more sensing tasks such as people counting, localization, and tracking can be simultaneously conducted.

SECTION: References