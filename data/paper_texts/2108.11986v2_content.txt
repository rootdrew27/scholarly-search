SECTION: Anomaly Detection in Medical Imaging - A Mini Review

The increasing digitization of medical imaging enables machine learning based improvements in detecting, visualizing and segmenting lesions, easing the workload for medical experts. However, supervised machine learning requires reliable labelled data, which is is often difficult or impossible to collect or at least time consuming and thereby costly. Therefore methods requiring only partly labeled data (semi-supervised) or no labeling at all (unsupervised methods) have been applied more regularly. Anomaly detection is one possible methodology that is able to leverage semi-supervised and unsupervised methods to handle medical imaging tasks like classification and segmentation. This paper uses a semi-exhaustive literature review of relevant anomaly detection papers in medical imaging to cluster into applications, highlight important results, establish lessons learned and give further advice on how to approach anomaly detection in medical imaging. The qualitative analysis is based on google scholar and 4 different search terms, resulting in 120 different analysed papers. The main results showed that the current research is mostly motivated by reducing the need for labelled data. Also, the successful and substantial amount of research in the brain MRI domain shows the potential for applications in further domains like OCT and chest X-ray.

SECTION: IIntroduction

The increasing digitization of medical imaging enables the collection of data and machine learning (ML) based approaches to aid medical experts. One powerful part of ML comes from supervised methods, using both data and corresponding labels in e.g. segmentation or classification models. However, since the collection of annotations (labels) is often times time consuming and thereby costly[1]as well as in many cases a confident ground truth even being unobtainable, their usability is reduced. Due to this, semi-supervised and unsupervised methods are applied. This is often achieved through anomaly detection.

Definitions:Pathologies in medical images can often be described as a rare deviance from a norm, or a non-anomalous (in the case of medical imaging mostly healthy) sample. This fits the definition of outliers (or anomalies) in the data, motivating the application of anomaly detection[2]. In this publication, the terms anomaly detection and outlier detection are used interchangeably. This is motivated by the fact that outliers are sometimes defined as valid but out of order datapoints, while anomalies also include further differences (e.g. different image capture modalities). Therefore outliers can be defined as a subset of anomalies. Anomaly detection can be separated intoclasses,point,collectiveandcontextualanomalies. Point anomaly detection is the task of recognizing a single anomalous point from a larger dataset. Most anomaly detection models handle point anomalies. Collective anomalies are anomalies that may not be identified as anomalies if viewed as a single point but as a set of many they form an anomaly. Contextual anomalies can only be recognized as anomalies if context is added. There are alsodifferent anomaly detection setups,supervised,semi-supervisedandunsupervisedanomaly detection. Supervised anomaly detection is comparable with classification using a very unbalanced dataset. Semi-supervised anomaly detection aims to train a model on only one, typically the normal (in our case healthy) class and then applies the model to both healthy and pathological data, reporting the corresponding scores. Unsupervised anomaly detection uses both, normal and anomalous data, does not make use of labels at all and works purely on intrinsic properties of the dataset (using distances or densities)[3]. In anomaly detection, the usage of semi-supervised and unsupervised anomaly detection (UAD) is confused, and repeatedly applied to both semi-supervised and unsupervised methods. We believe that the separation into semi-supervised (healthy data being clearly defined) and unsupervised (no definition of labels at all) makes sense and advise to use this terminology as also pointed out by[3].

Deviation based anomaly detection:Anomaly detection using medical image data, e.g. computed tomography (CT) scans, is typically performed using either convolutional neural network (CNN) based feature extractors, followed by one-class (OC) classifiers or deviation based methods like autoencoders (AEs)[4,5,6]or even more recently, generative adversarial network (GAN)[7,8,9]based methods. Both AEs and GANs use convolutional kernels, however their applications in the sense of deviation based anomaly detection are fundamentally different to CNN based feature extractors. In order to generate deviation based scores from an AE, the encoder of the encoder-decoder based neural network typically encodes a sample image into a lower dimensional latent space, also called a bottleneck. The decoder uses this latent space representation to recreate the sample and a deviation between the sample and the reconstruction can be calculated. During training, this deviation is used to backpropagate and update the network. The AE in an anomaly detection setting is trained using healthy data to en- and decode features of healthy samples, leading to a higher deviation for non-healthy samples, assuming that there is a difference between the learned healthy and the lesioned latent space[10].
GANs can also be used to facilitate a deviation based score. In addition to training a generator and a discriminator in an adversarial setup, an additional encoder needs to be trained, mapping the generated image back to the latent space (input to generator)[7]. By doing this, any input image can be mapped to a latent space and reconstructed into an image using the generator. This results in a reconstruction which can be used to facilitate a reconstruction loss.

Additionally there are conventional methods to facilitate anomaly detection, using e.g. z-score thresholds[11,12], boxplots[13]or methods built on the ideas of principal components analysis (PCA)[14,15]. OC support vector machines (SVM)s[16]are one of the most known semi-supervised anomaly detection methods. In principle they apply the ideas of SVMs (using hyperplanes to separate two classes using support vectors with the aim of generating the largest possible margin) to a OC problem. One possibility to achieve this is to model a hypersphere to encompass all support vectors, creating the smallest possible hypersphere.

Contribution:This papers contribution is the analysis of the current state of anomaly detection in medical imaging. Using this analysis, we show lessons learned and give an outlook for future applications and research targets.

SECTION: IIMethod

The method used was a semi-exhaustive literature review based on Randolph[17]. The formulated problem was the evaluation of anomaly detection in medical imaging. For data collection, the search engine Google Scholar was used. In order to obtain meaningful results, the search termsanomaly detection in medical imaging,unsupervised anomaly detection in medical imaging,outlier detection in medical imagingandunsupervised outlier detection in medical imagingwere chosen. From these results the following criteria for exclusion were chosen. Only the firstpages of results (sorted by relevance,articles per page) were used. Further, the criteria for exclusionduplicate,in context of medical imaging (in abstract, title or conclusion),peer-reviewanddatewere identified. Since the search terms were similar,duplicateshad to be removed. Papers without a clear focus onmedical imagingin the abstract, title or conclusion were also removed. A further criterion was to only includepeer-reviewedresearch items. This mainly lead to the exclusion of preprints. The data timeframe was set to not include papers after the resurgence of deep-learning (AlexNet[18]) and to still include papers after the U-net was proposed[19], resulting in a timeframe of JanuaryJuly. This lead to a reduction of papers fromto. Since these papers also includedsurvey papers, the final number of application based research papers was. These survey papers were used as a qualitative comparision to the our extracted lessons learned. Next, the papers were manually clustered with respect to their imaging method and the following information was extracted:Aim,Applied MethodandResults. From these clusters, lessons learned were extracted, which are reported in sectionIII.

SECTION: IIIResults

The semi-exhaustive literature review resulted inresearch items, from which furtherwere removed due to not containing applications in medical imaging (only exemplar stated in abstract) or being non-available. The resulting papers were further clustered intocategories (corresponding to Tab.I-Vby their imaging methods. Tab.Ishows papers applying anomaly detection to occular medical images with retinal fundus images and optical coherence tomography (OCT). Tab.IIfocuses on papers with applications in the center body region, with chest X-rays and mammography. Tab.IIIsummarizes application papers, using CT and functional magnetic resonance imaging (fMRI). Tab.IVdisplays papers applying ML to brain Magnetic resonance imaging (MRI) datasets. Tab.Vshows mixed applications from the domains of breast ultrasound, chest radiographs, histology and fundus images as well as multi-spectral imaging (MSI).

Overall, these tables show a narrow field of application with() of all selected papers working on MRI scans of the brain. Furtherpapers use fMRI and CT scans of the brain, increasing the amount of brain image data based applications to. Further clusters could be observed using chest X-rays and mammography, as well as ocular imaging techniques, especially OCT. Of note is, that although medical imaging includes methods like histology, onlypaper[20]applied anomaly detection to such data. A further result is the relevance of deviation based methods, withpapers () applying some form or adaptation, mostly using autoencoders AEs or GANs[21,22,23,20,24,7,8,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,9,40,41,42,43]. Investigating MRIs,[44,45,37,39,40,42,43]of thepublications using brain MRI data focus explicitly on tumours or metastases, showing the usefulness of anomaly detection and segmentation of tumours in brains using MRI. Most other brain MRI based methods more generally handle the task of lesion classification or segmentation with only two focusing specificly on cerebral small vessel diseases[46,41]. A further cluster uses X-ray for the detection of pneumonia[23,47]or lung disease like COVID-19[15]. Several advancements have also been made in OCT segmentation of retina lesions[48,7,8,25,26], with one publication performing visual touring test usingexperts, which were unable to recognize differences in the correctly reconstructed data[8]. Breast cancer and pathology detection was also improved using anomaly detection[29,49,28].

One result of this analysis is the statement that anomaly detection can be motivated by the lack of available labelled training data, which was stated inpublications. The reported results of these papers proved that these semi- and unsupervised approaches successfully completed their tasks[29,7,8,26,49,41,25,22,48,40,20,38,24,44,36,28,14,31,33]. However, some papers also show semi-supervised methods outperforming fully supervised methods. These outperforming methods are based on classical feature extraction followed by multiple-instance learning (MIL) based models[49], through adaptations to GANs[27](using skip-connections and weight-sharing subnetworks) and through the adaptation of AEs to the SegAE model[32](using pairs of T1-w, T2-w and FLAIR data for improved anomaly detection). For this improvement in comparison to fully supervised models, Khosla et al.[32]reason that fully supervised methods systematically either under or overestimate lesion volumes (when segmenting lesions), while their proposed method was reported to be free of this bias.

Zhang et al. and Kim et al. both show interesting approaches, applying conventional feature extractors (CNN and edge detection) with further OC classifiers (fully connected neural networks and recurrent neural networks). By using these methods both papers reach relatively high scores, but still lower scores then their CT based baselines.

A further finding is the obvious bias in the amount of research items regarding OCT, chest X-Ray, mammography and Brain MRI. An investigation in the used datasets shows a strong dataset and community driven effect. For all of the above mentioned image categories, datasets are publicly available. Further, a community driven effect can be observed, comparing new models against older ones, evaluated on the same dataset.

In addition to medical image based application papers, several authors proposed improvements to the general anomaly detection pipelines.papers showed an improvement of subsequent methods by removing anomalies from the data or reducing complexity in the data[11,12,14]. Also, constraint programming is shown successfully by Kuo et al.[50]. showing further approaches to perform anomaly detection. CycleGAN is also shown to work for transforming images into a space that showed reduced image artefacts[31]. Heer et al.[38]showed issues with the general idea of anomaly detection and their application of anomalies as out-of-distribution (OOD) data, remarking a blind spot using deviation based methods. They state that denoting anomalies as OOD is dangerous, since non anomalous data from different sensors or image modalities may also be detected as OOD although this data not being anomalous. In their paper they further present a method based on prior knowledge to disentangle lesion based OOD from non-lesion based counterparts.

SECTION: IVDiscussion

In this paper we analysed the current state of research in anomaly detection using medical image data and extracted lessons learned. To accomplish this, a semi-exhaustive literature review was performed, resulting in 120 papers, from which 44 were further investigated (after filters were applied). This resulted inmajor clusters of image domains, with the brain MRI domain comprisingof all papers.

One takeway is that especially in the brain MRI domain, both lesion and tumour classification as well as segmentation have been successfully implemented multiple times. It is shown that both AE and GAN based methods as well as Gaussian mixture models, hidden Markov models and CNNs with specific feature extractors can work in this anomaly detection setup. This was further shown to be the case with chest X-ray, mammography as well as OCT data. Extrapolating from these results, first approaches in similar domains, using anomaly detection for tasks in the domains of e.g. CT scans of the skeleton or spines seem promising and should be investigated. Also, an investigation of the suitability for histological data would be of high interest, since histological data was very under-represented (publication). However, there are multiple differences between CT/MRI and histology. In histology it is not sufficient to detect a large object (e.g. tumor) which is indicated by different intensity values. It would rather be important to learn the shape and interaction of nuclei and cells which is supposed to be a more challenging task, relying more on high frequency information which is a reported weak point of several proposed deviation based mehtods. Further, histology images are extremely high resolution, leading to issues using current GAN or AE based anomaly detection. Å tepec et al.[20]show one way to circumvent these issues successfully using patch extraction and MIL.

As reported in the results, there were some semi-supervised anomaly detection models that resulted in higher or similar scores than their fully supervised alternatives. One interpretation is that, especially regarding segmentation, human labelled segmentation masks with rough edges may introduce bias. This is however still unclear and should further be investigated.

Another useful takeaway is that not only improvements to state of the art (SOTA) models are needed but also simpler models or cheaper image modalities can be a major improvement, even if the SOTA scores cannot be reached e.g. replacing CT with X-ray based methods. One example was shown by Zhang et al.[47]who used X-ray images, approaching relatively high scores. Although their method did not outperform the CT based baselines, the methods is still of high significance, since it reached similar levels using X-rays requiring a lower radiation dose and an more available imaging method.

As stated by[52]we also recognized the generation of free and comparable datasets as a high priority to facilitate further research. The fast growing brain MRI community showed, that open datasets are an important asset to boost research. Therefore the development and open distribution should be pursued for different medical image domains. In order to facilitate anomaly detection research, a semi-supervised dataset (only including a small amount of annotations) should be developed.

A disadvantage, reported by several deep learning based approaches was[30,44], that results were still unstable and more research was needed before a clinical application could be performed. This however was not always the case[22]but there are still doubts in the clinical applicability of deep learning based anomaly detection methods. Large clinical application studies would be needed to show their suitability.

Conclusion:In this paper we investigated the current state of research in medical image based anomaly detection and generated lessons learned. The lessons learned can be converted into the following future targets:a very narrow domain of application that should be expanded,development of freely accessible datasets,investigation of the OCT blindspotandimprovements of working approaches like constraints on the AE bottleneck.

SECTION: Acknowledgment

This work was partially funded by the County of Salzburg under grant number FHS-2019-10-KIAMed.

SECTION: References