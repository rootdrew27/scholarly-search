SECTION: Probing Three-Dimensional Magnetic Fields: IV - Synchrotron Polarization Derivative and Vision Transformer
Measuring the 3D spatial distribution of magnetic fields in the interstellar medium and the intracluster medium is crucial yet challenging. The probing of 3D magnetic field’s 3D distribution, including the field plane-of-sky orientation (), the magnetic field’s inclination angle () relative to the line of sight, and magnetization (the inverse Alfvén Mach number), at different distances from the observer makes the task even more formidable. However, the anisotropy and Faraday decorrelation effect in polarized synchrotron emission offer a unique solution. We show that due to the Faraday decorrelation, only regions up to a certain effective path length along the line of sight contribute to the measured polarization. The 3D spatial information can be consequently derived from synchrotron polarization derivatives (SPDs), which are calculated from the difference in synchrotron polarization across two wavelengths. We find that the 3D magnetic field can be estimated from the anisotropy observed in SPD: the elongation direction of the SPD structures probesand the degree of SPD anisotropy, along with its morphological curvature, provides insights intoand. To extract these anisotropic features and their correlation with the 3D magnetic field, we propose utilizing a machine learning approach, specifically the Vision Transformer (ViT) architecture, which was exemplified by the success of the ChatGPT. We train the ViT using synthetic synchrotron observations generated from MHD turbulence simulations in sub-Alfvénic and super-Alfvénic conditions. We show that ViT’s application to multi-wavelength SPDs can successfully reconstruct the 3D magnetic fields’ 3D spatial distribution.

SECTION: Introduction
Polarized synchrotron emission is a fundamental tool for investigating magnetic fields across diverse astrophysical environments, including the interstellar medium (ISM;), the circumgalactic medium (CGM;), and the intracluster medium (ICM;). It provides essential insights into cosmic ray physics, galactic dynamics, and galaxy cluster evolution. Given its broad application and crucial importance, getting more detailed information from synchrotron polarization is extremely important.

Synchrotron polarization is predominantly used to trace the plane-of-the-sky (POS) magnetic field orientation. Further, combining synchrotron data across different frequencies has been proposed as a method to trace variations in the POS magnetic field along the line of sight (LOS).introduced the Faraday Tomography (FT), suggesting that multi-layer magnetic field structures could be reconstructed via a proper Fourier transform of the synchrotron polarization data.noticed that synchrotron polarization structures tend to get elongated along the magnetic field, a consequence of anisotropy in magnetohydrodynamic (MHD) turbulence. This characteristic elongation serves as a tracer of the POS magnetic field orientation. Expanding upon this, the Synchrotron Polarization Gradient (SPG;) technique has been developed. In the presence of Faraday Rotation, the polarized synchrotron emission is collected from a certain effective depth determined by the Faraday effect. SPG thus were introduced as a way to trace the POS magnetic field’s variation along the LOS by utilizing multi-frequency synchrotron polarization observations.

While the traditional methods focus on tracing the POS magnetic field orientation,find that the 3D magnetic fields—which include the POS orientation, the magnetic field’s inclination angle relative to the LOS, and magnetic field strength—are already encoded in synchrotron emission maps, because the anisotropy, or elongation along the magnetic field line, is inherently a 3D phenomenon. Therefore, the observed POS anisotropy, or the topology of synchrotron intensity structures, is affected by the projection effect, which is determined by the inclination angle, as well as by the magnetization level of the medium.
Building upon these theoretical insights,proposed using Convolutional Neural Networks (CNNs;) to extract the anisotropic features within synchrotron intensity maps and thereby enable the tracing of 3D magnetic fields.

However, this CNN approach using synchrotron emission maps traces only the 3D magnetic fields averaged along the LOS. The magnetic fields’ variations along the LOS are not determined. Thus, to fill the gap, in this work, we aim to develop a machine-learning approach to measure 3D magnetic fields’ 3D spatial distribution. This is achieved by the combination with multi-wavelength synchrotron polarization observations which are subject to the Faraday decorrelation effect. This effect restricts the polarization information to a wavelength-dependent effective path length along the LOS. Consequently, the difference between synchrotron polarization at two wavelengths, i.e., the synchrotron polarization derivatives (SPDs), provides unique insights into the signal’s spatial distribution along the LOS, enabling the reconstruction of the magnetic fields’ 3D distribution.

Furthermore, we propose utilizing a Vision Transformer (ViT;) model. The transformer architecture, widely recognized for its success in natural language processing through applications like the Chat Generative Pre-trained Transformer (ChatGPT;), has been adapted to ViT for 2D image processing. Compared with the CNN architecture, ViT’s capability to handle complex data structures makes it particularly suitable for extracting and interpreting the anisotropic synchrotron structures that are correlated with 3D magnetic fields. Furthermore, our goal extends beyond algorithmic application; we seek an understanding of which features are indicative of magnetic field properties, why these features are significant, and the fundamental physical principles they represent.

This paper is organized as follows: §outlines the fundamental aspects of MHD turbulence anisotropy observed in synchrotron polarization and their correlation with 3D magnetic fields. It further describes our approach for capturing the 3D magnetic field variations along the LOS using multi-wavelength SPDs. §provides an overview of the 3D MHD simulations and the synthetic synchrotron observations utilized in this study, including details of our ViT model. In §, we present the results of the anisotropy analysis for SPDs and the 3D magnetic fields obtained from the ViT model. §delves into discussions on the potential of the ViT-SPDs methodology, as well as various physical problems that could benefit from insights into 3D magnetic fields. We conclude with a summary of our findings in §.

SECTION: Theoretical consideration
SECTION: Anisotropy in MHD turbulence: turbulent eddies are elongating along local magnetic fields
Fluctuations induced by MHD turbulence were initially considered isotropic, disregarding the influence of magnetic fields. However, subsequent analyticaland numerical studiesas well as solar wind in situ measurementshave provided the modern understanding of MHD turbulence with scale-dependent anisotropy.

The revolutionary change in understanding this anisotropy is related to the ”critical balance” condition, formulated by(hereafter GS95), which posits a balance between the turbulence cascading time and the Alfvén wave period:

whereis the Alfvén speed, withandbeing the magnetic field and gas density, respectively, whileandare the components of the wavevector parallel and perpendicular to the mean magnetic field.

However, this generally accepted picture requires an important correction. In LV99 picture of turbulent reconnection, magnetic turbulent eddies freely rotate perpendicular to the direction of the magnetic field percolating the eddy. Thismagnetic field does not coincide with the mean magnetic field. Thus, all the measurements should be done in the local magnetic field reference frame:

whererefers to the turbulent velocity at the scalemeasured in the local system of turbulent eddies. The local system of reference was explicitly introduced in the pioneering study by.

LV99 argues that turbulent reconnection of magnetic fields, occurring within an eddy turnover time, promotes magnetic line mixing perpendicular to their orientation, thus minimizing resistance to turbulent cascading. This process enables eddies to cascade efficiently perpendicular to the local magnetic field direction, which predominantly follows the Kolmogorov law in strong turbulence regime:, whereis the injection velocity at injection scaleandis the Alfvén Mach number. The strong turbulence regime in sub-Alfvénic turbulence (1) spans from the transitional scaleto smaller scales. Turbulence within the range fromtois termed weak turbulence, which is wave-like and does not obey the ”critical balance”. The weak turbulence is also anisotropic, but the scaling relation is different from Eq..

Adapting the ”critical balance” condition in the local frame and integrating the Kolmogorov relationship in the strong turbulence regime, one can derive the the scale-dependent anisotropy scaling:

Eq.reveals the anisotropic nature of turbulent eddies, withfor velocity fluctuation contours. Or equivalently,
the anisotropy indicates more significant perpendicular than parallel velocity fluctuations at the same scales. The relationships for density and magnetic field fluctuations can be derived from the linearized continuity and induction equations in Fourier space:

where density, magnetic field, and velocityare described as a sum of their mean and fluctuating parts:,, and, whereanddenote the mean density and mean magnetic field strength, while the mean velocity field.

Considering the dispersion relation for Alfvénic turbulence isand the displacement vector’s time derivative gives the velocity vector, we obtain:

whereandrepresent the unit wavevector and displacement vector, respectively.denotes the inverse Fourier transform. The density and magnetic field fluctuations induced by turbulence are proportional to the velocity fluctuations and predominantly by their perpendicular components at given scales. One numerical example is given in Fig.. The structures/contours of density, magnetic field, and velocity are elongating along the local magnetic fields.

For super-Alfvénic scenarios (), turbulence nears isotropy due to the diminished dynamic importance of magnetic fields. Turbulent energy cascades from larger to smaller scales, gradually reducing turbulent velocity untilapproximates unity at the transition scale, derived as:

Below, magnetic field effects become significant, manifesting anisotropy as described by Eq.. However, above,noted a different type of anisotropy where weak magnetic fields, easily bent or influenced by turbulent flows, align with these flows. Consequently, the structures/contours of density, magnetic field, and velocity at large scales are still elongating along the local magnetic fields.

SECTION: Anisotropy of MHD turbulence is imprinted in synchrotron emission and polarization
The intrinsic relationship between synchrotron emission and the density of relativistic electrons and magnetic fields ensures that the properties of MHD turbulence are reflected in the observed synchrotron intensity and polarization structures. The observed intensityand polarized emissionat wavelengthare expressed as:

whereandrepresent spatial coordinates,is the frequency,is the integration length. The termsanddenote synchrotron emissivities perpendicular and parallel to the POS magnetic field, respectively. The Faraday rotationis given by:

whereis the thermal electron number density in,represents the LOS magnetic field component inG, and the path lengthis measured in parsecs.

Further expansion ofandreveals the intrinsic synchrotron emissionand intrinsic polarization, described by the Stokes parametersand, as follows:

whereindicates the relativistic electron number density, anddenotes the spectral index of the electron energy distribution:

withrepresenting the electron number density per unit energy interval. The pre-factoris derived by integrating Eq.to obtain the total electron number density.

Moreover, as indicated in Eq., when describing the density and magnetic field as a sum of their mean and fluctuating components, their fluctuations are predominantly perpendicular to the magnetic field, due to the anisotropy of MHD turbulence (see Eq.). The expressions in Eq.suggest that fluctuations in synchrotron emission intensity and polarization are determined by these in the magnetic field and density.
The dependence of the synchrotron properties on the spectral indexwas studied by. There, synchrotron fluctuations for an arbitrary index are analytically shown to be anisotropic reflecting the statistics of MHD turbulence. Other constant factors at a givenare not explicitly detailed in Eq., as they do not alter the characteristics of these fluctuations. Consequently, the fluctuations inandexhibit pronounced anisotropy, showing more significant fluctuations perpendicular to the magnetic field. This anisotropy implies that the contours of synchrotron intensity and polarization—essentially the structures of these emissions—elongate along the magnetic field lines, thereby indicating the orientation of the magnetic field.

SECTION: Projection effect: retrieving 3D magnetic field information
The anisotropy in intrinsic synchrotron emission and intrinsic polarization (see Eq.) suggests that the structures of either synchrotron emission or synchrotron polarization are elongating along the 3D magnetic fields in 3D space. However, in addition to the effect of Faraday rotation, the observed polarization is subject to the projection along the LOS. The observed synchrotron structures are therefore elongating along the projected magnetic fields on the POS.

The projection effect alters the observed anisotropy degree, defined as. Fig.presents a cartoon illustration of how the 3D magnetic field’s inclination anglerelative to the LOS changes the observed anisotropy. Structures 1 and 3—showcased in panels (a) and (c)—possess equivalent magnetizations, but different inclination angles with. The observed anisotropy of Structure 1 is therefore smaller than that of Structure 3. Therefore, the elongation directiongives the POS magnetic field orientation, while the observed anisotropy degree contains the information on the magnetic field’s inclination angle. This also modifies the observed anisotropy as discussed in.

On the other hand, in the presence of fluctuations, magnetic field lines are not straight but exhibit curvature. This curvature is naturally inherited by the elongation of synchrotron structures along the curved magnetic fields in 3D space. However, the curvature of both the magnetic field lines and the elongation of these structures is also subject to the projection effect. Consequently, the morphological curvature in the observed synchrotron structures provides additional insights into the magnetic field’s inclination angle.

The observed degree of anisotropy is influenced not only by projection effects but also by the medium’s magnetization, defined as. According to Eq., the degree of anisotropy in synchrotron structures is more pronounced in environments with strong magnetization. Conversely, a weak magnetization leads to a lower degree of anisotropy as the magnetic field’s back-reaction on turbulence becomes less dynamically significant.

Additionally, as illustrated in Fig., the magnetization of the medium is also reflected in the curvature of the magnetic field lines. In a weakly magnetized medium, significant magnetic field fluctuations allow for easier bending of the magnetic field lines, resulting in more pronounced curvature in both the field lines and the associated synchrotron structures. Within a domain of strong magnetization, magnetic field lines exhibit minimal deviation resulting in predominantly straightened topology.

In summary, the observed anisotropy in synchrotron emission or polarization (also its derivative) has three important implications:

Synchrotron structures are predominantly elongated along the local magnetic field lines, making the elongation a indirect probe of the POS magnetic field orientation.

The observed degree of anisotropy is closely associated with the magnetization level and the magnetic field’s inclination angle.

The observed morphological curvature of synchrotron structures is sensitive to both magnetization and inclination angle.

Consequently, by analyzing the elongation direction, the degree of anisotropy, and the morphological curvature of the observed synchrotron structures, we can retrieve the 3D magnetic field information, including the POS orientation, the magnetization level, and the inclination angle.

SECTION: Effect of Faraday rotation: obtaining 3D spatial information from synchrotron polarization derivative
The observed polarization, encoded with the anisotropy of MHD turbulence, is affected by the Faraday rotation, which depends on thermal electron number density, LOS magnetic field strength, and the integration length. The Faraday rotation becomes increasingly significant along the LOS. This rotation results in Faraday depolarization, reducing the observed polarization, and Faraday decorrelation, diminishing the correlation of polarization fluctuations. Beyond the effective path length, Faraday decorrelation is substantial such that the fluctuations of polarized synchrotron emission become uncorrelated, contributing only noise-like signals. The condition for determiningis expressed as:

indicating thatis wavelength-dependent. Based on this criterion, weak and strong Faraday decorrelation regimes are distinguished byand, respectively. Only the region wherecontributes useful information to the observed polarization.

Fig.illustrates a synchrotron emitting region observed at two different wavelengths,and. The effective lengths of polarization,and, correspond toand, respectively. Regions beyondandare predominantly contaminated by strong Faraday rotation, effectively introducing only noise. Therefore,andcollect polarization signals only up toand, respectively. A numerical example of the polarized synchrotron emission map at different frequencies is given in Fig.. At a low frequency of 10 MHz, the map exhibits significant Faraday rotation, resulting in a predominantly noise-like observed polarization due to the decorrelation of the fluctuations. In contrast, the high-frequency map at 310 MHz experiences minimal Faraday rotation, allowing the observed polarization map to sample a longer path length along the LOS. Consequently, the structures in this high-frequency map appear more coherent and correlated.

The effect of Faraday decorrelation allows for the use of multi-wavelength observations to sample only the emitting region betweenand, thus obtaining 3D spatial information about the polarization. This is facilitated by calculating the synchrotron polarization derivative (SPD). When the difference,, betweenandis not small, the zero-order approximation yields:

thereby quantifying the variations in polarization due to differences in wavelength and elucidating the spatial distribution of polarization across different depths. Alternatively, whenclosely approaches, the derivative is given by:

whereis weighted by, enhancing the emphasis on contributions from the Faraday rotation measure. For broader observational application and simplicity, we focus on the synchrotron polarization derivative as defined in Eq..

SECTION: Methodology
SECTION: MHD simulations and synthetic synchrotron observations
The MHD numerical simulations used in this study were conducted using the ZEUS-MP/3D code, as detailed by. We conducted an isothermal simulation of MHD turbulence solving the ideal MHD equations within an Eulerian framework, accompanied by periodic boundary conditions. Kinetic energy was solenoidally injected at a wavenumber of 2 to simulate a Kolmogorov-like power spectrum. The turbulence was actively driven until a state of statistical equilibrium was achieved. The computational domain was discretized into a grid ofcells, with numerical dissipation of turbulence manifesting at scales ranging from approximately 10 to 20 cells.

Initial conditions for the simulations include a uniform density field with a uniform magnetic field oriented along the-axis. Subsequently, the simulation cubes are rotated to align the mean magnetic field inclination relative to the LOS, or the-axis, at angles of,, and. Scale-free turbulence simulations are characterized by the sonic Mach number,, and the Alfvénic Mach number,. To accommodate various physical scenarios, initial settings of density and magnetic field strength were varied, generating a range ofandvalues. These simulations are referred to throughout the paper by their designated model names or key parameters, as listed in Tab..

To generate synthetic synchrotron observations from our simulations, we use the density fieldand the magnetic field. The calculations for synchrotron intensityand polarizationare based on Eq.. Given the relative insensitivity of synchrotron emission to variations in the electron energy distribution’s spectral index, as noted by, we assume a homogeneous and isotropic electron energy distribution with a spectral index.

SECTION: Vision Transformer (ViT)
In this work, we design a Vision Transformer (ViT;) model to process synchrotron maps, extract morphological features, and output the magnetic field’s POS orientation angle, inclination angle, and the Alfvén Mach number, by using the transformer architecture (see Fig.). It starts with an input layer that accepts maps of synchrotron polarization derivative. The ViT can be separated into three stages:

The input layer accepts maps of synchrotron polarization derivatives. The map is divided into smaller, non-overlapping patches, which contain information on local features. The patches are then flattened and linearly projected into a higher-dimensional space, creating patch embeddings. Positional encodings are added to these embeddings to retain spatial information about the original map structure.

The sequence of patch embeddings is processed through eight transformer blocks. Each block comprises a normalization stepfollowed by a multi-head self-attention mechanism, allowing the model to focus on different parts of the input simultaneously. After the attention mechanism, a residual connection is added, and the output is passed through a multi-layer perceptron (MLP;) that includes two dense layers with a non-linear activation function and dropout for regularization. Another residual connectionfollows this MLP, ensuring effective model training. During this stage, the model learns the correlation of local features with the magnetic field.

The final output of the transformer layers undergoes layer normalization and global average poolingto condense the feature information into a single vector. This vector is then passed through a dense layer, known as the classification head, which outputs,, and.

Compared with the earlier CNN models, which rely on convolutional layers to capture local features and hierarchical representations, the ViT model uses self-attention mechanisms to integrate information across the entire input map. That means every patch of the map can directly interact with and learn from every other part, instead of relying on only single local information. ViT, thus,
can provide a more holistic understanding of the data and a more accurate estimation.

The trainable parameters of the ViT are optimized using a typical deep learning approach, where the mean absolute error of the 3D magnetic field prediction serves as the training loss function for backpropagation. Additionally, we implement two strategies to enhance the diversity and randomness of the training dataset, which are essential for improving the ViT’s generalization across varying physical conditions.

One effective technique is random cropping, which involves extracting smaller patches of sizecells from the input images. This method not only enlarges the dataset but also introduces varied perspectives, thereby enhancing the model’s exposure to different features within the maps of synchrotron polarization derivative. The choice ofcells is deliberate to mitigate the effects of numerical turbulence dissipation and maintain high-resolution prediction. As studied by, different sizes do not impact deep learning models’ accuracy after sufficient training, but only the output magnetic field map’s resolution.

Furthermore, images exhibit a lack of rotational invariance from the computational model’s perspective. Since each image cell corresponds to an element in a matrix, rotating an image changes the matrix’s element arrangement, presenting the image as novel data to the model. This property is utilized in two ways: first, by randomly rotating the-cell patches to further augment the training dataset, and second, by using the original, unrotated datasets for validation, thereby generating a prediction test scenario.

For each training iteration, approximately 0.2 million sub-fields are fed into the ViT model. We conducted 100 training iterations, continuing until the loss function indicated saturation, suggesting that the model parameters had converged effectively.

SECTION: Training images
Our training input is a SPD map,. The-cells SPD map is randomly segmented into-cell subfields for input into the ViT model. For each subfield, we also generate corresponding projected maps of,,, andas per the following:

whereis the total magnetic field strength, and,, andare its,, andcomponents.andare determined by the conditions:

whereandare chosen so that the difference in their corresponding frequencies is 30 MHz.andare the mass density and magnetic field strength averaged within the range ofandfor every sub-field.andare defined using the local velocity dispersion for each sub-field betweenandalong the LOS (i.e.,), rather than the global turbulent injection velocityused to characterize the full simulation. The ranges ofandaveraged over the subfield in each simulation are listed in Tab., while the range of local inclination anglespans from 0 to 90∘. These values of,, andcover typical physical conditions of diffuse medium.

SECTION: Results
SECTION: Fluctuations in SPDs are anisotropic
We present a numerical example of SPD’s anisotropy (see §) in Fig.. The SPD is calculated between 280 MHz and 310 MHz maps. In a strongly magnetized medium (e.g.,,), the structures appear more filamentary and anisotropic. As the magnetization weakens (e.g.,,), the anisotropy degree decreases. When the magnetic field is not perpendicular to the line of sight (e.g.,,), the topology of the field lines and the projected synchrotron structures undergo significant changes.

Fig.presents the anisotropy ratio derived from the SPD maps. These derivatives are calculated across a frequency range from 10 MHz to 310 MHz in increments of 30 MHz. To assess the anisotropy, we calculate the second-order structure functionof themap and decompose the structure function into components parallel and perpendicular to the local magnetic fields, using the method proposed in. The formulation is as follows:

wheredenotes the POS component of the magnetic field, utilized to define the local field direction. Here,is aligned parallel, andperpendicular, to, such that. We determine thevalue satisfying the conditionto calculate the anisotropy ratio.

The upper panel of Fig.demonstratesandcan change the anisotropy ratio within the SPD map. Whenis small andis large, indicative of a strong magnetic field and minimal projection effect, the structures within the map appear as narrow strips (see Fig.), oriented along the POS magnetic fields, leading to a high anisotropy ratio,. Conversely, an increase in, which signifies a weakening of the magnetic field, results in a decrease in. A smaller, implying a magnetic field orientation closer to the LOS, reduces the observed anisotropy due to projection effects. This results in less pronounced elongation along the POS magnetic fields and a lower anisotropic ratio.

Furthermore, the lower panel of Fig.shows the anisotropy ratioacross a frequency range from 40 MHz to 310 MHz. It is observed thatconsistently exceeds unity, indicating that the structures within the derivative maps predominantly elongate along the magnetic field lines, affirming an anisotropic nature. A strongly magnetized medium also exhibits more pronounced anisotropy. However, the ratio at frequencies below 100 MHz has more variations, due to substantial noise-like contribution from Faraday rotation.

SECTION: Comparison of ViT-estimated 3D magnetic field and actual magnetic field
Fig.shows a comparative visualization between the actual 3D magnetic fields derived from simulations and those predicted by the trained ViT model. The 3D magnetic field segment in Fig.is constructed fromand, with a superimposed color representation indicating. The simulation has a globalandbutis varying along the LOS. SPD maps at frequencies of 310, 280, and 250 MHz provide insights into the magnetic field structures at distances between [0.49, 0.60], [0.39, 0.49], and [0.30, 0.39], respectively, along the LOS. This enables the reconstruction of the 3D magnetic fields’ 3D spatial distribution.

A comparison with the actual magnetic field parameters within the simulation—globaland—reveals a general alignment between the orientations of the ViT-estimates and the actual 3D magnetic fields. Althoughis varying, the ViT is able to capture the changes and recover the magnetic fields’ variation along the LOS. Furthermore, the actual local sub-fieldis calculated using small-scale local velocity dispersions specific to sub-fields betweenandalong the LOS, resulting in values that are smaller than the global. Among our examinations, the median values of ViT-estimatedare 0.1 to 0.2 smaller than the actual measurements, indicating a underestimation by the ViT model. Especially, when localvariation is significant, the ViT-estimated localcould be more significantly underestimated.

SECTION: Uncertainty of the ViT-estimated 3D magnetic fields
Fig.shows the absolute differences between the ViT-estimated and the actual 3D magnetic field parameters, denoted as,, and.
In the sub-Alfvénic case (), the median values ofandpredominantly range from 0 to 5∘and 0 to 10∘, respectively, across various frequencies. This reflects a close alignment between the ViT estimates and the actual measurements under sub-Alfvénic conditions. The medianis 0.05 - 0.1. Asincreases to 1.21 in a super-Alfvénic condition,andexpand to ranges of 0 to 20∘and 0 to 15∘, respectively. Despite the broader distribution ofunder these conditions, its median value remains consistent at around 0.1. This indicates that the ViT model, compared to earlier CNN models utilized for tracing 3D magnetic fields via synchrotron emission and spectroscopic observations, is better in estimating.

SECTION: Discussion
SECTION: Comparison with other 3D magnetic field tracing approches
Probing 3D magnetic fields, including the field’s POS position angle (), inclination angle () with respect to the LOS, and total magnetization level (), through machine-learning approaches is rapidly growing.proposed the use of Convolutional Neural Networks (CNNs) to extract spatial features, including the elongation direction, anisotropy degree, and morphological curvature, within spectroscopic observation and thereby enable the tracing of 3D magnetic fields. This method is particularly effective for analyzing atomic and molecular emissions within our Galaxy and nearby galaxies.

expanded the CNN methodology to synchrotron emission observations, which are insensitive to Faraday rotation. Importantly, this study confirmed the robustness of the machine-learning approach even with high-spatial frequencies, making it well-suited for interferometric data that lack single-dish measurements. Furthermore, the CNN model proved capable of extracting useful information from synchrotron emissions and probing 3D magnetic fields, even under conditions of noise with a signal-to-noise ratio greater than unity. It therefore shows great promise for tracing 3D magnetic fields in varied astrophysical settings from ISM, CGM, to ICM.

In this study, we introduce a Vision Transformer (ViT) model designed to estimate the 3D spatial distribution of 3D magnetic fields from synchrotron polarization observations. Especially, we derive the 3D spatial information from the synchrotron polarization derivatives (SPDs): Synchrotron polarization is subject to Faraday decorrelation effects, limiting information to a certain effective path lengthalong the LOS. This means only the regions up to the wave-length dependentcontribute to the measured polarization. The difference between synchrotron polarization at two wavelengths, i.e., the SPDs, thus provides insights into the signal’s spatial distribution along the LOS.

The 3D magnetic field is estimated from the SPDs’ anisotropy: (1) the observed SPD structures are predominantly elongated along the local magnetic field lines, making the elongation a direct probe of, (2) SPD’s anisotropy degree is closely associated with, and the projection effect induced by, (3) the observed morphological curvature of SPD structures is sensitive to bothand. Applying ViT to SPDs allows the extraction of the SPD’s features and their correlations with the 3D magnetic field, and thus achieves the reconstruction of the 3D spatial distribution of the 3D magnetic fields. Additionally, compared to the CNN approach, the ViT model provides a more accurate estimation of. Furthermore, it should be noted that while the anisotropy alone cannot definitively discern whether the magnetic field is oriented toward or away from the observer, Faraday rotation measurements associated with SPDs potentially can provide the information.

In addition to the machine learning methodology, the Faraday Tomography (FT;) is proposed to trace multiple layers of POS magnetic field orientation along the LOS by analyzing synchrotron polarization at multiple frequencies in the presence of Faraday rotation. It offers high precision but requires extensive frequency coverage and high resolution.proposed the use of polarized dust emission to constrain the inclination angle averaged along the LOS, based on the depolarization effect.further extend the method to be applicable to stellar polarization. By combining with the information of stats distance, for instance, provided by Gaia, it is possible to recover the 3D magnetic field’s 3D distribution.

SECTION: Prospects of the ViT-SPD method
Understanding the 3D Galactic Magnetic Field (GMF;) is crucial for various astrophysical studies, including tracing the origins of ultra-high energy cosmic raysand refining models of Galactic foreground polarization. Previous efforts aimed at modeling the foreground polarization have primarily focused on mapping the POS component of the magnetic field, but neglecting the crucial depolarization factor, magnetic field’s inclination angle.

By integrating spectroscopic observations of neutral hydrogen, methods such as velocity channel gradients (VChGs;) or CNN-based approaches, and the Galactic rotational curve, it is possible to trace the 3D distribution of the 3D GMF within the Galactic disk. Additionally, employing the ViT method with multi-wavelength synchrotron polarization observations enables the probe of the 3D GMF in the regions of the Galactic halo, thus providing a comprehensive picture of the GMF across the Galaxy.

An accurate model of magnetic field properties is crucial for understanding cosmic ray (CR) physics. For instance, the diffusion of CRs is anisotropic and strongly correlated with the medium’s magnetization level. Additionally, CR acceleration mechanisms, such as diffusive shock accelerationand turbulent second-order Fermi acceleration, are instrumental CR acceleration within supernova remnants and galaxy clusters. Both the strength and orientation of magnetic fields play essential roles in determining the efficiency of these acceleration processes. The 3D magnetic field configuration and magnetization level obtained through the ViT-SPDs method can offer critical insights into the acceleration and transport processes of CRs.

Magnetic field amplification during galaxy cluster mergers plays a pivotal role in understanding cluster evolution. Conventionally, magnetic fields are thought to evolve in tandem with cluster dynamics, where they are stretched, stirred, and amplified by large-scale bulk flows along the merger axis. Subsequent stages involve further amplification by the small-scale turbulent dynamo. This predicted magnetic field topology has recently been confirmed using the synchrotron intensity gradient method as reported by. However, more direct assessments, such as magnetic field strength or magnetization distribution within galaxy clusters, are needed.

Recent studies, such as those by, demonstrate that the machine-learning paradigm of 3D magnetic field tracing is unaffected by the absence of low spatial frequencies in interferometric observations, paving the way for its application with upcoming initiatives like the Square Kilometre Array (SKA;). The ViT-SPD methodology is therefore applicable to interferometric data to trace magnetic field evolution across various redshifts and cluster merger stages, enabling detailed comparisons with predictions of magnetic field amplification.

Axion-like particles (ALPs), predicted by various extensions of the Standard Model, could constitute all or a substantial portion of the cold dark matter. As a class of pseudoscalar particles, ALPs can generically couple to photons. This coupling opens the possibility of oscillations from photons into ALPs in an external magnetic field, which may introduce irregularities in gamma-ray spectra. Efforts have been made to explore ALP parameters and the irregularities within the Perseus galaxy cluster. However, these studies necessitate a detailed magnetic field model. The ViT-SPD methodology could provide essential insights into the 3D magnetic field structure, enabling more stringent constraints on ALP parameters.

SECTION: Summary
Probing 3D magnetic fields, including the field’s POS position angle (), inclination angle () with respect to the LOS, and total magnetization level (), presents significant challenges for traditional observational methods. To address these challenges, we introduce the Vision Transformer (ViT) model, leveraging recent advancements in machine learning, to trace 3D magnetic fields using synchrotron polarization derivatives (SPDs). Notably, SPDs provide unique distance information along the LOS, enabling the recovery of the 3D spatial distribution of 3D magnetic fields. We summarize our key findings as follows:

We demonstrate that the morphological features of SPDs are anisotropic and closely correlated with the 3D magnetic field. The observed SPD structures are predominantly elongated along the local magnetic field lines. The degree of SPD anisotropy is associated withand is influenced by the projection effect induced by. Additionally, the observed morphological curvature of SPD structures is sensitive to bothand.

We developed a ViT model to extract morphological features from SPDs, enabling estimates of the POS magnetic field orientation, inclination angle, and magnetization. Due to the Faraday rotation effect, SPDs provide unique distance information along the LOS, facilitating the recovery of the 3D spatial distribution of the magnetic fields.

The ViT model was trained using synthetic synchrotron polarization data, covering a range of conditions from sub-Alfvénic to super-Alfvénic regimes. We quantified the uncertainties associated with the model’s predictions, finding that the median uncertainties are less thanfor bothand, and around 0.05 - 0.1 forunder sub-Alfvénic conditions. Under super-Alfvénic conditions, the uncertainties increased but remained belowforand, and aroundfor.

SECTION: References