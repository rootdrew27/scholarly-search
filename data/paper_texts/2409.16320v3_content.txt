SECTION: Developing a Thailand solar irradiance map using Himawari-8 satellite imageries and deep learning models

This paper presents an online platform showing Thailand solar irradiance map every 30 minutes available athttps://www.cusolarforecast.com. The methodology for estimating global horizontal irradiance (GHI) across Thailand relies on cloud index extracted from Himawari-8 satellite imagery, Ineichen clear-sky model with locally-tuned Linke turbidity, and machine learning models. The methods take clear-sky irradiance, cloud index, re-analyzed GHI and temperature data from the MERRA-2 database, and date-time as inputs for GHI estimation models, including LightGBM, LSTM, Informer, and Transformer. These are benchmarked with the estimate from a commercial service X by evaluation of 15-minute ground GHI data from 53 ground stations over 1.5 years during 2022-2023. The results show that the four models exhibits comparable overall MAE performance to the service X. The best model is LightGBM with an overall MAE of 78.58and RMSE of 118.97, while the service X achieves the lowest MAE, RMSE, and MBE in cloudy condition. Obtaining re-analyzed MERRA-2 data for the whole Thailand region is not economically feasible for deployment. When removing these features, the Informer model has a winning performance in MAE of 78.67. The obtained performance aligns with existing literature by taking the climate zone and time granularity of data into consideration. As the map shows an estimate of GHI over 93,000 grids with a frequent update, the paper also describes a computational framework for displaying the entire map. It tests the runtime performance of deep learning models in the GHI estimation process.

Himawari, solar map, satellite-derived GHI, Informer, Transformer, LightGBM

SECTION: 1Introduction

Thailand has targeted to achieve carbon neutrality by 2050 when the power grid will need to accommodate 50% share of renewable electricity generation capacity; see[Ene21]. The most recent draft of Power Development Plan 2024 (PDP2024) for 2024 – 2037 from[Ene24]proposes to add a new solar generation capacity of approximately 24,400 MWp (more than 4 times the amount issued in the previous Alternative Energy Development Plan 2015–2036 (AEDP2015) at 6,000 MWp, shown in[Dep15, p.9]. This amount does not yet include behind-the-meter, self-generation solar installed capacities of the prosumers, which is expected to increase at an accelerating rate. Solar integration into the power grid with such a sharp-rising amount will pose technical challenges to the operation and control of the transmission and distribution networks, carried out by the transmission system operator (TSO) and distribution system operator (DSO), as presented in[OB16]. Hence, TSO in Thailand will need an effective means to estimate the solar power generation across the entire transmission network, on an hourly basis, or even finer time resolution, to provide economic hour-to-hour generation dispatch for load following the total net load of the transmission, and to prepare sufficient system flexibility (i.e., ramp-rate capability of the thermal and hydropower plants, or energy storage systems) to cope with the net load fluctuation due to solar generation intermittency for maintaining system frequency stability, concurrently, in its operation. For DSO, a significant amount of reverse power flow when self-generation from solar exceeds self-consumption can lead to technical concerns of voltage regulation and equipment overloading problems. The near real-time estimation of solar generation in each distribution area will enable DSO to activate proper network switching or reconfiguring to mitigate such fundamental concerns to ensure its reliable operation.

While solar energy offers a clean and virtually infinite alternative to fossil fuels, its dependence on sunshine makes it susceptible to fluctuations in weather patterns. This variability, potentially exacerbated by climate change, necessitates the development of accurate solar forecasting technology. The reliability of these forecasts directly impacts the planning (pipeline) of solar photovoltaic (PV) systems, ensuring they are integrated efficiently into the power grid, and also influences the operational settings required for various energy applications.

Global horizontal irradiance (GHI) estimation services provide crucial information in the solar energy industry. These services often provide estimated GHI for a desired location by using a combination of weather models, satellite imagery, and measurements from ground stations. These GHI databases can be divided into i) satellite-derived databases where GHI data were estimated from satellite imagery products, ii) ground-based measurements containing GHI recorded from available monitoring stations, and iii) reanalysis datasets that fuse weather estimates from atmospheric models with historical observations, including GHI data. According to[PWRA+16],Table6in the Appendix lists some satellite-derived solar irradiance services that differ from the methods they use and service coverage, dependent on the satellite. Some of the leading services that provide estimates of solar irradiance and power forecasts with global coverage can be described as follows.

SolarAnywhere provides a core technique called the SUNY model developed in the works from[PH13,PIM+02,PSH+15,PSK+18]that uses satellite imagery and numerical weather predictions to better calculate irradiance under cloudy conditions. SolarGIS by[SC10]uses a semi-empirical solar radiation model with data from satellites for explaining cloud properties. The service also provides site adaptation of SolarGIS data to improve the quality using ground measurements. PVWatts by NREL;see[Dob13], has an interactive page where the user can input a desired location and PV panel’s parameters to calculate monthly solar irradiance and PV power.[So24]offers solar radiation maps in 15-min resolution. The method relies on HelioClim-3 persistence forecast of a clear-sky index and the use of the Meteosat satellite. SolCast service, detailed inhttps://www.solcast.com/irradiance-data-methodology, provides solar irradiance forecasts and historical data in several time resolutions. It uses NOAA, EUMETSAT which covers the continental US, Europe, and Himawari-8 satellite from JMA, which covers Asia and the Pacific, to gather information about cloud opacity and weather conditions. The methodology of producing GHI estimates consists of the SolCast cloud model and the REST2v5 clear-sky model. The SolCast cloud model takes historical and forecast data of geostationary meteorological satellite (GMS) and NWP inputs for 14 days ahead. The cloud opacity extracted from satellite cloud detection algorithms is combined with NWP inputs to account for mixing effects from weather artifacts. The validation of Solcast was presented inhttps://www.solcast.com/validation-and-accuracyfor all climate conditions where sites are grouped by continent. The overall normalized MAE and RMSE of SolCast 2023 based on all 207 sites wereand, respectively. The service also provides the SolCast Rooftop PV model, which estimates PV power when users provide PV metadata such as location, capacity, and panel tilt angle.

While these aforementioned companies provide a wide range of services and use advanced algorithms with several sources of input data, it boils down to the cost of acquiring these solar data for a regional application as the cost often varies with the number of sites. As of March 2024, Thailand has 552 on-grid solar power plants with a total capacity of 2,640 MW, shown inFigure1(a). Among these solar sites,Figure1(b) shows 53 solar sites fully equipped with ground measurements that participate in our study. To accommodate solar energy applications in Thailand in an operational setting, we aim to develop our solar map that frequently estimates satellite-derived GHI across the country using satellite imagery and local ground measurements. The cost of acquiring irradiance estimates across Thailand (93,061 grids) through commercial services in an operational setting (every 30 minutes) is high as compared to the cost of developing our own platform. For this reason, we study the literature on satellite-derived GHI estimation techniques in the following sections.

SECTION: 1.1Physic-based and empirical methods

Traditionally, physical models use satellite information to solve the radiative transfer model, which simulates how radiation moves through absorption and scatter processes in the Earth’s atmosphere. Empirical techniques rely on the statistical relationship between atmospheric parameters and ground observations. The two approaches have been merged into semi-empirical models, which analytically describe a relationship between solar radiation and aerosols in the atmosphere while using satellite information to empirically retrieve the cloud index.

Methods in this group quantify how much clouds and other particles in the atmosphere affect the incoming solar radiation by compensating with a clear-sky scenario. This relationship is often parametrized in physical parameters such as aerosol optical depth (AOD), reflectance, surface albedo, which can be derived from satellite imagery. The Heliosat model is a semi-empirical method with a core principle that combines a clear-sky model with a cloud index through a piecewise-polynomial relationship.[Dag05]used Heliosat algorithm and calculated a new cloud index from reflectivity derived from the Meteosat satellite where a modification was made on computing the ground reflectivity to save computing time.[KBSH18]extracted the brightness temperature difference from various bands of INSAT-3-D satellite to calculate the all-day index as information of cloud, dust, and fog. The GHI estimation relied on the Heliosat-2 model and was validated on ground measurements in India. The RMSE ranged from 48 to 128under sky conditions with dust and fog.[VPN+23]presented an improvement over the MAGIC-Heliosat method on calculating apparent reflectance to compute the cloud index. The results were validated with ground stations from the baseline surface radiation network (BSRN) in Australia and Japan. The method’s performance varied according to evaluation on hourly, daily, and monthly averaged data with RMSE of 161, 80, and 70, respectively.

While the Heliosat model is a well-known method, there are several other semi-empirical approaches for GHI estimation.[QWL+18]showed that Yang’s hybrid model (YHM) performed best with RMSE of 27.94when compared to ANN on datasets in China. The physical method YHM relies on the radiation-damping processes,e.g., Rayleigh scattering, aerosol extinction, absorption by ozone, water vaport and permanent gas. These atmospheric variables were derived from MODIS satellite.[QHM+19]presented a mathematical formula of GHI as a function of irradiance with zero surface albedo, global reflectance function of atmosphere and surface albebo, which can be derived from Himawari-8 satellite. The results were validated on 3-year ground station data in Australia with MAE of 55.8and RMSE of 91.7. The GHI model with explicit surface albedo was later used in[QHM+21]but all irradiance components were calculated by pre-computing Look Up Table and using radiative transfer model (RTM). The GHI estimation results were validated on data in Australia with an MAE of 54.7and an RMSE of 90.3.[BS21]computed the cloud indices using the surface albedo extracted from eight-band imagery of Himawari-8. These cloud indices were converted to clear-sky indices (for all eight bands), and the eight-band clear-sky indices were optimally weighted. The results were validated using data in Singapore, where the scatter plot between the ground-observed clear-sky index and the satellite-estimated values was improved.

The accuracy of semi-empirical methods varies during cloudy periods when models might not differentiate clouds’ impact on irradiance. However, the methods typically require less computational demand than physical models, so they can be applied to a wide region where calibration might be needed.

SECTION: 1.2Site-adaptation techniques

The site-adaption technique adjusts satellite-derived GHI by incorporating available ground measurements to provide estimates at a target location. The correction techniques involve linear multiple regression, distribution mapping (quantile or kernel density distribution), adjusting atmospheric parameters used in the satellite retrieval process, and machine learning techniques; more details in[PWRA+16,PFPS+20].

[HV22]acquired Himawari-8 satellite images from JAXA and historical data of MERRA-2 product as inputs for REST-2 clear-sky model. The GHI estimation improvement relied on adjusting polynomial coefficients in the Heliosat algorithm, cloud albedo selection and linear bias removal as the site adaptation technique. The results were tested with hourly-averaged ground GHI in Taiwan with MAE of 38.74and RMSE of 57.42.

Site adaptation techniques using nonlinear models from machine learning approaches can be found in[STAK22]. The estimated GHI from the Copernicus atmospheric monitoring service (CAM-Rad) service and then corrected the value by calculating a perturbation from ML methods using solar zenith angle, AOD, water vapor, ozone, and cloud information as inputs. Overall, the two best performances were obtained by tree-based models (XG boost and random forest), which yielded an RMSE of 56-57.[VSDL+23]used estimated GHI from HelioClim3, clear-sky index, and zenith angle as inputs for gradient boosting model to correct in both spatial and temporal domain.

Neural network techniques, presented in the next section, can capture a complex relationship between the satellite data and the corresponding ground-based GHI measurements.

SECTION: 1.3Neural network techniques

Deep learning (DL) has become a leading trend in solar energy estimation due to its data-driven nature. It enables the parameters in an artificial neural network (ANN) to be fine-tuned according to the collected data; resulting in less manual customization of input features compared to the previous approaches that rely on the physical and meteorological information.

Satellite data is the key to extending the coverage of solar forecasting to entire countries. However, the database stations used as the reference for implementing and evaluating solar forecasting are often relatively sparse (e.g.,[AMOG14]use only five stations), and the operation and installation can be costly.[SL18]address this limitation by using satellite-based GHI measurements in training, which offer the global irradiance information in Europe and USA; and this work shows that LSTM has the best performance among ANNs but is at a similar level to gradient boosting regression (GBR). Similarly,[YCZ19]tested LSTM on the NSRDB database (USA). Nevertheless,[QWL+18]found that an ANN can still be outperformed by a physics-based model with high-quality inputs,e.g., Yang hybrid model with meteorological and MODIS satellite data, while cloud fraction and solar zenith angle were found the parameters that highly includes the model accuracy.

Subsequent works further utilize the spatial information from satellite data as the reference to improve the model learning,e.g., solar radiation images in[YDA+20]and satellite-derived GHI in[NIK21]. The ground measurements are discontinuous and sparse, which can be inadequate to represent the regional characteristic of the estimated GHI; see[JLQ+19]. Utilizing the spatial information,e.g., cloud mask[NIK21], spectral images[JLQ+19,YDA+20], infrared images[AMR21], and satellite images[GCM+22], as inputs can promote the continuity. To process the spatial information, these works[JLQ+19,YDA+20,AMR21]attach convolution neural networks (CNN) for image feature encoding. Advanced CNN architectures are used as the IrradianceNet[NIK21]and as the STUNet[GCM+22]that employed ConvLSTMs and 3D-CNNs as image encoders, respectively. The time-series dynamics between satellite images are used in addition to the spatial information as an additional set of inputs. In such cases, LSTM-based models are often used to derive the forecast irradiance in the future timestamp[AMR21,NIK21].
Fusing sky and satellite images can improve forecasting accuracy[PAL23], which outperforms other methods that use only sky or satellite images. However, the sky-image based methods[FZ20,PAL21,PHAL22,LZC+23,ZWSW23,PAL23]focus on single-site forecasting only, which is not suitable for providing the GHI estimates at national level.

Although these satellite-based methods[QWL+18,SL18,JLQ+19,YDA+20,AMR21,NIK21,GCM+22]are promising, they are not applicable in our settings. Specifically, our system promises near real-time solar forecasting for 93,061 grids across Thailand, in which the system first acquires the satellite images from Himawari-8 provided at 10 minutes resolution, and then the satellite-derived GHI estimates are calculated and used to generate the solar map for every 30 minutes. As such, the target data-driven model has to offer a good trade-off between accuracy and efficiency. Thus, our work departs from the previous methods in the following aspects:

Input data and parameters.Unlike previous studies[QWL+18,JLQ+19]that rely on a number of terrain and atmospheric parameters, our model relies primarily on cloud data, with time-based features and the altitude parameter.

Learning reference.Satellite-derived GHI from a physical-based method is used as the reference in model learning such as[SL18,YDA+20,NIK21], but these references are rather indirect compared to the ground GHI measurements. Our setting tunes the model towards the GHI ground measurements.

Runtime requirement.Unlike the CNN-based methods[JLQ+19,YDA+20,AMR21,NIK21,GCM+22]whose CNN operation performs window sliding in each grid, we try to avoid such operation, not only because of the runtime requirement, but also to retain the details of each grid area that is roughly the size of a sub-district in Thailand ().

Our key contributions are as follows.

A clear-sky model for Thailand’s weather condition. We improve the Ineichen & Perez clear-sky mode by re-estimating the Linke Turbidity using nonlinear regression. This is achieved by fitting clear-sky irradiance curve whereis parameter using the collected ground measurements of GHI from 53-station data.

A methodology that exploits deep-learning or tree-based models to capture a complex relationship between satellite cloud and GHI. To find the best model, we benchmark LSTM, Informer, Transformer, and LightGBM (LGBM) for GHI estimation. Additionally, we improved Informer and Transformer particularly for this application. For LSTM and LGBM, we study the impact of input features. Our findings indicate that all these models exhibit overall performance comparable to commercial service X, a widely recognized industry benchmark. Our implementation are provided athttps://github.com/energyCUEE/solarmap-DL-2024.

A framework that operates in almost real-time implementation (30 minutes) and displays the estimated results across Thailand. Additionally, we provide the real-time solar energy map from the estimated irradiance map at hourly, monthly, and yearly resolution. This solar map can be useful for planning and operating solar energy production.

SECTION: 2Thailand solar map

Our Thailand solar map platform is currently running athttps://cusolarforecast.com/, where the methodology is a machine learning model that takes input of cloud index, geographical location, and clear-sky irradiance to produce the GHI estimate. The random forest model was implemented from 2022 to June 2024. Our continuing plan of updating the model has been discussed in[SWH+24], and the goal of this paper is to improve the model, considering other tree-based and deep-learning models. The service is currently running under the deep learning model, the Informer, as to be presented subsequently inSection4.3. This section describes the map requirement and the available input data resources for developing the GHI estimation model.

SECTION: 2.1Specification

Thailand solar map is required to provide the following features to support the service displayed inFigure2.

The map displays atresolution within Thailand boundary, and contains 93,061 grids. The map intensity shows the estimated GHI that accounted for cloud information across Thailand and updates every 30 minutes.

The PV icons mark the locations of installed solar power plants, while the CUEE icon is our solar rooftopat our research institution (Faculty of Engineering, Chulalongkorn University). The system shows estimated solar power and the cloud index amount extracted from Himawari-8 satellite images at the grids with solar sites installed.

In this solar map, we use the information on solar power installed capacities and locations, published on the website of the Office of Energy Regulatory Commission (ERC) athttps://www.erc.or.th/en, together with the estimated GHI from our models being updated every 30 minutes by using the cloud images received from Himawari-8 satellite, to estimate solar generated power across Thailand. The current updating frequency of 30-minute intervals is chosen to be consistent with the time resolution of the Unit Commitment program run by TSO. The solar map will also be designed to give convenience to aggregate estimated solar energy within a specified region, for example, in each control region, sub-region of TSO, or substation service area of DSO, employing spatial ensemble techniques thereafter.

SECTION: 2.2Data resources

There are 576 solar sites registered to the Energy Regulatory Commission of Thailand (ERC), where information on locations and installed capacity are provided. Ground measurements of GHI and satellite cloud data are required for model training and validation among these sites.Figure1(b), shows 53 solar farms that record 15-minute average of solar irradiance, solar power, ambient and PV module temperature measurements from October 2020 to June 2023. The pyranometer model of solar irradiance measurement is SMP 6 (ISO 9060 spectrally flat class B). To ensure data quality, a pre-processing pipeline was implemented.

Initially, data was filtered to retain only daytime measurements. GHI values were restricted to a physically realistic range of 0 to 1400. Dates with excessively low average daytime GHI were discarded. This step aimed to eliminate periods with insufficient solar radiation or inaccurate measured values. Dates with missing data periods exceeding six hours were entirely removed. Shorter data gaps were filled using linear interpolation. Last, a manual inspection of GHI data and associated variables for consistency was performed. As a result of this quality control process, three of the original 56 sites were unsuitable and excluded from the analysis. The remaining 53 sites were deemed sufficiently reliable for this study.

The 8th Himawari geostationary weather satellite operated by the Japan Meteorological Agency (JMA) provides 16-channel multispectral images that capture visible light and infrared images of the Asia-Pacific region. A C-band satellite dish and receiving station have been installed at our research institution, CUEE, since February 2022; seeFigure3. There are three types of cloud products: composite images, cloud masks, and colorized images available athttps://himawari.optemis.space/archives. We employ cloud mask images and the R-channel of the composite image that has been processed for sun zenith correction and enhanced for smoothness. The R, G, and B channels correspond to 0.6, 0.8, and 10.8wavelength, respectively. Both the cloud mask and R-channel images havepixels with the resolution ofcovering Thailand area (approx.20.6-5.4, 97.1-106), and are released every 10 minutes. These images in TIFF format contain geographical information. Given an inquired latitude and longitude, we can extract the cloud intensity at the corresponding pixel and convert it to cloud index as(from cloud mask) and(from R-channel) as follows.

The data during the period of satellite outage or error image scan are flagged to be imputed. If the imputation period is small, a simple interpolation from nearby data points is performed, while the missing data in a long period are removed from the study.

In[PPGB13], the cloud index is calculated by

whereis the pixel intensity of interest (0-255); UB and LB are the upper and lower bound of the dynamic range at a given point in time and space. In our experiment, LB is zero, and UB is 255. The cloud indices computed from cloud mask,, and R channel,, were plotted versus the clear-sky indexshown inFigure4, suggesting thathas a stronger anti-correlation withthan.

Pre-processing steps were applied to cloud images and extracted cloud index (CI) data to ensure alignment with the target variable, GHI measurements. Initially, satellite images containing significant areas of bad scan (black area) were discarded. For each day, the first and last cloud image within the 7:00 to 17:00 timeframe were identified. Missing cloud images within this range were imputed using a forward-fill method. To accommodate the GHI estimation model’s requirement for five lagged CI values, a backward-fill approach was employed for the first five time steps. For the imputed date-time between 5:00 and 6:00, zero-filling was applied; otherwise, backward-filling from the first image’s CI value was utilized.

To train and infer a GHI estimation model, we must extractat a pixel of cloud images that best represents the desired location using GeoTIFF data to find the nearest pixel whose coordinate (latitude /longitude) is closest to the coordinate of interest.

We currently subscribe to theMeteo Monitoringand theMeteo historicalservices fromhttps://www.soda-pro.com/. The Meteo monitoring service provides day-ahead GFS weather forecasts by the National Centers of Environmental Prediction (NCEP). At the same time, the Meteo historical contains reanalysis data of solar irradiance and temperature estimates (denoted asand) with a resolution of 15 minutes retrieved from the MERRA-2 model (Modern-Era Retrospective analysis for Research and Applications). For training, we incorporate the MERRA-2 GHI and temperature as part of the features for GHI estimation models at 53 solar locations.

Cloud data, NWP data, and GHI measurements overlapped from April 2022 to June 2023, resulting in our dataset of 22,906 days or 1,195,257 samples.

SECTION: 3Methodology

SECTION: 3.1Ineichen clear-sky model

A clear-sky model provides a GHI value at a given time and location under a clear-sky assumption. It typically takes date-time to estimate the solar zenith angle or the sun position and uses the location’s coordinate to acquire the altitude and other atmospheric parameters. Benchmarking of 75 clear-sky models can be found from[GBL+19,YB20,SBG+21,BBZ+20], where it was reported that the REST2 model is among the best-performing models in the equatorial zone. At the same time, it requires several atmospheric parameters such as aerosol optical depth, total ozone, nitrogen dioxide amounts, or aerosol single-scattering coefficient. Among these 75 models, simplified-Solis model[Ine08a], Kasten, and Ineicen & Perez models require fewer numbers of physical input parameters.

In this paper, we consider the Ineichen & Perez clear-sky model[IP02]due to its simplicity in acquiring only one atmospheric parameter, the Linke turbidity. The model is described by

The extraterrestrial irradiance constant,is the theoretical value of irradiance on the Earth’s surface if the Earth were not surrounded by an atmosphere. The altitude of a desired location,, is used for computing the constants:

whereis retrieved from STRM30 dataset[MC00].
We follow the model of airmass coefficient,, from[PPGB13]given by

The Linke turbidity parameterrepresents the amount of atmospheric absorption by water vapor and aerosol particles that attenuate extraterrestrial radiation. This factor can be obtained via experiments on clear-sky days. Still, it is more common to be empirically estimated[ERA+12], whereis empirically estimated to best match with local ground measurement of clear-sky irradiance in Thailand.

We have set up an experiment to adjust the Linke turbidity coefficients based on ground measurements of GHI from 53-station data. The clear-sky GHI portions are extracted from PVlib clear-sky detection implementation[AHH+23]and split into train:test at ratio 90:10. The training set is divided into 12 months and monthlycoefficients are estimated separately since the valueis known to vary seasonally[Ine08b,GL23]. The estimation technique is nonlinear regression to fit the clear-sky GHI curves.Figure5(b)shows the result of estimatedas a heatmap displaying the value across the Thailand map, where its value is high during April but appears lower in December. A complete trend ofestimated monthly is shown inFigure5(c). The coefficientis at peak during Apr-May and smaller in other months.

Other guidelines ofestimation in Thailand can be found in[JKL03,CC04]. Other papers about the Linke estimation are presented in[Ine08b,GL23].

SECTION: 3.2Satellite-derived GHI estimation

The estimation of GHI based on satellite-derived information has two schemes explained inSection1. The physics-based and semi-empirical methods are typically based on the top diagram inFigure6. The cloud index extracted from satellite images is an input for an irradiance attenuation model that produces an estimate of clear-sky index. Examples in literature are Heliosat algorithms[RLW04,QOB+17], piece-wise polynomial and rational functions[SWH+24]. The estimatedis then used for compensating a reduction in irradiance through the relationship.

Instead of expressing the effect of the cloud on the clear-sky index directly, we propose to use a nonlinear mapping asGHI estimation modelto associate cloud index, clear-sky GHI, and other features with the estimate GHI, as shown in the bottom diagram ofFigure6. The non-linear map can better capture complex cloud effects on solar irradiance, and various choices of GHI estimation model can be considered,e.g., tree-based models were validated with a good MAE/RMSE performance in[SWH+24]. Note that the input features for the non-linear mapping are all meteorological variables, especially the cloud index, but not GHI measurements as they are not available spatially across Thailand when deploying the model in practice. The list of features we used in this paper are

Letdenotes a vector collecting these input features at time. Then, the input sequenceis the collection of the inputand its lags,i.e.,

whereis the length of input sequence. Suppose thatis a GHI estimation model that is data-driven with tuned parameters. The GHI estimate at timecan be obtained by performing the model inference:.

When training a model, it is natural to enforce the similarity between the predictionand the ground truth. In this study, we benchmark the following methods:LightGBM (LGBM), LSTM, Informer, Transformer, and the service X. For service X’s predictions, we have downloaded historical GHI estimates at 53 stations during the period of this study. We modified Transformer and Informer to acquire time-series data for solar irradiance forecasting while building upon existing LSTMs with additional linear layers. The hyper-parameters of these models were tuned and set with the values shown inTable1.

LightGBM[KMF+17](light gradient boosted machine) builds on the concept of gradient boosting decision trees. LightGBM uses the leaf-wise approach that prioritizes growing trees in informative areas, leading to more accurate models with fewer trees. Also, it has a process to select important features and remove less impactful features from the data. In our case, we provide the following features as the input to the LightGBM:

The parameter setting of LightGBM is provided inTable1.

Our LSTM (long short-term memory) neural network is enhanced from that of[SL18]to includelayers of LSTM cells, an activation, a dropout, and a linear layer, as shown inLABEL:fig:DNN:LSTM_overall, whereis fed as the input, and the predicted irradianceis the output. The LSTM cell is provided inLABEL:fig:DNN:LSTM. Its cell state and hidden state are initialized at zero. The LSTM cell recursively processes each input lag from. For an input, the long-term memoryis updated from the previousand the forget gate. The short-term memoryis updated with the input gateand. The output gate provides the outputand is used to update next hidden state. After each recursion, the output is collected as a latent sequence, fed to Relu activation, dropout layer, and linear layer. The linear layer maps the output sequence into a sequence of GHI estimates, where the last element is the prediction.

We modify the Transformer[VSP+17]by,first, applying the attention mechanism to capture the dependencies within a time-series sequence and between the pairs of such sequences.Second, the architecture is modified for the shorter sequence, resulting in the encoder-decoder pairs shown inLABEL:fig:DNN:Transformer, which is similar to[ZZP+20], except that our input features and target priors are not the target itself. At first, the encoder receives the input sequence, which calculates the self-attention to capture the dependencies within the sequence itself. Three linear layers (Linear) encodeas,, andin. The self-attention mechanism can be expressed as follows (and inLABEL:fig:DNN:Attention):

The decoder derives the prediction from cross-attention between target priors () and the latent features from encoder. The target priors are the sequence of the following features:

which are used as the query in the attention calculation. The latent features from the encoder are the key-value pair.

The architecture of Informer[ZZP+20]is similar to that of Transformer, except that the generic attention mechanism is replaced with the sparse attention mechanism[LZC+23,ZZP+20]. We further modify Informer for predicting the solar irradianceby adding the target priors as5. At first, the score of the queries’ sparsity is calculated, and then only the top-queries with the highest scores are selected to construct a sparse query matrix. Thus, we can construct a sparse query matrix (denoted as) that contains only the top-highest sparsity scores. The sparse attention mechanism can be formulated by replacingwithinEquation4,i.e.,

LABEL:fig:DNN:SparseAttentionshows the sparse attention mechanism.

SECTION: 4Results and discussion

SECTION: 4.1Data preparation

Since cloud cover can vary greatly throughout the day, traditional seasonal patterns become less reliable. It is important to ensure that the data samples in the training, validation, and test datasets share a similar degree of uncertainty. We classify GHI data of each day into three sky conditions: clear, partly cloudy, and cloudy, according to the rate of change in GHI and the daily average of clear-sky index, or. If the GHI curve has a smooth clear-sky curve, its slope must decrease (change from a positive value to zero and a negative value); meanwhile, the higherindicates the lower cloud coverage. The criteria of our classification are described as follows: i)clear-sky:GHI curve has decreasing slope, and, ii)partly-cloudy:GHI curve that are not clear-sky, and, and iii)cloudy:GHI curve that are not clear-sky, and.

The extracted cloud index and ground GHI data are merged into a synchronized 15-min resolution during 03:00-17:00 (local time in Thailand), totaling 1,195,257 samples or 20,924 days. The target forecasting hours range from 7:00 to 17:00. The data is divided with the ratio of 60:20:20 for train:validation:test, where each of the three sets is ensured to contain a uniform mix of three sky conditions seeTable2. To achieve this, we first segmented the data with lags and stacked them as sequences labeled with sky condition. Then, we shuffle the data and split them for training, validation, and testing.

SECTION: 4.2Clear-sky model evaluation

According to our improvement of the Ineichen clear-sky model inSection3.1, we benchmark the results against the following methods.

Ineichen model withupdated using clear-sky GHI measurements (proposed).

Ineichen model computed by PVlib[AHH+23].

Simplified Solis model computed by PVlib[AHH+23].

Pysolar[Sta14]. The library does not provide GHI but only returns DNI, so we multiply DNI with.

Figure9shows that after we tunedto local GHI data in Thailand, the Ineichen clear-sky model fits better to clear-sky time series while other methods tend to be overestimated (on selected sample dates inFigure9. The MBE inFigure10(b) clearly shows that PVlib Ineichen and PySolar highly underestimate clear-sky GHI during Jun-Sep, while PVlib simplified Solis overestimates during Feb-May. Our method achieves the least MAE and MBE in all months.

SECTION: 4.3Satellite-derived GHI estimation

Figure11andTable3show a comparative performance of all GHI estimation models, including LGBM, LSTM, Informer, Transformer, and the service X. All the proposed benchmarked models provide similar overall MAEs in the range of 78-81. For the MAE, the Informer, Transformer, and service X have the lowest error in clear-sky, partly cloudy, and cloudy conditions, respectively. For the MBE, LGBM and the service X have a relatively high negative bias (underestimate) in clear and partly cloudy condition. Meanwhile, LSTM, Informer, and Transformer tend to overestimate—high positive bias in the cloudy condition, while the service X has the lowest MBE in this case, as shown inFigure11(Bottom.)The evaluation with the RMSE metric is reported inTable3. All the proposed models perform almost equally if MAE is considered. For specific sky conditions, our proposed models generally perform well in clear-sky and partly cloudy scenarios. However, service X demonstrates superior performance under cloudy conditions.

Our GHI estimation at a half-hourly resolution provides the RMSE values (31.54 - 145.74) that aligns with previous studies in equatorial regions,i.e.,[VPN+23]reported hourly GHI RMSEs of 115-180across six locations (SAP, TAT, FUA, ISH, DWN, and ASP) using Himawari-8 data; and,[QHM+21]reported an instantaneous GHI RMSE of 118.3at the DWN station, also using Himawari-8. Our results are in a similar trend to[KBSH18], providing half-hourly GHI RMSEs of 41.7-167in South Asia (India).[Bri19]reported an average hourly RMSE of 99.5 W/m² in equatorial regions for zenith angles between 0 and 85 degrees (approx.05:56-18:37), exceeding our target forecasting hours (7:00-17:00). Note that including GHI estimates from early morning and late evening (nearly night-time) in the analysis could potentially underestimate the MAE and RMSE.

We explore possibly different characteristics of models when some features are not included in the model. NWP forecasts (both irradiance and temperature) are the input that is likely to be costly in operational setting when inferring a solar map of Thailand since the forecast values must be obtained a high spatial resolution. The coordinates of station locations are also considered to be removed, as this information is already inherited in the clear-sky model.Table4shows that dropping NWP input affects the performance slightly for all models and all-sky conditions, while the location coordinate still has some significance as the MAE is increased around 2. The Informer has the least MAE among all models when all two features are removed. Thus, we will focus on the performance of the informer.

The solar irradiance estimation by Informer is provided inFigure12. The discrepancies between the estimates and ground truth appear to be larger when the sky is cloudy, as shown inFigure12(a). Meanwhile, the MAE evaluated for each hour of the day indicates that the model usually suffers during the daytime (10:00-15:00) under the presence of cloud, as shown inFigure12(b). The MAE could go up to 140in this period, and the positive MBE explains that the model mostly overestimates in this period.Figure12(c) and (d) show the selected time series with the top three lowest and highest daily average MAE, respectively. The time series with the lowest error often co-occurs with the clear sky condition, where the cloud index is relatively low. The time series with the highest error typically happens with cloud fluctuation during the day. Thus, the model functioned as expected; if CI increases, the estimatedecreases. A high estimation error, for example, the middle of the plot (d), could come from approximation in the data processing step. It could be the case that CI was missing before 14:00, and the displayed values were interpolated (as a constant of 0.3 from backward imputation).

SECTION: 4.4Solar energy in Thailand

Estimated GHI across Thailand by Informer are cumulatively summed up in yearly, monthly, and hourly time scales of 2023 to infer a solar energy map of Thailand shown inFigure13.

We compare our results with previous studies that visualized solar energy maps in nearby countries. Ministry of Energy, Thailand, currently has developed a yearly solar energy map[Mas22,JMPL13]using long-term data from GMS-5, GOES-9, MTSAT, and Himawari satellites. The methodology relied on physical and semi-empirical models presented in[JMPL13]that require reflectivity and absorption by water vapor, ozone, and particles to infer global solar radiation.[JLS11]presented an application for investigating potential areas in Thailand for producing electricity from solar power. The method used GMS5 satellite data from 1995-2002, where the variables include reflectivity and absorption by water vapor, which was computed by ambient temperature and relative humidity. The map presented the year sum of DNI.[RAN12]visualized monthly solar energy in Indonesia using estimates from an ANN model with weather inputs and geographical information.[SS16]used the historical MERRA solar radiation dataset to analyze potential solar power areas in Southeast Asia. Eastern Thailand, Java, and central Myanmar were the best locations for solar power use.

Figure13(a)shows total yearly energy where effective areas yielding high solar energy lie in central and northeastern regions; the result aligns with that of the solar radiation map provided by DeDe (https://gis.dede.go.th/upload/20230302_135735.pdf); see the Appendix.Figure13(b)shows the monthly estimated energy, with most of Thailand experiencing the highest levels of 170-180in March, April, and May. This aligns with the monthly average of daily global radiation in 2013[JMPL13], which peaks at approximately 183or 22during the same months. However, due to missing data (52% in July and 67% in November), the monthly GHI estimates for these months are extrapolated, resulting in a solar map that differs from[JMPL13].

Figure13(c)illustrates hourly-updated GHI estimates on June 15, 2023. Our GHI estimation model can provide solar energy estimation at the finer temporal resolution, compared to[JMPL13], which was aimed at analyzing a monthly resolution. Our model prioritizes near real-time updates, which offers a significant advantage for operational settings in energy applications where real-time updates are crucial.

SECTION: 4.5Deployment and runtime

Our GHI models are deployed to provide the solar map at two spatial resolutions: zoom level 12 (6,843 grids, approximatelyper grid) and zoom level 14 (93,061 grids, approximatelyper grid). To efficiently estimate solar irradiance for all grid points simultaneously, we set the batch size equal to the total number of grids in each map. The runtime performance of LSTM, Informer, and Transformer models on an RTX4060 GPU for this process is presented inTable5. FromSection3.2.1, when directly including latitude and longitude as features for LGBM, the generated solar map displays some abrupt changes in estimated GHI at some region boundary. These unrealistic results can be fixed when removing these two features, with the cost of having 2-3MAE increased.
For this reason, LGBM results are excluded from the runtime report. All models show acceptable performance (secs. for the largest batch size), with LSTM being the fastest. The Transformer can be an alternative to the Informer because of their similar performance.

SECTION: 5Conclusions

This research presented a methodology of a satellite-derived GHI estimation across Thailand with a spatial resolution of, totaling 93,061 grids with 30-minute updates using cloud indices extracted from Himawari-8 satellite imageries, along with the output of Ineichen and Perez’s clear-sky irradiance model as main features of our GHI estimation models. The study explored recently effective machine learning models, including LightGBM (LGBM), LSTM, Informer, and Transformer, to capture complex cloud effects on ground irradiance attenuation. To optimize computational efficiency, input data is processed as time series, with necessary modifications to the Informer and Transformer. Benchmarking against a commercial service from 53 ground stations demonstrates an improved performance, with lower MAE and RMSE values. Our GHI estimates, at a half-hourly resolution and with RMSE values ranging from 31.54 to 142.42 W/m², align with previous studies[KBSH18,Bri19,QHM+21,VPN+23]. We provide real-time solar energy maps at hourly, monthly, and yearly resolutions, and assess computational efficiency at different spatial scales. Our monthly results on March, April, and May are aligned with the monthly average of daily global irradiance in 2013 during the same months[JMPL13]. Additionally, we confirmed the feasibility of using these models for real-time GHI estimation at the required temporal resolution.

SECTION: 6Acknowledgment

The authors thank Parinthorn Manomaisaowapak for developing the GHI estimation model (version-2), Justin Jiraratsakul and NDR solution (Thailand) Co., Ltd. for implementing the solar map platform as well as Tanan Boonyasirikul for the initial experiments on the DL models. We appreciate the discussions with the Division of Solar Energy Development, Department of Alternative Energy Development and Efficiency (DeDe), Ministry of Energy, which provided supplementary solar data and a historical yearly solar map. This work was co-funded by the Chula Engineering Research grant 2023 and partially supported by Grants for Development of New Faculty Staff, Ratchadaphiseksomphot Endowment Fund.

SECTION: References

SECTION: Appendix: Supplementary results

Table6lists available services that provide satellite-derived solar irradiance.LABEL:tab:performance53sitesshows the detailed estimation performance of the Informer model for each ground station.Figure14gives a comparative estimated solar energy map from Ministry of Energy that was discussed inSection4.4.

We can convert the yearly average of daily global radiation () inFigure14by multiplyingto be the unit ofas to compared withFigure13(a)(total yearly energy). For example, the hottest and coldest spots inFigure14are 18.50 and 14.00, respectively, and they correspond to the total yearly energy of 1875.84 and 1419.56(which can be compared to values inFigure13(a)). As to compare withFigure14, our estimated map inFigure13(a)has a similar trend of spatially relative energy while an actual value of yearly energy estimate at a specific location (except in northeastern) appears to be higher.