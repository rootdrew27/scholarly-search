SECTION: A statistical study of Lopsided Galaxies using Random Forests

Context.Lopsided galaxies are late-type galaxies that feature a non-axisymmetric disc caused by an uneven distribution of their stellar mass, or light. Despite being a relatively common perturbation, several questions regarding its origin, and the information that can be extracted from them about the evolutionary history of late-type galaxies.

Aims.The advent of several large multi-band photometric surveys will allow us to statistically analyze this perturbation, with information that was not previously available. Given the strong correlation between lopsidedness and the structural properties of the galaxies, this paper aims to develop a method to automatically classify late-type galaxies between lopsided and symmetric. We seek to explore whether an accurate classification can be obtain by only considering their internal properties, without additional information regarding the environment inhabited by the galaxies.

Methods.We select a sample oflate type galaxies from the Illustris TNG50 simulation. A Fourier decomposition of their stellar mass surface density is used to label galaxies as lopsided and symmetric. We trained a Random Forest classifier to rapidly and automatically identify this type of perturbations, exclusively using galaxies internal properties. We explore different algorithm to deal with the imbalance nature of our data, and select the most suitable approach based on the considered metrics.

Results.We show that our trained algorithm can provide a very accurate and rapid classification of lopsided galaxies. The excellent results obtained by our classifier, trained with features that do not account for the galaxies environment, strongly supports the hypothesis that lopsidedness is mainly a tracer of galaxies internal structures. We also show that similar results can be obtained when considering as input features observable quantities that are readily obtainable from multi-bad photometric surveys.

Conclusions.Our results show that algorithms such as those considered allow a rapid and accurate classification of lopsided galaxies from large multi-band photometric surveys, allowing us to explore whether lopsidedness in present-day disc galaxies is connected to galaxies specific evolutionary histories.

SECTION: 1Introduction

Lopsided galaxies feature a non-axisymmetric disc, caused by an uneven distribution of stellar mass or light. Observational studies have shown that up to 30% of nearby galaxies display certain degree of lopsidedness(Zaritsky & Rix,1997; Rudnick & Rix,1998; Bournaud et al.,2005; van Eymeren et al.,2011). The term ”lopsidedness” was first coined byBaldwin et al. (1980)to refer to those galaxies in their sample that show a strong asymmetry in the HI gas density distribution between their two opposite sides. As discussed inJog & Combes (2009, and references therein), this asymmetry can significantly impact the dynamical structure and evolution of the host galaxy, causing enhanced star forming regions, fueling the central active galactic nucleus, and redistributing matter, among others.

Despite lopsided galaxies being an ubiquitous object in the nearby universe, this assymetry has recieved less attention than other commonly studied perturbations(e.g. Sellwood,2013; Conselice,2014; Erwin,2019). Moreover, the origin of this asymmetry is not quite well understood, as both galaxies in the field and in denser environment present lopsidedness. Different mechanisms have been proposed as the main driver of this asymmetry, such as asymmetric gas accretion(Phookun et al.,1993; Bournaud et al.,2005), tidal encounters(Weinberg,1994; Rudnick et al.,2000; Gómez et al.,2016), satellite accretion(Walker et al.,1996; Zaritsky & Rix,1997), response of the disc to the distorted dark matter halo(Jog,1997,2002), and off-centered disc(Noordermeer et al.,2001), among others.

Interestingly, several works have also found that lopsided galaxies show differences in their structural properties with respect to more symmetrical late-type galaxies. In particular,Reichard et al. (2008)studied a sample of 25,155 low redshift (z¡0.06) galaxies in the Sloan Digital Sky Survey (SDSS,Kollmeier et al.2019), and showed that lopsided galaxies tend to have lower concentration and stellar mass density within their half light radius than symmetrical galaxies. This suggests that there is a correlation between lopsidedness and the structural properties of the galaxies. Using a sample of late-type galaxies from the Illustris TNG50 simulation,Varela-Lavin et al. (2023)found a similar strong correlation between lopsidedness and the internal properties of galaxies. Specifically, they found an anti-correlation between lopsidedness and the tidal force exerted by the inner regions on the outskirts of their galactic disc. This result indicates that less gravitationally cohesive disk galaxies are more susceptible to develop this asymmetry when exposed to external perturbations.Dolfi et al. (2023)extended this study by considering a larger sample ofTNG50 disc-like galaxies, located in different environments. They showed that, independently of the environment, while symmetric galaxies are typically assembled at early times (Gyr ago), with a relatively short and intense burst of central star formation, lopsided galaxies assembled over a longer time period, with less prominent initial bursts and a subsequent milder and constant star formation rate up to.

Current and upcoming large observational surveys, such as S-Plus(Mendes de Oliveira et al.,2019), J-Plus(Cenarro et al.,2019), J-PAS(Benitez et al.,2014), and LSST(Ivezić et al.,2019), will enable to identify and characterize lopsidedness in a very large number of well-resolved galaxies in the local Universe. This will be crucial to further study the connection between such perturbation and the galaxy internal properties, and to test current model predictions and understand the origin of lopsidedness considering their star formation history in relation with the environment. However, as the volume of data increases, using traditional approaches to study and characterize this non-axisymmetry, such as visual inspection(e.g. Baldwin et al.,1980; Richter & Sacisi,1994), identification of surface brightness residuals with respect to unperturbed distributions(e.g. Conselice et al.,2000)and Fourier decomposition(e.g. Zaritsky & Rix,1997; Reichard et al.,2008), can become a limiting task. All these techniques require human supervision and intervention (such as visual inspection ) and, thus result in cumbersome and slow approach to study lopsidedness in larger volumes of data, which could also result in missing important information or discoveries.

(1)Lagos et al. (2017).

To avoid this problem, machine learning algorithms are a helpful tool used to automate and speed up the classification of objects such as galaxies. Different algorithms can be used for different tasks depending on the problem to solve. For example, some methods are defined as supervised, as they require a subsample of already labeled data to train and test a model (generally referred as training set).A few of these algorithms consist of ensemble methods (Random Forests(Breiman,2001)and Gradient Boosting(Friedman,2001)), artificial neural networks (Convolutional Neural Networks(O’Shea & Nash,2015)and Recurrent Neural Networks(Rumelhart & McClelland,1987)), distance-based algorithms (Nearest Neighbors algorithms(Cover & Hart,1967)), among others. Some examples of their application are morphological classification of galaxies(Ball et al.,2004; Dieleman et al.,2015; Huertas-Company et al.,2015; Farias et al.,2020), classification of variable stars using time-domain(Aguirre et al.,2019; Monsalves et al.,2024), and the estimation of photometric redshifts(Zhang et al.,2013; Lee & Shin,2021). On the other hand, unsupervised algorithms such as clustering (k-means(Lloyd,1982)and Hierarchical clustering(Guha et al.,2000)) and dimensional reduction algorithms (Principal Component Analysis(Jolliffe,2002), are trained with unlabeled data. They are typically employed for anomaly detection(Hocking et al.,2018; Giles & Walkowicz,2019; Sarkar et al.,2022), feature selection(Cheng et al.,2020)and extraction(Baron & Poznanski,2017), and even galaxy classification(Hocking et al.,2018).

Given the previously reported strong correlation between lopsidedness and the structural properties of galaxies, this paper aims at using machine learning techniques to automatically classify galaxies between lopsided and symmetric by only using their internal properties. We also seek to explore whether an accurate classification of this asymmetry can be obtained without including any direct information regarding the environment inhabited by the galaxies. Our selected machine learning algorithms will be trained and tested over a large sample of galaxies obtained from the IllustrisTNG simulation. We will also determine the key parameters that allow the correct classification of lopsided galaxies. The organization of this paper is as follows: In Sect.2we list the selection criteria to obtain the internal and observational parameters of disc-like galaxies extracted from the TNG50-1 simulation. In Sect.3we describe the procedure we follow to implement the classification algorithms. In Sect.4we list and analyze our results. The conclusions and discussion are finally presented in Sect.5.

SECTION: 2Data

In this section, we present the criteria to select the necessary dataset to train and test our selected classification models, discussed in Sect.3.2. In particular, we use galaxy models extracted from the fully cosmological simulation, Illustris TNG50(Nelson et al.,2019a; Pillepich et al.,2019a). For each galaxy model, we compute internal parameters that are commonly measured in observational studies to classify galaxies’ morphology.

SECTION: 2.1The IllustrisTNG project

IllustrisTNG (hereafter TNG), successor of the Illustris project(Genel et al.,2014; Vogelsberger et al.,2014; Nelson et al.,2015), is a set of cosmological, gravo-magnetohydrodynamical simulation, ran with the moving-mesh codearepo(Springel,2010). IllustisTNG builds upon its predecessor model(Genel et al.,2014)by incorporating an updated physical model(Pillepich et al.,2018)which accounts for stellar evolution, gas cooling, feedback and growth from supermassive blackholes, among others. In particular, the improved model for the feedback of the low accretion mode in super massive black holes resulted in a reduction of the discrepancies with observational constraints identified in the original Illustris simulations, such as the galaxy color bimodality(Nelson et al.,2018). These improvements make IllustrisTNG a powerful tool for comparisons with observational data.

TNG consists of three simulations with different volumes:  50,  100and  300, referred as TNG50, TNG100, and TNG300, respectively. Each simulation was run with different mass and spatial resolution. As a result, the three realizations complement each other. For example, the largest simulation box, TNG300, enables the study of galaxy clustering and provides the largest statistical galaxy sample. On the other hand, TNG50 provides the smallest galaxy sample at the high mass end, but it has the highest mass resolution overall. Therefore, it enables a more detailed look at the morphology of galaxies and its structural properties. TNG-100 falls somewhere in between these two other simulations.

In this work, due to its mass and spatial resolution, we make use of the publicly available TNG50-1 model (Pillepich et al.2019b; Nelson et al.2019b). Having a dark matter, baryonic mass resolution of, and 8.5, respectively, TNG50-1 allow us to resolve the structure ofstellar disc with at leaststellar particles, enabling a better characterization of their morphology(Nelson et al.,2019c).

The cosmological model adopted in IllustrisTNG is a flatCDM universe with the following parameters: Hubble constant H, total matter density, dark energy density, baryonic matter density, rms of mass fluctuations at a scale of 8and a primordial spectral index(Planck Collaboration et al.,2016).

SECTION: 2.2Selection Criteria

We will focus our study on central and satellite disc-like galaxies, identified within the redshift rangez=0 toz=0.5. Thezrange considered allow us to obtain a large number of galaxy models to train our classification algorithm. Note that, even though a given galaxy will be present at different snapshots of the simulation, their detailed structure will evolve(see e.g. Varela-Lavin et al.,2023)and, thus, it will serve as input for the training process.

FollowingDolfi et al. (2023)based on our selection criteria, we consider galaxies with:

, whererepresents the number of bound stellar particles. This is used to make sure that galaxies have enough stellar particles to be reasonably well resolved. Considering that the baryonic mass resolution is, as mentioned before, the minimum stellar mass considered is.

, whererepresents the circularity fraction, defined as the fractional mass of the stellar particles with circularity. The latter has previously shown to reliably select orbits confined to a disc(Aumer et al.,2013).kinematically quantifies the disc’s shape, thus ensuring that the galaxies selected are considered ”discy”(Joshi et al.,2020).

. This ensures that the structure of the galactic disc is clearly resolved.

These criteria result in a sample of 7,919 late-type galaxies. In Table1we list the parameters measured from each galaxy that are later used to train our classification models. These parameter are computed as described inDolfi et al. (2023), and references there in. Note that all selected parameters characterize galaxies internal properties and do not explicitly account for the environment in which the galaxies are located. Moreover, previous works have shown that some of these parameters, such as the disc central stellar density,, and its extension,are expected to be strongly linked to the occurrence of lopsided perturbations. In Fig.1we quantify the Pearson Correlation Coefficient between the listed parameters. Checking the parameters’ correlation is an important first step to ensure an accurate representation of the classifier’s results, as having highly correlated data (Pearson correlation values of 1 and -1) can lead to a misinterpretation of the importance of some parameters. In our case, we note that our parameters do not show a strong correlation, with the exception ofand, which have a score of 0.88. This suggests that there is no issue in applying all the selected parameters in our classifier.

SECTION: 3Methods

In this work we make use of Random Forests (hereafter RF;Breiman2001) and its variations to study our selected dataset. Since we deal with a supervised algorithm, it is necessary to count with a training and testing set where galaxies are already labeled as lopsided or symmetric galaxies. A Fourier Decomposition of the light/mass distribution is often used quantify asymmetries(Zaritsky & Rix,1997; Reichard et al.,2008; Varela-Lavin et al.,2023; Dolfi et al.,2023). We will use the radial distribution of themode to label our dataset. To prepare our data before applying it to the models, we partition the dataset into a training set and a testing set comprising 70% and 30% of the total sample, respectively. To do so, we employscikit-learn111https://scikit-learn.org’sstratifiedshufflesplit.

In this section we first discuss how lopsidedness is measured in our models, and then introduce and summarize the main characteristics of RFs and its variations. We also discuss our particular application and the metrics used to measure its performance.

SECTION: 3.1Measuring Lopsidedness

To label the galaxies in our sample between lopsided and symmetric, we apply a Fourier Decomposition. To do so, we measure the amplitude of the first modeof the stellar disc density distribution,, which quantifies the asymmetry of the stellar mass distribution. Before doing so, we have taken into account a few considerations. First, it is crucial to ensure that each galaxy is projected face-on, as the Fourier Decomposition is highly sensitive to the disc inclination. To do so, we rotate each galaxy such as the z-axis is aligned with the disc angular momentum vector. Secondly, to focus our analysis on stellar discs, we consider only stellar participles located within a cylinder of width equal to, and a height equal to. Here,is defined as the vertical distance above and below the disc plane enclosing 90% of the total galaxy stellar mass. The adopted definition for the disc extent allow us to reach their outer regions without introducing contamination from the stellar halo. We have tested several definitions for the disc extent, and found that the, overall, results are not significantly affected by our definition.

The Fourier decomposition for the stellar mass distribution is calculated as follows:

whereandare the mass and the azimuthal coordinate of the i-th stellar particle. Theradial profile is then calculated as follows:

whereandare the amplitude or strength of theandmode, respectively, within a certain radiusand a certain snapshott. In general, the amplitude of the Fourier decomposition is given by:

whereandare defined as the real and imaginary values offor the m-th mode, respectively.

The averaged value ofat a given time,, over a certain radial interval (hereafter) is then used as the global or large-scale lopsidedness indicator. In general, if, the galaxy is considered lopsided. For values ofgalaxies are considered symmetric. This threshold has been widely adopted in the literature, where both large observational and simulated galaxies were considered (e.g.Jog & Combes2009; Reichard et al.2008; Varela-Lavin et al.2023; Dolfi et al.2023). The radial interval considered to calculate the globalparameter has varied between different works. For instance,Zaritsky & Rix (1997)studied the lopsidedness distribution of a sample of 60 field spiral galaxies, using the radial interval ofdisc scale lengths. On the other hand,Reichard et al. (2008)measured the lopsidedness of a sample obtained from SDSS in the radial interval-.van Eymeren et al. (2011)reached distances up to 4 to 5 disc scale lengths to study the asymmetries of the discs’ outer regions. In our case, we use, as we find that this radial interval best represent the non-axisymmetry of the sample.

As an example of the classification made by, Fig.2shows the face-on projections of the surface brightness distribution in the V-band of two clearly classified cases. Here the dashed and cyan lines indicate the lower and upper radial limits, respectively, considered to compute. Considering their respectivevalues, the galaxy on the left is classified as a strong symmetric example with, while the galaxy on the right is classified as a strong lopsided example with a value of.

The resultingdistribution of our sample is shown in Fig.3. The light blue and orange shaded areas indicate the distribution for symmetric and lopsided classified galaxies, based on the selectedthreshold (black line). Notably, our sample is imbalanced; i.e. we have a higher quantity of lopsided galaxies with respect to the symmetric cases.
Out of the total sample size of 7,919 galaxies, 5,273 (i.e.  65%) are classified as lopsided, while 2,646 (i.e.  35%) as symmetric. We note that we find a larger fraction of lopsided galaxies than observations in the local Universe (i.e.  30%;Zaritsky & Rix1997; Reichard et al.2008). As previously discussed inDolfi et al. (2023), this difference can be likely attributed to the different radial interval used to measure the global lopsidedness. For this reason, we are finding a larger fraction of lopsided galaxies than observations, due to the fact that we are reaching out to larger galactocentric radii where the lopsided amplitude is stronger (see alsoVarela-Lavin et al.2023). The resulting imbalance imposes a great challenge for the training and testing of our selected machine learning algorithms. In the following section, we dive deeper into this issue and describe the methods we use to address it.

Lastly, Fig.4shows the distribution of our selected parameters, subdividing both types of galaxies to stress their differences. The dashed lines indicate the median of the corresponding distributions. The first and second top panels show the distributions ofand.It is evident that the two galaxy types show the largest differences in these two parameters. As expected, lopsided galaxies typically show significantly smallerthan their symmetric counterparts. Similarly, lopsided galaxies exhibit smaller values of. This trends are in agreement with previous results(Reichard et al.,2008; Zaritsky et al.,2013; Varela-Lavin et al.,2023)that highlighted that both types of galaxies are indeed characterized by different internal structures.

SECTION: 3.2Classification Algorithms

RF is a type of supervised algorithm that poses a great advantage in the automation of different classification and regression tasks. For instance, it can describe different complexity relations between the parameters, or features, of a sample considering their assigned label. It can also works with a wide variety of different datasets and sizes, among other advantages. In the case of astronomy, it is clear that the use of machine learning algorithms, such as RF, have grown as a result of the exponential increase of data with the current and next-generation surveys and telescopes. As application examples, RF poses a great alternative to classify different sources in different wavelengths(Gao et al.,2009), estimation of photometric redshifts(Carliles et al.,2010), perform automatic classification of light curves of variable stars(Sánchez-Sáez et al.,2021), predict underlying gas conditions of the circumgalactic medium(Appleby et al.,2023), identify galaxy mergers(Guzmán-Ortega et al.,2023)and estimate different galaxies’ physical properties(Mucesh et al.,2021), among other applications.

RF consists of an ensemble, or collection, of decision trees. A decision tree is a tree-like predictive model composed of nodes, where the sample is recursively divided by conditions in the form of, the latter being the j-th feature anda certain threshold based on the j-th feature. In other words, decision trees divide the input space, which depends on the selected feature/s by the decision tree, to create subspaces that are able to differentiate between the different classes. The quality of this division is measured by the ”purity” of the subspace, where the purer it is, the more datapoints from the same class are assigned. The final nodes, called leaves or terminal nodes, result by either fully partitioning the sample or until all leaves have less than the minimum quantity to split a node, which is determined by a certain parameter in the tuning process, discussed below. For classification tasks, these final nodes provide predictions of a certain class based on the resulting probability or, in the case of regression tasks, they provide a numeric value. This process is done firstly on a learning set, or training set, where then a new unseen dataset is propagated over the tree to predict the corresponding class or numeric value.

Although decision trees have numerous advantages due to their intrinsic nature (e.g., they can be used by any kind of sample, they have an easy hyperparameter customization or tuning, and they also estimate the feature importance aside from class predictions), they are easy to overfit. This means that a decision tree may be less accurate when predicting unseen data during testing, as the model tends to overly fit to the training set. RF avoids this issue by training non-correlated decision trees, each on a subsample with replacement of the training set, thus reducing the variance while maintaining high accuracy. For a binary classification task, which is our focus, each decision tree classifies the data as either positive or negative class. Then, the final prediction of the RF is the class predicted by more than half of the trees. This method is called bagging orbootstrap aggregating(Breiman,1996).

Due to our dataset being imbalanced, as seen in Fig.3, using a RF classifier could lead to an inaccurate classification. The training and testing of the RF are performed considering bootstrapped samples of the corresponding data sets. As each sample follows the same distribution as the original dataset, the majority class would have more predictions in favor, thus having more accurate results than the minority class. To avoid this issue affecting our results, we employ two different algorithms. The first one consists on oversampling the minority class of the training set and then apply it to a RF classifier. To do the oversampling, we useimbalanced-learn222https://imbalanced-learn.org’ssmote(Bowyer et al.,2011)method. This creates new ”synthetic” data by interpolation between two close datapoints in the multidimensional feature space; in our a 10 dimensional feature space. The second algorithm consists of using Balanced Random Forests (hereafter BRF;Chen & Breiman2004)), where we useimbalanced-learn’sbalancedrandomforestclassifiermethod. In this case, the bootstrapped sample is only considered for the minority class, whereas the majority class is randomly sampled with replacement, matching the size of the minority class. This avoids manually oversampling the dataset and it is directly performed by each decision tree.

To have an optimal performance of both classifiers using our datasets, we perform anhyperparameter tuning, which involves finding the best combination of parameters from the models to yield the best results. The parameters involved in the fitting of the RF classifiers are listed in Table2with their respective results. To tune both models, we userandomizedsearchcvwith number of iterationsand, as cross-validation,RepeatedStratifiedKFoldwith number of repeatsand number of splits. In both cases, the,, andare the default values of the parameters. To avoid unnecessary complexity in the calculations, we retain the default values for the current and following analysis. For the tuning process, we select a range of possible values for each hyperparameter and then apply it to the randomized search. This generates random combinations of hyperparameters and selects the combination that yields the best performance based on a chosen metric, which in our case is balanced accuracy. It is worth highlighting the significant difference in the number of trees between both classifiers,where SMOTE+RF has 1,500 trees in comparison with BRF, which has 128. This discrepancy in the number of trees might be attributed to the added complexity and variability introduced to the minority class by the SMOTE oversampling process. As it creates synthetic data, the complexity and variability of the sample increases, requiring SMOTE+RF to utilize a larger ensemble of trees to effectively generalize the data and achieve robust results.

SECTION: 3.3Evaluation Metrics

To measure the performance of both SMOTE+RF and BRF, we use the following metrics considering the use of binary classifiers:

Precision: Ratio of the number of correctly predicted positive class to the total number of predicted positive class. Expressed as:

TPR: Ratio of the number of correctly predicted positive class to the number of actual positive class. Expressed as:

F1-score: Harmonic mean of precision and TPR. Expressed as:

True Negative Rate (TNR) or specificity: Ratio of the correctly predicted negative class to the total number of the actual negative class. Expressed as:

Balanced Accuracy:
Average of the recall obtained for each class Expressed as:

Geometric Mean (G-mean): Square root of TNR andTPR. Expressed as:

ROC-AUC: Calculates the area under the Receiver Operating Characteristic (ROC) curve, by using the trapezoidal rule, which approximates the area under the curve as a series of trapezoids. Considering a series of points in the ROC curve, in the form of), the area under the curse is expressed as:

The selected metrics are used to evaluate the results of our classifiers. In particular, precision, TPR, and F1-score are important metrics to evaluate the performance of any type of model. However, these metrics are all sensitive to imbalanced dataset. As a result, they could mislead the algorithm during the training and validation process. To avoid this, we focus the analysis of our classifiers to TNR, balanced accuracy, and G-mean. This metrics are selected followingCheng et al. (2020)work, which ensure a correct analysis due to the imbalanced nature of our dataset. Lastly, we also consider ROC-AUC for the analysis, as it gives us an important insight on how the model is performing without any effect of the imbalance. Still, we present the values for TPR, precision, and F-score, as a reference.

SECTION: 4Results & Analysis

SECTION: 4.1Classification results

In this section, we introduce and analyze the results of the algorithms for the automatic classification between lopsided and symmetric galaxies. As a brief outline of our classification pipeline, we train the classifiers mentioned in Sect.3.2with 5,542 galaxies, constituting  70% of the total sample. This enables the algorithm to obtain important underlying patterns and/or relationships between the galaxies and their features, which are then used for the prediction in the final step. The remaining galaxies are consider for the testing set, which compromises a total of 2,377 galaxies, or 30% of the remaining sample. For each galaxy, these decision trees produce a class prediction—either lopsided or symmetric—and the class that is predicted in more than half of the decision trees is taken as the final prediction for that galaxy. Due to the imbalanced nature of our dataset, we define lopsided as the negative class and symmetric galaxies as the positive class. Usually, the majority class is better represented and naturally favorable by the algorithm over the minority class. To avoid this problem, we designate the minority class as the positive class, which helps with the interpretability of metrics, such as TPR, precision, and ROC-AUC for rare cases. Since we also obtain a proxy of the probability of a galaxy being in the positive/negative class, we test different thresholds, orcut-off, to classify the samples and to explore how such threshold can affect our results. As a default, this threshold is set at 0.5, i.e galaxies with probabilities equal or greater than this value are labeled as the positive class or, in our case, symmetric galaxies. Galaxies with probabilities lesser than this value are labeled as the negative class; i.e. lopsided galaxies. Our analysis showed that differences in the results obtained between the differentcut-offsis negligible. Therefore the following analysis was performed with the default value, 0.5, for SMOTE+RF and BRF.

The results of each model’s performance for the testing set are listed in Table3. Each value of the metrics is obtained by averaging the result scores of each iteration of a cross-validation with number of iterations, which is the default value, and taking into consideration its standard deviation. It is clear that both classifiers provide similar results, with comparable values in most metrics. Based on this, we select as our classifier SMOTE+RF since it results in better TNR metric. As previously discussed, we are working with a unbalanced data set, with more than 70% of the data belonging to the negative class (lopsided objects). Thus, a high TNR indicates a better performance for the most populated class of our sample.

Fig.5shows the confusion matrix (CM) for SMOTE+RF. The x-axis indicates the predicted class or predicted label, obtained from the classifier, and the y-axis show the actual class or actual label, obtained from theparameter. In general, a CM allows us to visually inspect the fractions of correct and incorrect classification we have obtained. In our testing sample, and based on ourclassification criteria, we count with 1,578 true lopsided and a total 799 true symmetric galaxies. Interestingly our classifier is able to correctly classifyof the lopsided object and approximately the same amount for their symmetric counterparts. In absolute number, we obtain a total of 1,922 correctly classified galaxies, against 455 wrongly classified objects. It is worth highlighting the very good performance of the SMOTE+RF classifier, which has been purely obtained based on features that are related to our simulated galaxies internal properties. No information about environments has been introduced during the training process.

SECTION: 4.2Interpretation of the Random Forest classification

Supervised algorithms, including RFs, suffer from interpretability of the decisions leading to the classification. This is often called the ”black box” problem. In RFs, it arises due to the high quantity of decision trees added to the ensemble. In this section, we interpret and analyze the decisions lead by the model to subdivide the galaxies between lopsided and symmetric by ranking the importance of the features used in the classification process.

We use thepermutation_importance_attribute fromrandomforestclassifier. There are various methods for ranking feature importance, but given the continuous nature of our dataset—where no categorical features are used for training or testing— we rely solely onpermutation_importance_. This attribute works by permuting, or shuffling, the values of each feature and calculating the resulting decrease of a specified metric, which by default is accuracy, defined as the fraction or count of the correct predictions. The decrease in the score is then used to rank each feature: the higher the score, the more it affects the model’s performance, thus making the feature important for the model to maintain a higher accuracy. However, since our dataset is imbalanced, using accuracy would not return an accurate representation of the importance of our features. To address this issue, we use balanced-accuracy instead. As discussed in Sec.3.3, this metric represents the averaged fraction of correct classified galaxies for both the negative and positive class. In this, each class contribute equally to the final score, regardless of its size. Considering that the accuracy metric disproportionately favors the majority class in imbalanced datasets due to its overrepresentation, balanced accuracy is great a alternative to avoid inaccurate results.

The results of this procedure are shown in Table4, where lists the rank of each feature obtained bypermutation_importance_. Considering that we want to focus on the performance of SMOTE+RF with unseen data, we only calculate the feature importance for the testing set. We obtain each score by averaging the iterations of a cross-validation withand taking into consideration its standard deviation. This analysis clearly sows that bothandare the highest-ranked parameters, withranked firstranked second. As a way to better visualize this, Fig.6also shows the variation of balanced-accuracy with a box plot. Each box represents the distribution of the score value for each iteration. The dotted line inside each box is the median of the distribution, and each whisker represents the first and last score value. Indeed, we note thatis the top- ranked parameter overall, indicating that it is the most important parameter to consider in the classification process made by SMOTE+RF. As we previously mentioned, and as seen in Fig.4, lopsided and symmetric galaxies are characterized by differentdistributions. This is in agreement with previous results(Reichard et al.,2008; Zaritsky et al.,2013; Varela-Lavin et al.,2023; Dolfi et al.,2023), where lopsided galaxies tend to show significantly lower a densities in the inner regions (as defined by theirwith respect to the symmetric counterparts.

Although not as important as,andSFRalso play an important role in the classification process in comparison with the rest of the features. This is also in agreement with previous results, where an (anti-) correlation between lopsidedness and(e.g. Gómez et al.,2016)and a correlation between lopsidedness andSFR(e.g. Conselice et al.,2000)have been reported. In particular,represents a proxy of the tidal force exerted by the inner galactic regions on the outer disk material. In other words, it indicates how gravitationally cohesive a galaxy is. The relevance of this parameter is clearly reflected in the separation between the distribution of both types of galaxies, as previously seen in Fig.4, where lopsided galaxies tend to have lower values ofthan symmetric galaxies. These findings align with the conclusions ofVarela-Lavin et al. (2023)andDolfi et al. (2023), which propose that lopsided perturbations serve as indicators of intrinsic galaxy properties, rather than being predominantly driven by environmental processes. In other words, galaxies with low central stellar densities are weakly gravitationally cohesive and, thus, are more susceptible to lopsided perturbations, independently of the particular perturbing agent. On the other hand,SFRranking third place is an interesting result, as it is been shown that there is a correlation betweenand currentSFR(Zaritsky & Rix,1997; Rudnick et al.,2000; Reichard et al.,2009). As discussed byŁokas (2022), some internal properties of lopsided and symmetric galaxies can be linked with their currentSFR, e.g. lopsided galaxies having bluer colors, larger gas fractions, and lower metallicity than symmetric galaxies. Moreover,Dolfi et al. (2023)showed that lopsided galaxies tend to be, on average, significantly more star forming than symmetric galaxies at later times. Symmetric galaxies, on the contrary, have an earlier assembly with shorter and more intense star forming bursts. As a result, and considering galaxies with similar stellar masses at the present-day, while symmetric galaxies tend to develop a more pronounce central region at earlier times, lopsided galaxies tend to form at larger fraction of their stellar populations later, typically developing a more extended stellar disc and less dense inner regions. Lastly, Fig.6shows the relative importance of the remaining 7 features. It is clear that they have a minimal impact on the classification procedure.

To analyze the classification made by SMOTE+RF, we plot in Fig.7the median ofas a function of radius for the four cases defined by the classifier. To generate this figure, the radial extension of each simulated galaxy was normalized by its corresponding. We focus on the radial interval, as it is the considered interval for the Fourier decomposition. The shaded areas represent the 25th and 75th percentiles of the distribution. In the left plot, the fuchsia distribution represents correctly classified lopsided galaxieswhereas the purple distribution represent lopsided galaxies classified by our model as symmetric. The right plot is the same as the left one but for symmetric galaxies. Here the cyan color represent the distribution of correctly classified symmetric galaxies,, while in green we show symmetric galaxies classified as lopsided. Note that incorrectly classified cases do not follow the same trend as the correctly classified distributions. In the case of) on the left plot, from 0.5to 0.9the magnitude ofstarts increasing at the same rate than the correctly classified sample. However, from 0.9onward, the slope is less steep, meaning that the magnitude ofdoes not increase as much as in). In other words, while incorrectly classified galaxies have indeed an outer perturbed region, the strength of the perturbations is typically weaker with respect to correctly classified galaxies. On the right panel we show that theprofile of both correctlyand incorrectly classified galaxiesremains below the 0.1 threshold chosen to classify lopsided galaxies based on theparameter. Nonetheless, wrongly classified symmetric galaxies tend to have a largervalue at all radii and they do cross the threshold at the outermost edge. In the following section we explore in detail the main reasons that drove the SMOTE+RF method to misclassify these galaxies.

SECTION: 4.3Interpretation of the Misclassified Cases

In the previous section, we analyzed the results of applying RFs algorithms to the internal parameters of our selected sample of lopsided and symmetric galaxies. In particular, we find that theandparameters are the primary features used by the classifier to subdivide galaxies as either lopsided or symmetric, consistent with previous observational studies. However, there are 455 galaxies in the testing set that are misclassified. In this section, we focus on the misclassified cases,and, to investigate the underlying reasons behind the misclassification.

To further study the incorrectly classified galaxies, in Figure3we highlight their A1 distributions. The purple dashed distribution represents lopsided galaxies classified as symmetric galaxieswith a median of, and the green dashed distribution represents symmetric galaxies classified as lopsided galaxieswith a median of. It is clear that all misclassified galaxies are adjacent to the thresholdand, thus, represent challenging cases for our classification models. In Fig.8we show the distribution of,, andfor all the four different classification cases, following the same color coding as in Fig.7. Each dashed line represents the median of the corresponding distribution. The top panels show the results obtained from the correctly classified galaxy samples by our model. Note that the distributions differ significantly in all three parameters. As expected, the largest differences are found in. However, even thedistributions differ, with median values of 11and 14.3for symmetric and lopsided galaxies, respectively. The bottom panels show the distributions obtained from the incorrectly classified samples. Two important things stand out. First, the distributions of the three inspected parameters show more significant overlap with respect to the correctly classified sample. The medians are, in all cases, closer to the median of the overall sample. This is most clear in thedistributions, where both symmetric and lopsided nearly perfectly overlap with each other. Second, and most importantly, we find that galaxies classified as lopsided by our globalparameter, but identified as symmetric by our model, have values ofandthat are consistent with the distribution of correctly classified symmetric galaxies. In other words, they have relatively large central surface density andvalues. Upon closer inspection of their images, we observe that such galaxies typically display a symmetric overall disk, but a significant asymmetry in their outermost region. An example of such galaxy is show in the top right panel of Figure9. These localized asymmetries, captured by the global A1 parameter, not necessarily reflect the overall structure of the disc and can be caused by recent episodes of gas accretion or very recent strong interactions. On the other hand, galaxies classified as symmetric by the globalparameter but symmetric by our modelshow lowandvalues. Such galaxies display internal properties of typical lopsided galaxies, but simply the morphological perturbation has not yet been triggered. The top left panel of Fig.9shows an example of such situation.

To further explore the two examples of misclassified galaxies, in the second and third row of Fig.9we show their radialand density profiles, respectively. The cyan regions in the second row highlight the radial interval (0.5 - 1.4), considered to measure. It is worth noting that both galaxies were selected by considering extreme values ofandwhile having similar stellar mass. For, the galaxy shows consistently low, even up to the disc outermost regions. Interestingly, its inner stellar density is notably lower than expected for a symmetric galaxy. Even its, highlighted with a red star, falls below the mean of the overall sample (dashed magenta line). On the other hand, for the, while theshows values consistent with 0 within most of the considered radial range, it shows a very strong rise in the disc outskirts. We note that this galaxy has a denser inner stellar region, highlighted by its largevalue which significantly surpass the median of the overall distribution.

To understand these unexpected behavior, we explore on the two lower rows the time evolution of the lopsided parameter and the orbital histories. Interestingly, we find that thegalaxy (right panels) became a satellite of a larger host approximately 1.5 Gyr ago. Previous to the pericentric passage, this galaxy showedvalues below the threshold. After the close interaction, thevalue rapidly grows as a result of the tidal perturbation of its outer disc. Indeed, we find that this galaxy has internal properties consistent with the symmetric sample, but the strong recent interaction forced an outer tidal disruption, captured by theparameter. In the case of the(left panels), the time evolution of A1 shows that, over most of its evolution, this galaxy was indeed strongly lopsided. The initial perturbations was likely induced by significant interaction with a massive satellite galaxy (1:10) 6.5 Gyr ago (first perincetric passage). After this point, the galaxy suffered no other interaction with satellite of mass ratios ¡ 1:100. Thus, the lopsided perturbation gradually relaxed, reaching a present-dayvalue below the considered threshold. Even though its internal structure make this galaxy susceptible to lopsided perturbations, the lack of significant external perturbation during its late evolution resulted on a symmetric configuration at the present-day.

We note that recent interactions cannot explain all the misclassified cases. Indeed, only 76 of the 300cases are satellite galaxies of a more massive host. Eight (8) additional galaxies have suffered significant interactions (¿ 1:20) as centrals during the last 3 Gyr. Thus, important interaction can be attributed to this misclassified class in only 28% of the cases. Nonetheless, as previously discussed, other mechanisms such as gas accretion, instability in a counter-rotating disc and torques from an off-centered dark matter halo could be at play in the remaining cases(Jog & Combes,2009).
Among these mechanisms, asymmetric gas accretion has been proposed as a common driver of lopsidedness. As shown byBournaud et al. (2005), interactions and mergers can trigger strong lopsidedness in some cases, but they do not account for all the observed statistical properties, such as a correlation between lopsidedness and the Hubble Type, or a correlation betweenandasymmetries, among others. In a follow up study we will focus on the misclassified cases to further the origin of lopsidedness in galaxies with internal properties common to symmetric discs.

SECTION: 4.4Classification with observable parameters

Several parameters considered in this work as features require additional modeling to be estimated. Thus, they cannot be directly obtained from observation based on, e.g., photometric data. For example, the calculation ofinvolves the application of additional stellar population models. Indeed,Reichard et al. (2008)calculated the stellar surface mass density followingKauffmann et al. (2003)definition, which considers the stellar mass and the Petrosian half-light radius in the z-band. Their stellar massed where estimated using a method that combines spectral diagnostics of star formation histories with photometric data. Additionally, the tidal parameter, requires an estimation of the total mass enclosed within, which involves dynamical modeling of the galaxy.

Despite their importance of in the classification process of such parameters, in this section we explore wether it is still possible to obtain a reliable classification of lopsided and symmetric galaxies using parameters that are more readily obtainable from photometric data. We follow the same pipeline mentioned earlier, but we train and test the SMOTE+RF classifier with a subset of features that could be estimated from multi-band photometric surveys such as S-Plus(Mendes de Oliveira et al.,2019)and J-Pass(Benitez et al.,2014). In particular, we replace the parameterby the galaxies r-band luminosity within,, thus avoiding the need of stellar population models. In addition to, we consider as features,,c/a, andSFR. The later can be obtained from narrow band photometry around theline through the Kennicut relation(Kennicutt,1998). We keep the same hyperparameters listed in Table2, along with the same training and testing sets.

The results of this test are presented in Table5, where list the metrics obtained from the testing set. Interestingly, we find very good results, with a performance of the SMOTE+RF algorithm that is only very mildly affected by the limited number of features considered. Indeed, most scores are not significantly affected. Compared to our previous results we find a negligible decrease of 0.4% for balanced accuracy and no change for TNR. Additionally, ROC-AUC has a score of  80.9%, which reflects on how well the model is able to differentiate between both classes. As expected, substitutionbydid not introduced a significant drop in the performance. To further characterize our classification, the left panel of Fig.10shows the resulting CM. Note that we obtain a total of 1,927 correctly classified galaxies and only 535 incorrectly classified cases, which represent aincrease. Compared to our previous results, this model improves in the identification of actual lopsided galaxies, but performs slightly worse in classifying actual symmetric galaxies as symmetric. The feature importance ranking is shown on the right panel of Fig.10, generated with thefeature_importanceattribute. We find that the most important parameters are now,and SFR. As before,provides no significant information for the RF classifier.

Our results show that using readily available observational parameters offers a simpler and reliable approach to classify lopsidedness in large observational samples of galaxies, without the need of parameters that required additional modeling to be estimated, such asand. This approach could be particularly valuable in large-scale surveys such as those soon will be provided by LSST(Ivezić et al.,2019).

SECTION: 5Conclusions and Discussion

In this work we selected a large sample of disc-like galaxies from the IllustrisTNG simulation to develop an algorithm capable of automatically classifying galaxies between lopsided and symmetric. Our main goal was to explore whether this classification can be accurately performed using only internal galactic parameters, thus neglecting information about their present-day environment.

To achieve this we employed the Random Forest algorithm, a machine learning approach that involves a supervised training process. To label our data as lopsided and symmetric galaxies we employed a Fourier decomposition of the galaxies’ stellar density distribution over the radial interval. We computed a radially average power of themode,within this range. Galaxies withwere classified as lopsided, and the remaining as symmetric. Our sample results in a total 5,273 lopsided and 2,646 symmetric galaxies. To avoid problems in the classification process due to the imbalanced an nature of the dataset, we employed two variations of the RF algorithm: i) we usedSMOTEto oversample symmetric galaxies in the training set, thus evening both classes, and ii) we used the BRF algorithm, which balances both classes on each tree by only bootstrapping the minority class while undersampling the majority. Based on the considered metrics, we selected SMOTE+RF as the best model. The classification resulted in a total of 1,922 and 455 correctly and correctly classified incorrectly classified. This translates in a balanced accuracy of accurate classification rate ofof both classes. To interpret and understand the different decisions leading the RF to the classification, we used a method to quantify ”features importance”. In particular we utilized and algorithm that randomly permutes features’ values and calculates the decrease in a certain metric; which in our case we choose balanced-accuracy. We found that, to distinguish between both classes, the three most important parameters for the model are,, andSFR. The excellent results obtained by our classifier, trained with features that do not account for the galaxies environment, strongly supports the hypothesis that lopsidedness is mainly a tracer of galaxies internal structures.

Even though our classifier demonstrated a very good performance, we find thatof the galaxies were misclassified. To study the misclassified cases, we first explore the distribution of the main parameters used by the RF. First, we find that thevalue of the misclassified cases lies very close to the threshold used to label galaxies as lopsided or symmetric. As a result, these cases are typically associated to ”borderline classifications” by. Interestingly, we find that the distribution of the most important parameters, such asandare in good agreement with class they have been associated to by the RF algorithm. In other words, galaxies classified byas lopsided, but as symmetric by the RF, have largeandvalues. Conversely, galaxies classified byas symmetric, but as lopsided by the RF, have lowandvalues.

To further explore why galaxies with large central surface density and strongly cohesive present perturbed outer disk region, we selected a representative case. We find that the selected galaxy became a satellite of a more massive hostGyr ago. Previous to the crossing of host virial radius, the galaxy had a symmetric configuration. However, shortly after its first pericentric passage its outer regions become perturbed due to the strong tidal interaction. Such strong and recent interaction induced a temporary lopsided perturbation on this galaxy. We find thatof this misclassified class are either satellites of a more massive host, or have had a very recent strong tidal interactions with a massive companion (¿1:20). For the other misclassified cases, other mechanism, such as asymmetric gas accretion, must be considered to explain the classifications. We will further explore this in a follow up analyses. In the case of galaxies with lowandmisclassified as symmetric by the RF algorithm, we find that, typically, they have not experienced recent significant interactions with massive companions. Thus, even though the are susceptible to develop a lopsided perturbation, no external interaction have trigger its onset.

Several parameters considered in this work as features require additional modeling to be estimated. Considering the advent of several surveys such as S-PLUS(Mendes de Oliveira et al.,2019), J-PAS(Benitez et al.,2014), and the LSST(Ivezić et al.,2019), we explored whether the performance of our classifier significantly drops when considering features that can be readily obtained from multi-band photometric surveys. In particular, we replace stellar mass estimates with their corresponding luminosity in the r-band, and dropped parameters such asthat involve dynamical modeling to estimate the total galaxy mass within. Interestingly, we find the performance of our modeling is very mildly affected, with recovery rates of. These results are very promising, as our algorithm could allow us to rapidly extract samples of lopsided galaxies from large surveys, allowing us to explore whether lopsidedness in present-day disc galaxies is connected to their specific evolutionary histories, which shaped their distinct internal properties(Dolfi et al.,2023).

SECTION: References